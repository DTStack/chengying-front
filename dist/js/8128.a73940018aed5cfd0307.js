"use strict";(self.webpackChunkdt_em_front=self.webpackChunkdt_em_front||[]).push([[8128],{57668:(e,t,n)=>{n.r(t),n.d(t,{getClusterHostList:()=>N,getClusterhostGroupLists:()=>k,getFilterData:()=>b,getHostInstance:()=>A,getHostList:()=>L,getTableData:()=>C,gethostGroupLists:()=>I,resetHostList:()=>U,setFilterSelectedItem:()=>T,setPager:()=>K,setSearchValue:()=>O,setTableSelectRows:()=>w,showInstallInfo:()=>G,updateHostList:()=>D,updateHostsList:()=>F,updateSelectedHostInfo:()=>P,updateServicesList:()=>R});var a=n(86902),r=n.n(a),s=n(14310),o=n.n(s),l=n(20116),i=n.n(l),c=n(34074),u=n.n(c),p=n(78914),d=n.n(p),m=n(39649),f=n.n(m),h=n(20368),_=n.n(h),v=n(63978),g=n.n(v),y=n(44845),E=n(19528),S=n(56466),Z=n(45360);function H(e,t){var n=r()(e);if(o()){var a=o()(e);t&&(a=i()(a).call(a,(function(t){return u()(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n,a,r=null!=arguments[t]?arguments[t]:{};t%2?d()(n=H(Object(r),!0)).call(n,(function(t){(0,y.Z)(e,t,r[t])})):f()?_()(e,f()(r)):d()(a=H(Object(r))).call(a,(function(t){g()(e,t,u()(r,t))}))}return e}var T=function(e){return{type:S.uf.HOST_SET_FILTER,payload:e}},b=function(e){return function(t){E.t6.getFilterData(e).then((function(e){t({type:S.uf.HOST_GET_FILTER,payload:e.result.data})}))}},L=function(e,t,n){return function(a){E.t6.getClusterHostList(e,t).then((function(e){0===e.data.code?(a({type:S.uf.UPDATE_HOST_LIST,payload:e.data}),n&&n(e.data.data.hosts)):Z.Z.error(e.data.msg)}))}},N=function(e,t){return function(n){var a=e.cluster_type;"hosts"===a&&delete e.role,delete e.cluster_type,E.t6.getClusterHostList(e,a).then((function(e){0===e.data.code?(n({type:S.uf.GET_CLUSTER_HOST_LIST,payload:e.data}),t&&t(e.data.data)):Z.Z.error(e.data.msg)}))}},I=function(e,t){return function(n){E.t6.getClusterhostGroupLists(e).then((function(e){0===e.data.code?(n({type:S.uf.GET_HOSTGROUP_LISTS,payload:e.data.data||[]}),e.data.data&&t&&t(e.data.data)):Z.Z.error(e.data.msg)}))}},k=function(e){return function(t){E.t6.getClusterhostGroupLists(e).then((function(e){0===e.data.code?t({type:S.uf.GET_CLUSTER_HOSTGROUP_LISTS,payload:e.data.data||[]}):Z.Z.error(e.data.msg)}))}},C=function(e){return function(t){E.t6.getTableData(x(x({},e),{},{pageSize:20})).then((function(e){t({type:S.uf.HOST_GET_LIST,payload:e.result})}))}},D=function(e){return{type:S.uf.HOST_GET_LIST,payload:e}},w=function(e){return{type:S.uf.HOST_SET_SELECTED_ROWS,payload:e}},O=function(e){return{type:S.uf.HOST_SET_SEARCH_VALUE,payload:e}},K=function(e){return{type:S.uf.HOST_SET_PAGER,payload:e}},G=function(e){return E.t6.showInstallInfo(e).then((function(e){return e})).catch((function(e){}))},A=function(e){return function(t){E.t6.getHostInstance(e).then((function(e){0===(e=e.data).code&&t({type:S.uf.UPDATE_HOST_INSTANCES_LIST,payload:e.data})}))}},P=function(e,t){return function(n){n({type:S.uf.UPDATE_SELECT_HOST_INFO,payload:{params:e,index:t}})}},R=function(e){return function(t){E.t6.getHostServicesList({pid_list:e.pid_list,ip:e.ip}).then((function(e){var n=[];0===(e=e.data).code?n=e.data:Z.Z.error(e.msg),t({type:S.uf.UPDATE_HOST_SERVICES_LIST,payload:n})}))}},F=function(e){return function(t){t({type:S.uf.UPDATE_HOST_LIST,payload:e})}},U=function(){return{type:S.uf.RESET_HOST_LIST,payload:!0}}},18274:(e,t,n)=>{n.d(t,{E9:()=>l,MD:()=>a,OY:()=>s,RI:()=>o,XN:()=>r});var a=[{text:"部署成功",value:"deployed"},{text:"部署失败",value:"deploy fail"},{text:"部署中",value:"deploying"},{text:"卸载失败",value:"undeploy fail"},{text:"卸载中",value:"undeploying"}],r=[{text:"更新成功",value:"success"},{text:"更新失败",value:"fail"},{text:"更新中",value:"update"}],s={hosts:["主机集群"],kubernetes:["Kubernetes集群（自建集群）","Kubernetes集群（导入已有集群）"]},o={hosts:{title:"主机安装会经过2个状态：管控安装-主机初始化，若某一步安装失败，请查看具体日志。",filters:[{text:"管控安装成功",value:"管控安装成功"},{text:"管控安装失败",value:"管控安装失败"},{text:"script安装成功",value:"script安装成功"},{text:"script安装失败",value:"script安装失败"},{text:"主机初始化成功",value:"主机初始化成功"},{text:"主机初始化失败",value:"主机初始化失败"}],finalStatus:3},kubernetes:{title:"Kubernetes集群主机安装会经过5个状态：管控安装-主机初始化-K8S Docker初始化-K8S Node初始化-K8S Node部署成功，若某一步安装失败，请查看具体日志",filters:[{text:"管控安装失败",value:"管控安装失败",status:-1},{text:"管控安装成功",value:"管控安装成功",status:1},{text:"主机初始化失败",value:"主机初始化失败",status:-3},{text:"主机初始化成功",value:"主机初始化成功",status:3},{text:"K8S DOCKER初始化失败",value:"K8S DOCKER初始化失败",status:-5},{text:"K8S DOCKER初始化成功",value:"K8S DOCKER初始化成功",status:5},{text:"K8S NODE初始化失败",value:"K8S NODE初始化失败",status:-6},{text:"K8S NODE初始化成功",value:"K8S NODE初始化成功",status:6},{text:"K8S NODE部署失败",value:"K8S NODE部署失败",status:-7},{text:"K8S NODE部署成功",value:"K8S NODE部署成功",status:7}],finalStatus:7}},l={NAMESPACE:"em_current_k8s_namespace"}},19377:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(95266),r=n(77766),s=n.n(r),o=n(67294),l=n(31097),i=n(8263),c=n(30381),u=n.n(c),p=n(19528),d=n(64143);const m=function(e){var t=e.history,n=e.ip,r=(0,o.useState)([]),c=(0,a.Z)(r,2),m=c[0],f=c[1];(0,o.useEffect)((function(){h()}),[n]);var h=function(){p.BZ.getHostAlert({ip:n}).then((function(e){var t,n=e.data;0===n.code&&f(null==n||null===(t=n.data)||void 0===t?void 0:t.data)}))};return o.createElement(i.Z,{rowKey:function(e){var t;return s()(t="".concat(e.panel_title,"_")).call(t,e.time)},className:"dt-table-fixed-base",dataSource:m,pagination:!1,scroll:{y:!0},style:{height:485},size:"middle"},o.createElement(i.Z.Column,{title:"指标名称",key:"panel_title",render:function(e){return o.createElement("div",null,function(e){var t=null;switch(e){case"ok":t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-heart-fill color-ok"}));break;case"pending":t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-warning-circle-fill color-pending"}));break;case"alerting":t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-alert-fill color-alerting"}));break;case"no_data":t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-question-circle-fill color-no-data"}));break;case"paused":t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-poweroff-circle-fill color-paused"}));break;default:t=o.createElement(l.Z,{title:e},o.createElement("i",{className:"emicon emicon-API- color-no-data"}))}return t}(e.state),"  ",e.panel_title)}}),o.createElement(i.Z.Column,{title:"告警名称",dataIndex:"alert_name"}),o.createElement(i.Z.Column,{title:"来源仪表盘",dataIndex:"dashboard_name",render:function(e,n){return o.createElement("a",{onClick:function(e){return function(e){var n="/deploycenter/monitoring/dashdetail?url=".concat(e.url);d.Z.setNaviKey("menu_deploy_center","sub_menu_dashboard"),t.push(n)}(n)}},e)}}),o.createElement(i.Z.Column,{title:"告警时间",dataIndex:"time",render:function(e){return e?u()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}}))}},98128:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe});var a=n(1068),r=n.n(a),s=n(44930),o=n(68420),l=n(27344),i=n(5281),c=n(84441),u=n(3020),p=n(3362),d=n(44845),m=n(63109),f=n.n(m),h=n(51942),_=n.n(h),v=n(77766),g=n.n(v),y=n(33032),E=n.n(y),S=n(78914),Z=n.n(S),H=n(67294),x=n(79855),T=n(29027),b=n(15857),L=n(57668),N=n(19528),I=n(94473),k=n.n(I),C=n(81643),D=n.n(C),w=n(2991),O=n.n(w),K=n(97183),G=n(99210),A=n(4107),P=n(11382);function R(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var s=(0,p.Z)(this).constructor;n=r()(a,arguments,s)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var F=K.Z.Sider,U=G.Z.SubMenu,B=A.Z.Search;const M=function(e){(0,c.Z)(n,e);var t=R(n);function n(){var e,a;(0,o.Z)(this,n);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return a=t.call.apply(t,g()(e=[this]).call(e,s)),(0,d.Z)((0,i.Z)(a),"state",{openKeys:[],selectedKeys:[],limit:0,start:0}),(0,d.Z)((0,i.Z)(a),"onOpenChange",(function(e){var t=a.props,n=t.hostList,r=t.handleHostItemClick,s=t.hostGroupLists,o=t.clickGroup,l=k()(e).call(e,(function(e){var t;return-1===D()(t=a.state.openKeys).call(t,e)}));s&&D()(s).call(s,l)>-1&&(e=l?[l]:[]),a.setState({openKeys:e,selectedKeys:e.length?["".concat(e[0],"-",0)]:[]},(function(){if(e.length){var t=n[0];o({limit:0,start:0,group:e[0]}),r(t,0)}}))})),a}return(0,l.Z)(n,[{key:"componentDidUpdate",value:function(e,t){var n,a,r,s=this.props,o=s.hostGroupLists,l=s.selectedIndex,i=s.selectedGroup;e.selectedIndex!==l&&this.setState({openKeys:e.selectedIndex!==l?this.state.openKeys:["".concat(o[0])],selectedKeys:e.selectedIndex!==l?[g()(n="".concat(this.state.openKeys[0],"-")).call(n,l)]:[g()(a="".concat(o[0],"-")).call(a,l)]});i&&e.selectedGroup!==i&&this.setState({openKeys:[i],selectedKeys:[g()(r="".concat(i,"-")).call(r,l)]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.hostList,a=t.hostGroupLists,r=t.loading;return H.createElement(F,{className:"host-side-nav box-shadow-style",style:this.props.style,width:240},H.createElement("div",{className:"search-box"},H.createElement(B,{onSearch:function(t){return e.props.handleSearch(t,{group:e.state.openKeys[0]})},style:{width:200,margin:"12px 20px 8px"},placeholder:"输入主机ip"})),H.createElement(P.Z,{className:"host-box",spinning:r},H.createElement(G.Z,{mode:"inline",selectedKeys:this.state.selectedKeys,openKeys:this.state.openKeys,onOpenChange:this.onOpenChange,className:"c-sidenav__menu"},a&&O()(a).call(a,(function(t){return H.createElement(U,{key:"".concat(t),title:H.createElement("span",null,t)},n&&O()(n).call(n,(function(n,a){var r;return H.createElement(G.Z.Item,{key:g()(r="".concat(t,"-")).call(r,a),onClick:function(t){e.setState({selectedKeys:t.keyPath}),e.props.handleHostItemClick(n,a)}},H.createElement("i",{className:"dot-cls",style:n.alert?{display:"inline-block"}:{display:"none"}}),n.ip)})))})))))}}]),n}(H.Component);var z=n(59340),j=n.n(z),Y=n(77149),W=n.n(Y),V=n(45360),$=n(52553),q=n(8263),J=n(39144),Q=n(71230),X=n(15746),ee=n(31097),te=n(45334),ne=n(19377),ae=n(64143),re=n(18446),se=n.n(re),oe=n(36808);function le(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var s=(0,p.Z)(this).constructor;n=r()(a,arguments,s)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}const ie=function(e){(0,c.Z)(n,e);var t=le(n);function n(){var e,a;(0,o.Z)(this,n);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return a=t.call.apply(t,g()(e=[this]).call(e,s)),(0,d.Z)((0,i.Z)(a),"state",{key:"tab1",hasHostAlert:!1}),(0,d.Z)((0,i.Z)(a),"computeProgress",(function(e,t){return ae.Z.formatGBUnit(e)/ae.Z.formatGBUnit(t)})),(0,d.Z)((0,i.Z)(a),"goToServer",(function(e,t){var n,r,s=a.props.detailData,o=void 0===s?{}:s,l=g()(n=g()(r="/opscenter/service?component=".concat(e.product_name,"&service_group=")).call(r,e.group,"&service=")).call(n,t);ae.Z.setNaviKey("menu_ops_center","sub_menu_service"),oe.set("em_product_name",e.product_name),sessionStorage.setItem("host_service",j()({ip:o.ip})),a.props.history.push(l)})),(0,d.Z)((0,i.Z)(a),"onTabChange",(function(e){a.setState({key:e})})),(0,d.Z)((0,i.Z)(a),"getHostAlert",(function(){var e=a.props.detailData;N.BZ.getHostAlert({ip:null==e?void 0:e.ip}).then((function(e){var t=e.data;if(0===t.code&&null!=t&&t.data){var n,r=null===(n=t.data.data)||void 0===n?void 0:W()(n).call(n,(function(e){return"alerting"===e.state}));a.setState({hasHostAlert:r})}else V.Z.error(t.msg)}))})),a}return(0,l.Z)(n,[{key:"componentDidUpdate",value:function(e,t){var n,a,r,s,o,l;!se()(this.props.detailData,e.detailData)&&null!==(n=this.props)&&void 0!==n&&null!==(a=n.detailData)&&void 0!==a&&a.ip&&(this.props.getServicesList({ip:null===(r=this.props)||void 0===r||null===(s=r.detailData)||void 0===s?void 0:s.ip,pid_list:null===(o=this.props)||void 0===o||null===(l=o.detailData)||void 0===l?void 0:l.pid_list}),this.getHostAlert())}},{key:"render",value:function(){var e=this,t=this.props,n=t.detailData,a=void 0===n?{}:n,r=t.cur_parent_cluster,s=t.history,o=null!=a&&a.mem_used_display?this.computeProgress(a.mem_used_display,a.mem_size_display):0,l=null!=a&&a.disk_used_display?this.computeProgress(a.disk_used_display,a.disk_size_display):0,i=null!=a&&a.file_used_display?this.computeProgress(a.file_used_display,a.file_size_display):0,c=[{title:"组件",dataIndex:"product_name_display",width:"33.3%"},{title:"服务组",dataIndex:"group",width:"33.3%"},{title:"服务",dataIndex:"service",render:function(t,n){var a;return H.createElement("div",{className:"services-box"},O()(a=n.service_name_list.split(",")).call(a,(function(t,a){return H.createElement("a",{style:{marginRight:10},id:a+"",key:t,onClick:function(){return e.goToServer(n,t)}},t)})))}}],u=[{key:"tab1",tab:H.createElement($.Z,null,"运行服务")},{key:"tab2",tab:H.createElement($.Z,{dot:this.state.hasHostAlert},"主机告警")}],p={tab1:H.createElement(q.Z,{rowKey:function(e,t){return e.product_name+e.group+t},size:"middle",className:"dt-pagination-lower box-shadow-style",columns:c,dataSource:this.props.runningServices,pagination:!1}),tab2:H.createElement(ne.Z,{ip:a.ip,history:s})};return H.createElement("div",{className:"host-detail-page"},H.createElement("p",{className:"text-title-bold"},"详细信息"),H.createElement(J.Z,{className:"detail-card box-shadow-style mb-20",style:{cursor:"default"},bordered:!1},H.createElement(Q.Z,null,H.createElement(X.Z,{span:8},H.createElement("span",null,"主机IP：",a.ip)),H.createElement(X.Z,{span:8},H.createElement("span",null,"主机名称：",a.hostname)),H.createElement(X.Z,{span:8},H.createElement("span",null,"主机创建时间：",a.created))),H.createElement(Q.Z,null,H.createElement(X.Z,{span:8},H.createElement("span",null,"agent状态：",H.createElement("span",{className:a.is_running?"c-status-normal":"c-status-stop",style:{color:a.is_running?"#3f87ff":"#FF5F5C"}},a.is_running?"运行中":"关闭"))),H.createElement(X.Z,{span:8,className:"c-text-ellipsis"},H.createElement(ee.Z,{placement:"topLeft",title:a.errorMsg},H.createElement("span",null,"初始化状态：",a.errorMsg))),H.createElement(X.Z,{span:8},H.createElement("span",null,"最近心跳时间: ",a.updated))),H.createElement(Q.Z,null,H.createElement(X.Z,{span:24},H.createElement("span",null,"部署组件：",a.product_name_display_list))),H.createElement(Q.Z,null,H.createElement(X.Z,{span:8},H.createElement("span",{className:"progress-box"},H.createElement("span",null,"物理内存：",a.mem_used_display," /"," ",a.mem_size_display),H.createElement(te.Z,{percent:100*o,showInfo:!1}))),"kubernetes"===r.type?H.createElement(H.Fragment,null,H.createElement(X.Z,{span:8},H.createElement("span",{className:"progress-box"},"CPU使用情况：",a.cpu_core_used_display," /"," ",a.cpu_core_size_display,H.createElement(te.Z,{percent:a.cpu_usage_pct,showInfo:!1}))),H.createElement(X.Z,{span:8},H.createElement("span",{className:"progress-box"},H.createElement("span",null,"POD：",a.pod_used_display," /"," ",a.pod_size_display),H.createElement(te.Z,{percent:a.pod_usage_pct,showInfo:!1})))):H.createElement(H.Fragment,null,H.createElement(X.Z,{span:8},H.createElement("span",{className:"progress-box"},H.createElement("span",null,"磁盘使用情况：",a.disk_used_display," /"," ",a.disk_size_display),H.createElement(te.Z,{percent:100*l,showInfo:!1}))),H.createElement(X.Z,{span:8},H.createElement("span",{className:"progress-box"},H.createElement("span",null,"文件系统空间：",a.file_used_display," /"," ",a.file_size_display),H.createElement(te.Z,{percent:100*i,showInfo:!1})))))),H.createElement("p",{className:"text-title-bold"},"运行状况"),H.createElement(J.Z,{className:"box-shadow-style status-card",bordered:!1,tabList:u,activeTabKey:this.state.key,onTabChange:this.onTabChange},p[this.state.key]))}}]),n}(H.Component);const ce=function(e){var t,n=e.cur_parent_cluster,a=e.searchStr,r=null===(t=function(){var e=a,t={};if(-1!==D()(e).call(e,"?"))for(var n=e.substr(1).split("&"),r=0;r<n.length;r++)t[n[r].split("=")[0]]=unescape(n[r].split("=")[1]);return t}())||void 0===t?void 0:t.host,s=window.location.protocol+"//"+window.location.hostname+":"+window.APPCONFIG.GRAFANA_PORT+"/grafana/d/Ne_roaViz/host-overview?orgId=1&var-node="+r+"&var-cluster="+n.name+"&var-job=node_exporter&var-port=9100&theme=light&no-feedback=true";return H.createElement("iframe",{className:"style-iframe",style:{height:document.body.clientHeight-88-10},src:s,frameBorder:"0"})};var ue,pe=n(96486);function de(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var s=(0,p.Z)(this).constructor;n=r()(a,arguments,s)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var me=x.Z.TabPane;const fe=(0,T.$j)((function(e){return{hostList:e.HostStore.hostList,selectedHostServices:e.HostStore.selectedHostServices,selectedHost:e.HostStore.selectedHost,cur_parent_product:e.HeaderStore.cur_parent_product,cur_parent_cluster:e.HeaderStore.cur_parent_cluster,selectedIndex:e.HostStore.selectedIndex,hostGroupLists:e.HostStore.hostGroupLists,pager:e.HostStore.pager}}),(function(e){return{actions:(0,b.DE)(_()({},L),e)}}))(ue=function(e){(0,c.Z)(n,e);var t=de(n);function n(){var e,a;(0,o.Z)(this,n);for(var r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];return a=t.call.apply(t,g()(e=[this]).call(e,l)),(0,d.Z)((0,i.Z)(a),"state",{sideNavHeight:document.body.clientHeight-128,searchText:"",sideNavLoading:!1,selectedGroup:"",currentHost:{}}),(0,d.Z)((0,i.Z)(a),"getHostList",(function(e){var t=a.props.cur_parent_cluster,n=t.id,r=t.type,s=_()({parent_product_name:a.props.cur_parent_product,host_or_ip:a.state.searchText,limit:0,start:0,cluster_id:n},e);a.setState({sideNavLoading:!0}),a.props.actions.getHostList(s,r,(function(){a.setState({sideNavLoading:!1})}));var o=E()((function(){clearTimeout(o),a.state.sideNavLoading&&a.setState({sideNavLoading:!1})}),2e3)})),(0,d.Z)((0,i.Z)(a),"getHostGroups",(function(e){var t=a.props,n=t.cur_parent_product,r=t.actions,o=t.cur_parent_cluster,l=o.type,i=o.id;i<=0||!n||r.gethostGroupLists({type:l,id:i,host_or_ip:a.state.searchText,parent_product_name:n},function(){var t=(0,s.Z)(f().mark((function t(r){var s,o,c,u,p;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=JSON.parse(sessionStorage.getItem("service_object")),t.next=3,N.t6.getClusterHostList({parent_product_name:n,host_or_ip:(null==c?void 0:c.hostIp)||"",limit:0,start:0,cluster_id:i},l);case 3:u=t.sent,(p=null==u||null===(s=u.data)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.hosts[0])&&a.setState({selectedGroup:c?null==p?void 0:p.group:r[0],currentHost:p},(function(){sessionStorage.removeItem("service_object")})),a.getHostList(e||{limit:0,start:0,group:c?null==p?void 0:p.group:r[0]});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),(0,d.Z)((0,i.Z)(a),"handleSideHostClick",(function(e,t){a.props.actions.updateSelectedHostInfo(e,t)})),(0,d.Z)((0,i.Z)(a),"handleSideSearch",(function(e,t){a.setState({searchText:e},(function(){a.getHostGroups(t)}))})),a}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.getHostGroups()}},{key:"componentDidUpdate",value:function(e,t){var n=this.state.currentHost,a=this.props,r=a.hostList,s=a.cur_parent_cluster;if((0,pe.isEqual)(s,e.cur_parent_cluster)||this.getHostGroups(),!(0,pe.isEqual)(r,e.hostList)){var o={host:r[0],index:0};(null==n?void 0:n.hostIp)!==o.host&&Z()(r).call(r,(function(e,t){e.ip===n.ip&&(o.host=e,o.index=t)})),this.handleSideHostClick(o.host,o.index)}}},{key:"componentWillUnmount",value:function(){this.props.actions.updateHostsList({data:{hosts:[],count:0}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.actions,a=t.history,r=t.selectedIndex,s=t.hostList,o=t.hostGroupLists,l=t.pager,i=t.selectedHost,c=t.selectedHostServices,u=t.cur_parent_cluster;return H.createElement("div",{className:"host-container",style:{height:this.state.sideNavHeight}},H.createElement(M,{loading:this.state.sideNavLoading,selectedGroup:this.state.selectedGroup,selectedIndex:r,handleSearch:this.handleSideSearch,clickGroup:function(t){e.getHostList(t)},pager:l,handleHostItemClick:function(t,n){return e.handleSideHostClick(t,n)},style:{height:this.state.sideNavHeight},hostList:s,hostGroupLists:o}),H.createElement("div",{className:"detail-container",style:{height:this.state.sideNavHeight,overflow:"auto"}},H.createElement(x.Z,null,H.createElement(me,{tab:"运行状态",key:"1"},H.createElement(ie,{detailData:i,runningServices:c,getServicesList:n.updateServicesList,cur_parent_cluster:u,history:a,selectedHost:i})),H.createElement(me,{tab:"仪表盘",key:"2"},H.createElement(ce,{searchStr:"?host=".concat(null==i?void 0:i.ip),cur_parent_cluster:u})))))}}]),n}(H.Component))||ue},64143:(e,t,n)=>{n.d(t,{Z:()=>g});var a=n(77766),r=n.n(a),s=n(78914),o=n.n(s),l=n(81643),i=n.n(l),c=n(2991),u=n.n(c),p=n(86902),d=n.n(p),m=n(31238),f=n.n(m),h=n(45360),_=n(36808),v=n(18274);const g={pageWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},pageHeight:function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},getBase64:function(e,t){var n=new FileReader;n.addEventListener("load",(function(){return t(n.result)})),n.readAsDataURL(e)},percent:function(e,t){return e&&e!==1/0?(e>1&&(e=1),t=t||2,t=Math.pow(10,t),Math.round(e*t*100)/t+"%"):"0%"},getCssText:function(e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t},formateDateTime:function(e){var t,n,a,s,o;if(!e)return"";var l=new Date(e),i=l.getFullYear(),c=l.getMonth()+1+"",u=l.getDate()+"",p=l.getHours()+"",d=l.getMinutes()+"",m=l.getSeconds()+"";return 1===c.toString().length&&(c="0".concat(c)),1===u.toString().length&&(u="0".concat(u)),1===p.toString().length&&(p="0".concat(p)),1===d.toString().length&&(d="0".concat(d)),1===m.toString().length&&(m="0".concat(m)),r()(t=r()(n=r()(a=r()(s=r()(o="".concat(i,"-")).call(o,c,"-")).call(s,u," ")).call(a,p,":")).call(n,d,":")).call(t,m)},formateDate:function(e){var t,n;if(!e)return"";var a=new Date(e),s=a.getFullYear(),o=a.getMonth()+1+"",l=a.getDate()+"";return 1===o.toString().length&&(o="0".concat(o)),1===l.toString().length&&(l="0".concat(l)),r()(t=r()(n="".concat(s,"-")).call(n,o,"-")).call(t,l)},trim:function(e){return"string"==typeof e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},messageFilter:function(e,t,n,a){1001===e.status.code&&(a||h.Z.success("成功"),t&&t())},getTableParam:function(e){var t={};return o()(e).call(e,(function(e,n){var a=e.split("-");t[a[1]]=a[2]})),t},setAlertControl:function(e){var t={},n=e.alert_control;return"1"===n?t.close=1:(t.close=0,e["alert_num_"+n]&&(t.times_after_close=e["alert_num_"+n]),e["recover_num_"+n]&&(t.close_after_long_time_reset_amount=e["recover_num_"+n],t.close_after_long_time_reset_unit=e["recover_unit_"+n])),t},getAlertControl:function(e){var t={alert_control:""};return 0===e.close&&(0!==e.times_after_close?(t.alert_control="2",t["alert_num_"+t.alert_control]=e.times_after_close):t.alert_control="3",""!==e.close_after_long_time_reset_amount&&("2"===t.alert_control&&(t.alert_control="4"),t["alert_num_"+t.alert_control]=e.times_after_close,t["recover_num_"+t.alert_control]=e.close_after_long_time_reset_amount,t["recover_unit_"+t.alert_control]=e.close_after_long_time_reset_unit)),t},filterOption:function(e,t){var n;return-1!==i()(n=t.props.children).call(n,e)},getParamsFromUrl:function(e){var t={},n=[],a="",r="",s=e.substring(i()(e).call(e,"?")+1,e.length).split("&");for(var o in s)a=(n=s[o].split("="))[0],r=n[1],t[a]=r;return t},jsonToQuery:function(e){var t;return e?function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}(u()(t=d()(e)).call(t,(function(t){return void 0===e[t]?"":encodeURIComponent(t)+"="+encodeURIComponent(e[t])}))).join("&"):""},checkNullObj:function(e){return 0===d()(e).length},serviceCallback:function(e,t,n){0===e.data.code?(h.Z.success(t),n&&n()):h.Z.error(e.data.msg)},noAuthorityToDO:function(e,t){return!e[t]&&(h.Z.error("权限不足，请联系管理员!"),!0)},get k8sNamespace(){return _.get(v.E9.NAMESPACE)},setNaviKey:function(e,t){sessionStorage.setItem("firstLevelNav",e),sessionStorage.setItem("siderLevelNav",t)},formatGBUnit:function(e){return i()(e).call(e,"MB")>-1?f()(e.replace("MB",""))/1024:i()(e).call(e,"KB")>-1?f()(e.replace("KB",""))/1024/1024:i()(e).call(e,"GB")>-1?f()(e.replace("GB","")):i()(e).call(e,"TB")>-1?1024*f()(e.replace("TB","")):0}}}}]);