"use strict";(self.webpackChunkdt_em_front=self.webpackChunkdt_em_front||[]).push([[2913],{32882:(e,t,n)=>{n.r(t),n.d(t,{addHaRoleToHosts:()=>oe,clearGroupList:()=>W,disableInstance:()=>ee,getALLProducts:()=>ae,getHealthCheck:()=>q,getHostConfig:()=>Y,getHostsList:()=>J,getServiceConfigList:()=>ie,getServiceGroup:()=>D,getServiceList:()=>$,modifyMultiAllHosts:()=>me,modifyMultiSingleField:()=>ge,modifyProductConfigAll:()=>fe,operateExtension:()=>j,refreshProductAndService:()=>ve,resetMultiServiceConfig:()=>pe,resetServiceConfig:()=>de,resetServices:()=>he,setConfigFile:()=>le,setCurrentProduct:()=>ce,setCurrentService:()=>se,setRedService:()=>re,setResartServiceList:()=>z,setServiceConfigModify:()=>ue,setServiceGroupStart:()=>U,setServiceGroupStop:()=>M,setServiceRollRestartState:()=>_e,startInstance:()=>te,startService:()=>K,stopInstance:()=>ne,stopService:()=>Q});var r=n(44845),o=n(78914),a=n.n(o),c=n(77766),l=n.n(c),i=n(2991),s=n.n(i),u=n(86902),d=n.n(u),p=n(3649),f=n.n(p),m=n(66419),g=n.n(m),v=n(65420),_=n.n(v),h=n(19996),S=n.n(h),y=n(41511),E=n.n(y),Z=n(14310),T=n.n(Z),C=n(20116),x=n.n(C),R=n(34074),b=n.n(R),F=n(39649),H=n.n(F),I=n(20368),L=n.n(I),N=n(63978),w=n.n(N),P=n(45360),G=n(19528),B=n(56466);function k(e,t){var n=d()(e);if(T()){var r=T()(e);t&&(r=x()(r).call(r,(function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n,o,c=null!=arguments[t]?arguments[t]:{};t%2?a()(n=k(Object(c),!0)).call(n,(function(t){(0,r.Z)(e,t,c[t])})):H()?L()(e,H()(c)):a()(o=k(Object(c))).call(o,(function(t){w()(e,t,b()(c,t))}))}return e}function O(e,t){var n=void 0!==_()&&S()(e)||e["@@iterator"];if(!n){if(E()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return V(e,t);var r=f()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return g()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw a}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(e,t,n,r){return function(o){G.BZ.getServiceGroup(e,r).then((function(e){0===(e=e.data).code?function(){var r=0,c="",i=[],u="sub0_0";if(n&&""!==n)for(var p in e.data.groups){var f;a()(f=e.data.groups[p]).call(f,(function(e,t){var o;e.service_name===n&&(c=e,u=l()(o="sub".concat(r,"_")).call(o,t));i.push("f".concat(r))})),r++}else{var m,g=sessionStorage.getItem("service_object");s()(m=d()(e.data.groups)).call(m,(function(t,n){if(0!==n||g||(c=e.data.groups[t][0]),g){var r,o="string"==typeof g?JSON.parse(g):{group:"",objectValue:""};if(t===o.group)s()(r=e.data.groups[t]).call(r,(function(e,t){var r;e.service_name===o.objectValue&&(c=e,u=l()(r="sub".concat(n,"_")).call(r,t))}));sessionStorage.removeItem("service_object")}i.push("f".concat(n))}))}if(!c&&1===i.length&&"f0"===i[0]&&"sub0_0"===u){var v=d()(e.data.groups)[0];c=v&&e.data.groups[v]&&e.data.groups[v][0]||""}t(c,i,u),o({type:B.S9.GET_SERVICE_GROUP,payload:e.data.groups})}():P.Z.error(e.msg)}))}},U=function(e,t){return function(n){G.BZ.setServiceGroupStart(e).then((function(e){X(e,"",t,(function(){n({type:B.S9.UPDATE_SERVICE_LIST,payload:e.data})}))}))}},q=function(e){return function(t){G.BZ.getHealthCheck(e).then((function(e){var n=e.data;0===n.code?t({type:B.S9.GET_HEALTH_LIST,payload:n.data}):P.Z.error(n.msg)}))}},M=function(e,t){return function(n){G.BZ.setServiceGroupStop(e).then((function(e){X(e,"",t,(function(){n({type:B.S9.UPDATE_SERVICE_LIST,payload:e.data})}))}))}},j=function(e,t){return function(t){G.BZ.operateExtension(e)}},z=function(e){return function(t){t({type:B.S9.GET_RESART_SERVICE,payload:e})}},W=function(){return{type:B.S9.CLEAR_SERVICE_LIST}},$=function(e,t){return function(n){G.BZ.getServiceList(e).then((function(e){0===(e=e.data).code?(n({type:B.S9.GET_SERVICES,payload:e.data.services}),t(e.data.services[0])):P.Z.error(e.msg)}))}},J=function(e,t){var n=e.service_name;return function(r){G.BZ.getServiceHostsList(e).then((function(e){0===(e=e.data).code?(r({type:B.S9.GET_HOSTS,payload:{use_cloud:e.data.use_cloud,hosts:e.data.list,service:n}}),t&&t(e.data.use_cloud,e.data.list)):P.Z.error(e.msg)}))}},Y=function(e,t){return function(n){G.BZ.getServiceHostConfig(e).then((function(e){0===(e=e.data).code?(n({type:B.S9.GET_HOST_CONFIG,payload:e.data.result}),t()):P.Z.error(e.msg)}))}},K=function(e,t){return function(){G.BZ.startService(e).then((function(e){X(e,"服务启动成功！",t)}))}},Q=function(e,t){return function(){G.BZ.stopService(e).then((function(e){X(e,"服务关闭成功！",t)}))}};function X(e,t,n,r){0===(e=e.data).code?(r&&r(),t&&P.Z.success(t)):P.Z.error(e.msg),n&&n()}var ee=function(e){var t=e.instance_index,n=e.service_name;return{type:B.S9.DISABLE_INSTANCE,payload:{instance_index:t,service_name:n}}},te=function(e,t){var n=e.service_name;return function(r){G.BZ.startServiceInstance(e).then((function(o){0===(o=o.data).code?(r({type:B.S9.START_INSTANCE,payload:{instance_index:e.instance_index,service_name:n}}),t&&t()):P.Z.error(o.msg)}))}},ne=function(e,t){var n=e.service_name;return function(r){G.BZ.stopServiceInstance(e).then((function(o){0===(o=o.data).code?(r({type:B.S9.STOP_INSTANCE,payload:{instance_index:e.instance_index,service_name:n}}),t()):P.Z.error(o.msg)}))}},re=function(e){return{type:B.S9.SET_RED_SERVICE,payload:e}},oe=function(e,t){return{type:B.S9.ADD_HA_ROLE,payload:{roles:e,service_name:t}}},ae=function(){return function(e){G.BZ.getProductList({limit:0}).then((function(t){if(0===(t=t.data).code){var n,r=[],o=O(t.data.list);try{for(o.s();!(n=o.n()).done;){var a=n.value;1===a.is_current_version&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}e({type:B.S9.GET_ALL_PRODUCTS,payload:r})}}))}},ce=function(e){return{type:B.S9.SET_CURRENT_PRODUCT,payload:e}},le=function(e){return{type:B.S9.SET_CONFIG_FILE,payload:e}},ie=function(e,t){return function(n,r){var o=r().ServiceStore,c=o.cur_service,l=o.configFile,i=t||c;G.BZ.getServiceConfig(A(A({},e),{},{file:e.file||l})).then((function(e){var t=e.data,r=t.code,o=t.data,c=t.msg;if(0===r){var l={},s=(null==o?void 0:o.list)||[];a()(s).call(s,(function(e){l[e.config]=A(A({},e),{},{iconType:0})})),i.Config=l,n({type:B.S9.SET_CURRENT_SERVICE,payload:i})}else P.Z.error(c)}))}},se=function(e,t){return t?function(n){n(ie(t,e))}:{type:B.S9.SET_CURRENT_SERVICE,payload:e}},ue=function(e){return{type:B.S9.SET_CONFIG_MODIFY,payload:{cur_service:e}}},de=function(e){var t=e.product_name,n=e.service_name;return function(r){G.BZ.resetServiceConfig({product_name:t,service_name:n,pid:e.pid,product_version:e.product_version,field_path:e.field_path}).then((function(t){0===(t=t.data).code?r(ve(e)):P.Z.error(t.msg)}))}},pe=function(e){var t=e.product_name,n=e.service_name;return function(r){G.BZ.resetMultiServiceConfig({product_name:t,service_name:n,pid:e.pid,product_version:e.product_version,field_path:e.field_path,hosts:e.hosts}).then((function(t){0===(t=t.data).code?r(ve(e)):P.Z.error(t.msg)}))}},fe=function(e,t){var n=e.product_name,r=e.service_name;return function(o){G.BZ.modifyProductConfigAll({product_name:n,service_name:r},t).then((function(t){0===(t=t.data).code?(P.Z.success("保存成功"),o(ve(e))):P.Z.error(t.msg)}))}},me=function(e,t){var n=e.product_name,r=e.service_name;return function(o){G.BZ.modifyMultiAllHosts({product_name:n,service_name:r},t).then((function(t){0===(t=t.data).code?(P.Z.success("保存成功"),o(ve(e))):P.Z.error(t.msg)}))}},ge=function(e,t){var n=e.product_name,r=e.service_name;return function(o){G.BZ.modifyMultiAllHosts({product_name:n,service_name:r},t).then((function(t){0===(t=t.data).code?(P.Z.success("保存成功"),o(ve(e))):P.Z.error(t.msg)}))}},ve=function(e){var t=e.product_name,n=e.service_name;return function(r,o){var c=o().ServiceStore.configFile;G.BZ.getProductList({limit:0}).then((function(o){if(0===(o=o.data).code){var l,i=o.data.list,s=null,u=null,d=O(i);try{for(d.s();!(l=d.n()).done;){var p=l.value;if("product_version"in e){var f=e.product_version;p.product_name===t&&p.product_version===f&&(s=p)}else p.product_name===t&&(s=p)}}catch(e){d.e(e)}finally{d.f()}if(s)for(var m in s.product.Service)m===n&&(u=s.product.Service[m]);r({type:B.S9.REFRESH_PROD_SERVICE,payload:{products:i,cur_product:s,cur_service:u}}),G.BZ.getServiceConfig({product_name:t,service_name:n,product_version:s.product_version,file:c}).then((function(e){var t=e.data,n=t.code,o=t.data;if(0===n){var c=(void 0===o?{}:o).list,l=void 0===c?[]:c;a()(l).call(l,(function(e){u.Config[e.config]=e})),r({type:B.S9.SET_CURRENT_SERVICE,payload:u})}}))}else P.Z.error(o.msg)}))}},_e=function(e,t){return{type:B.S9.SWITCH_SERVICE_RESTART,payload:{service_name:e,isRestart:t}}},he=function(){return{type:B.S9.GET_SERVICES,payload:[]}}},22913:(e,t,n)=>{n.r(t),n.d(t,{default:()=>oe});var r=n(1068),o=n.n(r),a=n(73126),c=n(71649),l=n(95266),i=n(68420),s=n(27344),u=n(5281),d=n(84441),p=n(3020),f=n(3362),m=n(44845),g=n(51942),v=n.n(g),_=n(78914),h=n.n(_),S=n(77766),y=n.n(S),E=n(31581),Z=n.n(E),T=n(2991),C=n.n(T),x=n(41511),R=n.n(x),b=n(3649),F=n.n(b),H=n(78580),I=n.n(H),L=n(67294),N=n(29027),w=n(15857),P=n(97183),G=n(4107),B=n(45360),k=n(34041),A=n(69035),O=n(66253),V=n(31097),D=n(71230),U=n(15746),q=n(77268),M=n(67908),j=n(11382),z=n(19528),W=n(32882),$=n(41266),J=["text","markText"];function Y(e){var t=function(){if("undefined"==typeof Reflect||!o())return!1;if(o().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var a=(0,f.Z)(this).constructor;n=o()(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}const K=function(e){(0,d.Z)(n,e);var t=Y(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"renderMark",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=new RegExp(t,"g");return e.replace(n,'<span style="color: #2391F7">'.concat(t,"</span>"))}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.markText,r=(0,$.Z)(e,J);return L.createElement("span",(0,a.Z)({dangerouslySetInnerHTML:{__html:this.renderMark(t,n)}},r))}}]),n}(L.Component);var Q,X=n(96486);function ee(e){var t=function(){if("undefined"==typeof Reflect||!o())return!1;if(o().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var a=(0,f.Z)(this).constructor;n=o()(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var te=P.Z.Content,ne=G.Z.Search,re=(0,N.$j)((function(e){return{HeaderStore:e.HeaderStore,ServiceStore:e.ServiceStore,authorityList:e.UserCenterStore.authorityList}}),(function(e){return{actions:(0,w.DE)(v()({},W),e)}}))(Q=function(e){(0,d.Z)(r,e);var t=ee(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),(0,m.Z)((0,u.Z)(n),"state",{products:[],serviceGroup:[],hostGroup:[],fileGroup:[],cur_product:"",cur_service:"",cur_host:null,log_service_id:null,action:"latest",cur_file:"",logPaths:[],fileType:"txt",sourceRange:[],sourceText:[],tex:"",fileLoading:!1,cur_type:"",markText:"",downUrl:"",isFullScreen:!1}),(0,m.Z)((0,u.Z)(n),"componentDidMount",(function(){var e=n.props.location.state;e&&(n.setState({cur_product:e.product_name,cur_service:e.service_name,cur_host:e.log_service_id},(function(){n.handleSelectProduct(e.product_name),n.handSelectService(e.service_name),n.handSelectHost(e.log_service_id)})),n.props.form.setFieldsValue({component:e.product_name,service:e.service_name,host:e.log_service_id}));var t=n.props.HeaderStore.cur_parent_product;n.getProductList(t);var r=document.getElementById("textPre");"txt"===n.state.fileType&&(r.scrollTop=r.scrollHeight-r.clientHeight-30,r.addEventListener("scroll",n.onScrollEvent)),n.watchFullScreen()})),(0,m.Z)((0,u.Z)(n),"componentDidUpdate",(function(e){e.HeaderStore!==n.props.HeaderStore&&(n.props.form.setFieldsValue({component:null,service:null,host:null}),n.setState({serviceGroup:[],hostGroup:[],fileGroup:[],cur_product:null,cur_host:null,cur_service:"",sourceText:[],sourceRange:[]}))})),(0,m.Z)((0,u.Z)(n),"onScrollEvent",(0,X.debounce)((function(){var e=document.getElementById("textPre"),t=e.scrollTop,r=e.clientHeight,o=e.scrollHeight,a=n.state,c=a.sourceText,l=a.sourceRange;c.length&&(t<1&&1===l[0]||(t+r>o-.5?n.onLogFileContent("down"):t<1&&n.onLogFileContent("up")))}),800)),(0,m.Z)((0,u.Z)(n),"getProductList",(function(e){var t=(0,u.Z)(n);z.BZ.getProductName({parentProductName:e}).then((function(e){var n;if(0===(e=e.data).code&&null!==(n=e.data)&&void 0!==n&&n.list){var r,o=null===(r=e.data)||void 0===r?void 0:r.list;t.setState({products:o})}}))})),(0,m.Z)((0,u.Z)(n),"handleSelectProduct",(function(e){var t=[];n.setState({serviceGroup:[],hostGroup:[],fileGroup:[],cur_product:e,cur_host:null,cur_service:"",cur_file:"",sourceText:[],sourceRange:[]}),n.props.form.setFieldsValue({component:e,service:"",host:null,file:void 0}),z.BZ.getServiceGroup({product_name:e}).then((function(e){if(0===(e=e.data).code)if(e.data.count>0)for(var r in e.data.groups)t.push({name:r,list:e.data.groups[r]}),n.setState({serviceGroup:t});else B.Z.error(e.msg)}))})),(0,m.Z)((0,u.Z)(n),"handSelectService",(function(e){n.setState({cur_service:e,cur_host:null,cur_file:"",hostGroup:[],fileGroup:[],sourceText:[],sourceRange:[]}),n.props.form.setFieldsValue({service:e,host:null,file:void 0});var t=[];z.BZ.getServiceHostsList({product_name:n.state.cur_product,service_name:e}).then((function(e){var r;0===(e=e.data).code?e.data.count>0&&(h()(r=e.data.list).call(r,(function(e){t.push({label:e.id,value:e.ip})})),n.setState({hostGroup:t})):B.Z.error(e.msg)}))})),(0,m.Z)((0,u.Z)(n),"handSelectHost",(function(e){n.setState({cur_host:e,cur_file:"",fileGroup:[],sourceText:[],sourceRange:[]}),n.props.form.setFieldsValue({host:e,file:void 0});var t=n.state.fileType;z.BZ.getLogFileList({instanceId:e,type:t}).then((function(e){0===(e=e.data).code?n.setState({fileGroup:e.data.list}):B.Z.error(e.msg)}))})),(0,m.Z)((0,u.Z)(n),"handSelectFile",(function(e){n.setState({cur_file:e,sourceText:[],sourceRange:[]}),"txt"===n.state.fileType&&n.setState({cur_file:e},(function(){n.onLogFileContent("latest")}))})),(0,m.Z)((0,u.Z)(n),"getLogReqRange",(function(e){var t,r,o=(0,l.Z)(n.state.sourceRange,2),a=o[0],c=o[1];if("up"===e){var i=a-300+1;t=i<1?1:i,r=a-1}else"down"===e&&(t=c+1,r=c+300);return{start:t,end:r}})),(0,m.Z)((0,u.Z)(n),"getNewSourceText",(function(e,t){var r,o;if("latest"===e)return t;var a=n.state.sourceText;return"up"===e?y()(r=[]).call(r,(0,c.Z)(t),(0,c.Z)(a)):y()(o=[]).call(o,(0,c.Z)(a),(0,c.Z)(t))})),(0,m.Z)((0,u.Z)(n),"getSourceRange",(function(e,t,r){var o,a,c=(0,l.Z)(n.state.sourceRange,2),i=c[0],s=c[1];if("up"===e){var u=i||t;o=u<300?1:u-300+1,a=s||t}else if("latest"===e){o=t<300?1:t-300+1,a=t}else{var d=s+300;o=i,a=d>t?t:d}return[o,a]})),(0,m.Z)((0,u.Z)(n),"onLogFileContent",(function(e){var t=n.getLogReqRange(e),r=t.start,o=t.end,a={logfile:n.state.cur_file,action:e,start:r,end:o},c=document.getElementById("textPre"),l=c.scrollHeight;n.setState({fileLoading:!0,cur_type:e}),z.BZ.getLogFile({instanceId:n.state.cur_host},a).then((function(t){var r=t.data,o=r.code,a=r.data,i=r.msg;if(0===o){var s=(null==a?void 0:a.list)||[],u=(null==a?void 0:a.total)||0,d=n.getNewSourceText(e,s);n.setState({sourceText:d,fileLoading:!1,sourceRange:n.getSourceRange(e,u,d)},(function(){if("up"===e)var t=Z()((function(){var e=c.scrollHeight;e>l&&(c.scrollTop=e-l,clearInterval(t))}),1e3);else"latest"===e?c.scrollTop=c.scrollHeight-c.clientHeight-30:0===s.length&&(c.scrollTop=c.scrollHeight-c.clientHeight-50);c.addEventListener("scroll",n.onScrollEvent)}))}else n.setState({fileLoading:!1}),B.Z.error(i)}))})),(0,m.Z)((0,u.Z)(n),"handleLogFileDown",(function(){var e;if(n.props.authorityList.log_download){var t=n.state,r=t.cur_host,o=t.cur_file;n.setState({downUrl:y()(e="/api/v2/instance/".concat(r,"/logdown?logfile=")).call(e,o)})}else B.Z.error("权限不足，请联系管理员！")})),(0,m.Z)((0,u.Z)(n),"handleSearchChange",(function(e){n.setState({markText:e})})),(0,m.Z)((0,u.Z)(n),"onRadioChange",(function(e){n.props.form.setFieldsValue({file:void 0}),n.setState({fileType:e.target.value,sourceText:[],sourceRange:[],cur_file:"",fileGroup:[]},(function(){"zip"===n.state.fileType&&n.setState({sourceText:[],sourceRange:[]}),n.state.cur_product&&n.state.cur_host&&n.state.cur_service&&n.handSelectHost(n.state.cur_host)}))})),(0,m.Z)((0,u.Z)(n),"handleFullScreen",(function(){n.state.isFullScreen?(n.setState({isFullScreen:!1}),n.exitFullscreen()):n.requestFullScreen()})),(0,m.Z)((0,u.Z)(n),"requestFullScreen",(function(){n.setState({isFullScreen:!0});var e=document.getElementById("textPre"),t=e.scrollTop/(e.scrollHeight-e.clientHeight);e.className+=" log_table_fullContent","txt"===n.state.fileType&&(e.scrollTop+e.clientHeight>e.scrollHeight-.5?e.scrollTop=(e.scrollHeight-e.clientHeight)*t-5:e.scrollTop<1?e.scrollTop=(e.scrollHeight-e.clientHeight)*t+5:e.scrollTop=(e.scrollHeight-e.clientHeight)*t);var r=document.getElementById("monitorDataFlowContainer");r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullScreen&&r.webkitRequestFullScreen()})),(0,m.Z)((0,u.Z)(n),"exitFullscreen",(function(){var e=document.getElementById("textPre"),t=e.scrollTop/(e.scrollHeight-e.clientHeight);e.className="log_table_content","txt"===n.state.fileType&&(e.scrollTop+e.clientHeight>e.scrollHeight-.5?e.scrollTop=(e.scrollHeight-e.clientHeight)*t-5:e.scrollTop<1?e.scrollTop=(e.scrollHeight-e.clientHeight)*t+5:e.scrollTop=(e.scrollHeight-e.clientHeight)*t);var r=document;r.exitFullscreen?r.exitFullscreen():r.mozCancelFullScreen?r.mozCancelFullScreen():r.webkitCancelFullScreen&&r.webkitCancelFullScreen()})),(0,m.Z)((0,u.Z)(n),"watchFullScreen",(function(){var e=(0,u.Z)(n),t=document;document.addEventListener("fullscreenchange",(function(){e.setState({isFullScreen:t.fullscreen}),t.fullscreen||(document.getElementById("textPre").className="log_table_content")}),!1),document.addEventListener("webkitfullscreenchange",(function(){e.setState({isFullScreen:t.webkitIsFullScreen}),t.webkitIsFullScreen||(document.getElementById("textPre").className="log_table_content")}),!1),document.addEventListener("mozfullscreenchange",(function(){e.setState({isFullScreen:t.mozFullScreen}),t.mozFullScreen||(document.getElementById("textPre").className="log_table_content")}),!1)})),n}return(0,s.Z)(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.authorityList,o=t.form.getFieldDecorator,c=k.Z.Option,l=k.Z.OptGroup,i=this.state,s=i.products,u=i.serviceGroup,d=i.hostGroup,p=i.fileLoading,f=i.cur_type,m=i.sourceText,g=i.sourceRange,v=i.markText,_=i.fileType,h=i.cur_file,S=i.downUrl,y=i.fileGroup,E=i.isFullScreen,Z={wrapperCol:{span:22}};return L.createElement(P.Z,{id:"monitorDataFlowContainer"},L.createElement(te,null,L.createElement("div",{className:"div_fullscreen"},E?L.createElement("span",{onClick:this.handleFullScreen},L.createElement("img",{src:n(60583),style:{width:"40px"}})):L.createElement("span",{onClick:this.handleFullScreen},L.createElement("img",{src:n(2528),style:{width:"40px"}}))),L.createElement("div",{className:"dash-page"},L.createElement("div",{className:"top-navbar clearfix"},L.createElement(A.Z,{className:"ant-advanced-search-form"},L.createElement("div",{style:{minWidth:"1000px",display:"flex"}},L.createElement(A.Z.Item,{label:"组件："},o("component",{rules:[{required:!0,message:"请选择组件"}]})(L.createElement(k.Z,{className:"dt-form-shadow-bg",style:{width:264},onChange:this.handleSelectProduct,getPopupContainer:function(e){return e.parentNode}},s?C()(s).call(s,(function(e,t){return L.createElement(c,{key:t,value:e.product_name},e.product_name)})):""))),L.createElement(A.Z.Item,{label:"服务："},o("service",{rules:[{required:!0,message:"请选择服务"}]})(L.createElement(k.Z,{className:"dt-form-shadow-bg",style:{width:264},onChange:this.handSelectService,getPopupContainer:function(e){return e.parentNode}},u?C()(u).call(u,(function(e,t){var n;return L.createElement(l,{label:e.name,key:t},C()(n=e.list).call(n,(function(e,t){return L.createElement(c,{key:t,value:e.service_name},e.service_name)})))})):""))),L.createElement(A.Z.Item,{label:"主机："},o("host",{rules:[{required:!0,message:"请选择主机"}]})(L.createElement(k.Z,{className:"dt-form-shadow-bg",style:{width:264},onChange:this.handSelectHost,getPopupContainer:function(e){return e.parentNode}},d?C()(d).call(d,(function(e){return L.createElement(c,{key:e.label,value:e.label},e.value)})):[])))),L.createElement("div",{style:{minWidth:"1280px",display:"flex"}},L.createElement(A.Z.Item,(0,a.Z)({label:"日志文件"},{labelCol:{span:6},wrapperCol:{span:18}}),L.createElement(O.ZP.Group,{onChange:this.onRadioChange,value:_},L.createElement(O.ZP,{value:"txt"},"文本文件"),L.createElement(O.ZP,{value:"zip"},"压缩文件"))),L.createElement(A.Z.Item,Z,o("file",{rules:[{required:!0,message:"请选择日志文件"}]})(L.createElement(k.Z,{placeholder:"请选择日志文件",className:"dt-form-shadow-bg",style:{width:264},getPopupContainer:function(e){return e.parentNode},onChange:this.handSelectFile,showSearch:!0},R()(y)&&C()(y).call(y,(function(e,t){return L.createElement(c,{key:t,value:e},L.createElement(V.Z,{placement:"right",title:e,key:t},e.length>35?F()(e).call(e,0,35)+"...":e))}))))),L.createElement(A.Z.Item,Z,L.createElement(ne,{placeholder:"请输入日志关键字",className:"dt-form-shadow-bg",style:{width:264},onSearch:this.handleSearchChange}))))),L.createElement("div",{className:"log_table box-shadow-style"},L.createElement(D.Z,{className:"log_table_header"},L.createElement(U.Z,{span:3,style:{padding:"6px"}},"日志内容"),L.createElement(U.Z,{span:21,style:{textAlign:"right"}},L.createElement(q.Z,{type:"primary",style:{marginRight:"5px"},ghost:!0,disabled:!("txt"===_&&h),onClick:function(){return e.onLogFileContent("latest")}},L.createElement(M.Z,{type:"step-forward"})," 跳至日志最新行"),r.log_download&&L.createElement(q.Z,{type:"primary",ghost:!0,disabled:!h,onClick:this.handleLogFileDown},L.createElement("a",{href:S,download:h},L.createElement(M.Z,{type:"download"})," 下载完整日志")))),L.createElement(j.Z,{spinning:p&&"latest"===f,tip:"日志加载中...",style:{width:"100%"}},L.createElement("div",{className:"log_table_content",id:"textPre"},m.length>0&&L.createElement(j.Z,{spinning:p&&"up"===f,style:{position:"relative",paddingLeft:"49%"}}),g.length>0&&1===g[0]&&L.createElement("div",{className:"log-to-top"},L.createElement("span",null,"日志到顶啦"),L.createElement("div",{className:"line"})),"zip"===_?L.createElement("div",{className:"log_content",id:"log_content"},L.createElement("p",{className:"log_table_content_p1"},L.createElement("img",{src:n(59781),className:"textPre_img"})),L.createElement("p",{className:"log_table_content_p2"},"不支持压缩文件日志内容预览，请下载查看!")):m.length?C()(m).call(m,(function(e,t){var n=g.length?g[0]:1;return I()(e).call(e,"ERROR")?L.createElement("p",{className:"log_table_content__line",key:t.toString(),style:{color:"red"}},L.createElement("span",{className:"line_number"},n+t),L.createElement(K,{text:e,markText:v})):L.createElement("p",{className:"log_table_content__line",key:t.toString()},L.createElement("span",{className:"line_number"},n+t),L.createElement(K,{text:e,markText:v}))})):h&&!p&&L.createElement("div",{className:"log_content",id:"log_content"},L.createElement("p",{className:"log_table_content_p1"},L.createElement("img",{src:n(59781),className:"textPre_img"})),L.createElement("p",{className:"log_table_content_p2"},"当前日志文件下暂无具体日志!")),m.length?L.createElement(j.Z,{spinning:p&&"down"===f,style:{position:"relative",paddingLeft:"49%"}}):""))))))}}]),r}(L.Component))||Q;const oe=A.Z.create()(re)},59781:(e,t,n)=>{e.exports=n.p+"images/a7965899f74a9be33c01.png"},2528:(e,t,n)=>{e.exports=n.p+"images/10f3e567caa4c08c5650.png"},60583:(e,t,n)=>{e.exports=n.p+"images/5fc548255abd3e6425ab.png"}}]);