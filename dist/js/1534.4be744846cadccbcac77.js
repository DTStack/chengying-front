"use strict";(self.webpackChunkdt_em_front=self.webpackChunkdt_em_front||[]).push([[1534],{48006:(e,t,n)=>{n.d(t,{U:()=>L});var i=n(17301),r=n(97295),s=n(33181),o=n(50187),a=n(24314),l=n(3860);class u{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new s.rS(new a.e(1,1,1,1),0,new o.L(1,1),0),new s.rS(new a.e(1,1,1,1),0,new o.L(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new s.Vi(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return l.Y.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){const n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),o=e.normalizePosition(n,2),l=this._validatePositionWithCache(e,i,n,o),u=this._validatePositionWithCache(e,r,i,l);return n.equals(o)&&i.equals(l)&&r.equals(u)?t:new s.rS(a.e.fromPositions(l,u),t.selectionStartLeftoverVisibleColumns+i.column-l.column,o,t.leftoverVisibleColumns+n.column-o.column)}_setState(e,t,n){if(n&&(n=u._validateViewState(e.viewModel,n)),t){const n=e.model.validateRange(t.selectionStart),i=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),o=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new s.rS(n,i,r,o)}else{if(!n)return;const i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new s.rS(i,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){const i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new s.rS(i,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const i=e.coordinatesConverter.convertModelPositionToViewPosition(new o.L(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new o.L(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),l=new a.e(i.lineNumber,i.column,r.lineNumber,r.column),u=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new s.rS(l,t.selectionStartLeftoverVisibleColumns,u,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}}class h{constructor(e){this.context=e,this.primaryCursor=new u(e),this.secondaryCursors=[],this.lastAddedCursorIndex=0}dispose(){this.primaryCursor.dispose(this.context),this.killSecondaryCursors()}startTrackingSelections(){this.primaryCursor.startTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].startTrackingSelection(this.context)}stopTrackingSelections(){this.primaryCursor.stopTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){this.primaryCursor.ensureValidState(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].ensureValidState(this.context)}readSelectionFromMarkers(){let e=[];e[0]=this.primaryCursor.readSelectionFromMarkers(this.context);for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].readSelectionFromMarkers(this.context);return e}getAll(){let e=[];e[0]=this.primaryCursor.asCursorState();for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].asCursorState();return e}getViewPositions(){let e=[];e[0]=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].viewState.position;return e}getTopMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++){const n=this.secondaryCursors[t].viewState.position;n.isBefore(e)&&(e=n)}return e}getBottomMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++){const n=this.secondaryCursors[t].viewState.position;e.isBeforeOrEqual(n)&&(e=n)}return e}getSelections(){let e=[];e[0]=this.primaryCursor.modelState.selection;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].modelState.selection;return e}getViewSelections(){let e=[];e[0]=this.primaryCursor.viewState.selection;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].viewState.selection;return e}setSelections(e){this.setStates(s.Vi.fromModelSelections(e))}getPrimaryCursor(){return this.primaryCursor.asCursorState()}setStates(e){null!==e&&(this.primaryCursor.setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.secondaryCursors.length,n=e.length;if(t<n){let e=n-t;for(let t=0;t<e;t++)this._addSecondaryCursor()}else if(t>n){let e=t-n;for(let t=0;t<e;t++)this._removeSecondaryCursor(this.secondaryCursors.length-1)}for(let t=0;t<n;t++)this.secondaryCursors[t].setState(this.context,e[t].modelState,e[t].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.secondaryCursors.push(new u(this.context)),this.lastAddedCursorIndex=this.secondaryCursors.length}getLastAddedCursorIndex(){return 0===this.secondaryCursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.secondaryCursors[e].dispose(this.context),this.secondaryCursors.splice(e,1)}_getAll(){let e=[];e[0]=this.primaryCursor;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t];return e}normalize(){if(0===this.secondaryCursors.length)return;let e=this._getAll(),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort((e,t)=>e.selection.startLineNumber===t.selection.startLineNumber?e.selection.startColumn-t.selection.startColumn:e.selection.startLineNumber-t.selection.startLineNumber);for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1],o=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let u;if(u=a.isEmpty()||o.isEmpty()?a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):a.getStartPosition().isBefore(o.getEndPosition()),u){const o=i.index<r.index?n:n+1,a=i.index<r.index?n+1:n,u=t[a].index,h=t[o].index,c=t[a].selection,d=t[o].selection;if(!c.equalsSelection(d)){const n=c.plusRange(d),i=c.selectionStartLineNumber===c.startLineNumber&&c.selectionStartColumn===c.startColumn,r=d.selectionStartLineNumber===d.startLineNumber&&d.selectionStartColumn===d.startColumn;let a,m;u===this.lastAddedCursorIndex?(a=i,this.lastAddedCursorIndex=h):a=r,m=a?new l.Y(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn):new l.Y(n.endLineNumber,n.endColumn,n.startLineNumber,n.startColumn),t[o].selection=m;const g=s.Vi.fromModelSelection(m);e[h].setState(this.context,g.modelState,g.viewState)}for(const e of t)e.index>u&&e.index--;e.splice(u,1),t.splice(a,1),this._removeSecondaryCursor(u-1),n--}}}}var c=n(31380),d=n(28536),m=n(83256),g=n(33805),f=n(9917),p=n(69903);class C{constructor(e,t){this.modelVersionId=e.getVersionId(),this.cursorState=t.getCursorStates()}equals(e){if(!e)return!1;if(this.modelVersionId!==e.modelVersionId)return!1;if(this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class b{constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}static getAllAutoClosedCharacters(e){let t=[];for(const n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let e=0;e<this._autoClosedEnclosingDecorations.length;e++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[e]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(a.e.compareRangesUsingStarts),e.sort(a.e.compareRangesUsingStarts);for(let n=0;n<e.length;n++){if(n>=t.length)return!1;if(!t[n].strictContainsRange(e[n]))return!1}return!0}}class L extends f.JT{constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new s.zp(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new h(this.context),this._hasFocus=!1,this._isHandling=!1,this._isDoingComposition=!1,this._selectionsWhenCompositionStarted=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=(0,f.B9)(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new s.zp(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1;null!==i&&i.length>L.MAX_CURSOR_COUNT&&(i=i.slice(0,L.MAX_CURSOR_COUNT),r=!0);const s=new C(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,s,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,n,i){const r=this._cursors.getViewPositions();if(r.length>1)this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),0,n,i);else{const s=r[0],o=new a.e(s.lineNumber,s.column,s.lineNumber,s.column);this._emitCursorRevealRange(e,t,o,null,0,n,i)}}_revealPrimaryCursor(e,t,n,i,r){const s=this._cursors.getViewPositions();if(s.length>1)this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),n,i,r);else{const o=s[0],l=new a.e(o.lineNumber,o.column,o.lineNumber,o.column);this._emitCursorRevealRange(e,t,l,null,n,i,r)}}_emitCursorRevealRange(e,t,n,i,r,s,o){e.emitViewEvent(new g.Qb(t,n,i,r,s,o))}saveState(){let e=[];const t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push({inSelectionMode:!i.isEmpty(),selectionStart:{lineNumber:i.selectionStartLineNumber,column:i.selectionStartColumn},position:{lineNumber:i.positionLineNumber,column:i.positionColumn}})}return e}restoreState(e,t){let n=[];for(let e=0,i=t.length;e<i;e++){const i=t[e];let r=1,s=1;i.position&&i.position.lineNumber&&(r=i.position.lineNumber),i.position&&i.position.column&&(s=i.position.column);let o=r,a=s;i.selectionStart&&i.selectionStart.lineNumber&&(o=i.selectionStart.lineNumber),i.selectionStart&&i.selectionStart.column&&(a=i.selectionStart.column),n.push({selectionStartLineNumber:o,selectionStartColumn:a,positionLineNumber:r,positionColumn:s})}this.setStates(e,"restoreState",0,s.Vi.fromModelSelections(n)),this.revealPrimary(e,"restoreState",!0,1)}onModelContentChanged(e,t){if(t instanceof m.D8){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{if(this._knownModelVersionId=t.versionId,this._isHandling)return;const n=t.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new h(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&t.resultingSelection&&t.resultingSelection.length>0){const n=s.Vi.fromModelSelections(t.resultingSelection);this.setStates(e,"modelChange",t.isUndoing?5:t.isRedoing?6:2,n)&&this._revealPrimaryCursor(e,"modelChange",0,!0,0)}else{const t=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,s.Vi.fromModelSelections(t))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:s.io.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:s.io.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,n,i){this.setStates(e,t,i,s.Vi.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let r=0,s=e.length;r<s;r++)n.push({range:e[r],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[r],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new b(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=class{static executeCommands(e,t,n){const i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let e=0,t=i.trackedRanges.length;e<t;e++)i.model._setTrackedRange(i.trackedRanges[e],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const n=this._getEditOperations(e,t);if(0===n.operations.length)return null;const i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return null;let s=[];for(let e=0,t=i.length;e<t;e++)r.hasOwnProperty(i[e].identifier.major.toString())||s.push(i[e]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let o=e.model.pushEditOperations(e.selectionsBefore,s,n=>{let i=[];for(let t=0;t<e.selectionsBefore.length;t++)i[t]=[];for(const e of n)e.identifier&&i[e.identifier.major].push(e);const r=(e,t)=>e.identifier.minor-t.identifier.minor;let s=[];for(let n=0;n<e.selectionsBefore.length;n++)i[n].length>0?(i[n].sort(r),s[n]=t[n].computeCursorState(e.model,{getInverseEditOperations:()=>i[n],getTrackedSelection:t=>{const n=parseInt(t,10),i=e.model._getTrackedRange(e.trackedRanges[n]);return 0===e.trackedRangesDirection[n]?new l.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):new l.Y(i.endLineNumber,i.endColumn,i.startLineNumber,i.startColumn)}})):s[n]=e.selectionsBefore[n];return s});o||(o=e.selectionsBefore);let a=[];for(let e in r)r.hasOwnProperty(e)&&a.push(parseInt(e,10));a.sort((e,t)=>t-e);for(const e of a)o.splice(e,1);return o}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){const s=t[r];if(s){const t=this._getEditOperationsFromCommand(e,r,s);n=n.concat(t.operations),i=i||t.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let r=[],s=0;const o=(e,i,o=!1)=>{a.e.isEmpty(e)&&""===i||r.push({identifier:{major:t,minor:s++},range:e,text:i,forceMoveMarkers:o,isAutoWhitespaceEdit:n.insertsAutoWhitespace})};let u=!1;const h={addEditOperation:o,addTrackedEditOperation:(e,t,n)=>{u=!0,o(e,t,n)},trackSelection:(t,n)=>{const i=l.Y.liftSelection(t);let r;if(i.isEmpty())if("boolean"==typeof n)r=n?2:3;else{const t=e.model.getLineMaxColumn(i.startLineNumber);r=i.startColumn===t?2:3}else r=1;const s=e.trackedRanges.length,o=e.model._setTrackedRange(null,i,r);return e.trackedRanges[s]=o,e.trackedRangesDirection[s]=i.getDirection(),s.toString()}};try{n.getEditOperations(e.model,h)}catch(e){return(0,i.dL)(e),{operations:[],hadTrackedEditOperation:!1}}return{operations:r,hadTrackedEditOperation:u}}static _getLoserCursorMap(e){(e=e.slice(0)).sort((e,t)=>-a.e.compareRangesUsingEnds(e.range,t.range));let t={};for(let n=1;n<e.length;n++){const i=e[n-1],r=e[n];if(a.e.getStartPosition(i.range).isBefore(a.e.getEndPosition(r.range))){let s;s=i.identifier.major>r.identifier.major?i.identifier.major:r.identifier.major,t[s.toString()]=!0;for(let t=0;t<e.length;t++)e[t].identifier.major===s&&(e.splice(t,1),t<n&&n--,t--);n>0&&n--}}return t}}.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let t=0;t<e.commands.length;t++){const r=e.commands[t];r instanceof d.g&&r.enclosingRange&&r.closeCharacterRange&&(n.push(r.closeCharacterRange),i.push(r.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){e&&0!==e.length||(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){const s=new C(this._model,this);if(s.equals(i))return!1;const o=this._cursors.getSelections(),a=this._cursors.getViewSelections();if(e.emitViewEvent(new g.e$(a,o)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((e,t)=>!e.modelState.equals(i.cursorState[t].modelState))){const a=i?i.cursorState.map(e=>e.modelState.selection):null,l=i?i.modelVersionId:0;e.emitOutgoingEvent(new p.H6(a,o,l,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!i.text||i.text.indexOf("\n")>=0)return null;const r=i.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const s=r[1],o=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(s);if(!o||1!==o.length)return null;const a=o[0].open,l=i.text.length-r[2].length-1,u=i.text.lastIndexOf(a,l-1);if(-1===u)return null;t.push([u,l])}return t}executeEdits(e,t,n,i){let r=null;"snippet"===t&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],o=[];const l=this._model.pushEditOperations(this.getSelections(),n,e=>{if(r)for(let t=0,n=r.length;t<n;t++){const[n,i]=r[t],l=e[t],u=l.range.startLineNumber,h=l.range.startColumn-1+n,c=l.range.startColumn-1+i;s.push(new a.e(u,c+1,u,c+2)),o.push(new a.e(u,h+1,u,c+2))}const t=i(e);return t&&(this._isHandling=!0),t});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,o)}_executeEdit(e,t,n,r=0){if(this.context.cursorConfig.readOnly)return;const s=new C(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(e){(0,i.dL)(e)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,r,s,!1)&&this._revealPrimaryCursor(t,n,0,!0,0)}setIsDoingComposition(e){this._isDoingComposition=e}getAutoClosedCharacters(){return b.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._selectionsWhenCompositionStarted=this.getSelections().slice(0)}endComposition(e,t){this._executeEdit(()=>{"keyboard"===t&&(this._executeEditOperation(d.u.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this._selectionsWhenCompositionStarted,this.getSelections(),this.getAutoClosedCharacters())),this._selectionsWhenCompositionStarted=null)},e,t)}type(e,t,n){this._executeEdit(()=>{if("keyboard"===n){const e=t.length;let n=0;for(;n<e;){const e=r.vH(t,n),i=t.substr(n,e);this._executeEditOperation(d.u.typeWithInterceptors(this._isDoingComposition,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),i)),n+=e}}else this._executeEditOperation(d.u.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(0!==t.length||0!==n||0!==i)this._executeEdit(()=>{this._executeEditOperation(d.u.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s);else if(0!==r){const t=this.getSelections().map(e=>{const t=e.getPosition();return new l.Y(t.lineNumber,t.column+r,t.lineNumber,t.column+r)});this.setSelections(e,s,t,0)}}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(d.u.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(c.A.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new s.Tp(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new s.Tp(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}}L.MAX_CURSOR_COUNT=1e4},3675:(e,t,n)=>{n.d(t,{l:()=>r});var i=n(33181);class r{static whitespaceVisibleColumn(e,t,n){const r=e.length;let s=0,o=-1,a=-1;for(let l=0;l<r;l++){if(l===t)return[o,a,s];s%n==0&&(o=l,a=s);switch(e.charCodeAt(l)){case 32:s+=1;break;case 9:s=i.io.nextRenderTabStop(s,n);break;default:return[-1,-1,-1]}}return t===r?[o,a,s]:[-1,-1,-1]}static atomicPosition(e,t,n,s){const o=e.length,[a,l,u]=r.whitespaceVisibleColumn(e,t,n);if(-1===u)return-1;let h;switch(s){case 0:h=!0;break;case 1:h=!1;break;case 2:if(u%n==0)return t;h=u%n<=n/2}if(h){if(-1===a)return-1;let t=l;for(let r=a;r<o;++r){if(t===l+n)return a;switch(e.charCodeAt(r)){case 32:t+=1;break;case 9:t=i.io.nextRenderTabStop(t,n);break;default:return-1}}return t===l+n?a:-1}const c=i.io.nextRenderTabStop(u,n);let d=u;for(let r=t;r<o;r++){if(d===c)return r;switch(e.charCodeAt(r)){case 32:d+=1;break;case 9:d=i.io.nextRenderTabStop(d,n);break;default:return-1}}return d===c?o:-1}}},72792:(e,t,n)=>{n.d(t,{U:()=>o});var i=n(33181),r=n(50187),s=n(24314);class o{static columnSelect(e,t,n,o,a,l){let u=Math.abs(a-n)+1,h=n>a,c=o>l,d=o<l,m=[];for(let a=0;a<u;a++){let u=n+(h?-a:a),g=i.io.columnFromVisibleColumn2(e,t,u,o),f=i.io.columnFromVisibleColumn2(e,t,u,l),p=i.io.visibleColumnFromColumn2(e,t,new r.L(u,g)),C=i.io.visibleColumnFromColumn2(e,t,new r.L(u,f));if(d){if(p>l)continue;if(C<o)continue}if(c){if(C>o)continue;if(p<l)continue}m.push(new i.rS(new s.e(u,g,u,g),0,new r.L(u,f),0))}if(0===m.length)for(let e=0;e<u;e++){const o=n+(h?-e:e),a=t.getLineMaxColumn(o);m.push(new i.rS(new s.e(o,a,o,a),0,new r.L(o,a),0))}return{viewStates:m,reversed:h,fromLineNumber:n,fromVisualColumn:o,toLineNumber:a,toVisualColumn:l}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let s=0;const o=Math.min(n.fromViewLineNumber,n.toViewLineNumber),a=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let n=o;n<=a;n++){const o=t.getLineMaxColumn(n),a=i.io.visibleColumnFromColumn2(e,t,new r.L(n,o));s=Math.max(s,a)}let l=n.toViewVisualColumn;return l<s&&l++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,l)}static columnSelectUp(e,t,n,i){const r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){const r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}}},47707:(e,t,n)=>{n.d(t,{i:()=>r});var i=n(97295);class r{static visibleColumnFromColumn(e,t,n){const s=e.length,o=t-1<s?t-1:s;let a=0,l=0;for(;l<o;){const t=i.ZH(e,o,l);if(l+=t>=65536?2:1,9===t)a=r.nextRenderTabStop(a,n);else{let n=i.S6(t);for(;l<o;){const t=i.ZH(e,o,l),r=i.S6(t);if(i.fi(n,r))break;l+=t>=65536?2:1,n=r}i.K7(t)||i.C8(t)?a+=2:a+=1}}return a}static visibleColumnFromColumn2(e,t,n){return this.visibleColumnFromColumn(t.getLineContent(n.lineNumber),n.column,e.tabSize)}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;const s=e.length;let o=0,a=1,l=0;for(;l<s;){const u=i.ZH(e,s,l);let h;if(l+=u>=65536?2:1,9===u)h=r.nextRenderTabStop(o,n);else{let t=i.S6(u);for(;l<s;){const n=i.ZH(e,s,l),r=i.S6(n);if(i.fi(t,r))break;l+=n>=65536?2:1,t=r}h=i.K7(u)||i.C8(u)?o+2:o+1}const c=l+1;if(h>=t){return h-t<t-o?c:a}o=h,a=c}return s+1}static columnFromVisibleColumn2(e,t,n,i){let r=this.columnFromVisibleColumn(t.getLineContent(n),i,e.tabSize),s=t.getLineMinColumn(n);if(r<s)return s;let o=t.getLineMaxColumn(n);return r>o?o:r}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}},33181:(e,t,n)=>{n.d(t,{LM:()=>m,LN:()=>S,Tp:()=>L,Vi:()=>b,io:()=>u.i,rS:()=>g,zp:()=>f});var i=n(17301),r=n(50187),s=n(24314),o=n(3860),a=n(75425),l=n(83831),u=n(47707);const h=()=>!0,c=()=>!1,d=e=>" "===e||"\t"===e;class m{constructor(e,t,n){this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const i=n.options,r=i.get(130);this.readOnly=i.get(80),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=i.get(103),this.lineHeight=i.get(58),this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=i.get(115),this.wordSeparators=i.get(116),this.emptySelectionClipboard=i.get(32),this.copyWithSyntaxHighlighting=i.get(21),this.multiCursorMergeOverlapping=i.get(68),this.multiCursorPaste=i.get(70),this.autoClosingBrackets=i.get(5),this.autoClosingQuotes=i.get(8),this.autoClosingDelete=i.get(6),this.autoClosingOvertype=i.get(7),this.autoSurround=i.get(11),this.autoIndent=i.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:m._getShouldAutoClose(e,this.autoClosingQuotes),bracket:m._getShouldAutoClose(e,this.autoClosingBrackets)},this.autoClosingPairs=l.zu.getAutoClosingPairs(e);let s=m._getSurroundingPairs(e);if(s)for(const e of s)this.surroundingPairs[e.open]=e.close}static shouldRecreate(e){return e.hasChanged(130)||e.hasChanged(116)||e.hasChanged(32)||e.hasChanged(68)||e.hasChanged(70)||e.hasChanged(5)||e.hasChanged(8)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(115)||e.hasChanged(58)||e.hasChanged(80)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=m._getElectricCharacters(this._languageId);if(e)for(const t of e)this._electricChars[t]=!0}return this._electricChars}normalizeIndentation(e){return a.yO.normalizeIndentation(e,this.indentSize,this.insertSpaces)}static _getElectricCharacters(e){try{return l.zu.getElectricCharacters(e)}catch(e){return(0,i.dL)(e),null}}static _getShouldAutoClose(e,t){switch(t){case"beforeWhitespace":return d;case"languageDefined":return m._getLanguageDefinedShouldAutoClose(e);case"always":return h;case"never":return c}}static _getLanguageDefinedShouldAutoClose(e){try{const t=l.zu.getAutoCloseBeforeSet(e);return e=>-1!==t.indexOf(e)}catch(e){return(0,i.dL)(e),c}}static _getSurroundingPairs(e){try{return l.zu.getSurroundingPairs(e)}catch(e){return(0,i.dL)(e),null}}}class g{constructor(e,t,n,i){this._singleCursorStateBrand=void 0,this.selectionStart=e,this.selectionStartLeftoverVisibleColumns=t,this.position=n,this.leftoverVisibleColumns=i,this.selection=g._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new g(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new r.L(t,n),i):new g(new s.e(t,n,t,n),i,new r.L(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?o.Y.fromPositions(e.getStartPosition(),t):o.Y.fromPositions(e.getEndPosition(),t)}}class f{constructor(e,t,n,i){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}}class p{constructor(e){this.modelState=e,this.viewState=null}}class C{constructor(e){this.modelState=null,this.viewState=e}}class b{constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}static fromModelState(e){return new p(e)}static fromViewState(e){return new C(e)}static fromModelSelection(e){const t=o.Y.liftSelection(e),n=new g(s.e.fromPositions(t.getSelectionStart()),0,t.getPosition(),0);return b.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class L{constructor(e,t,n){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}}function S(e){return"'"===e||'"'===e||"`"===e}},31380:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(97295),r=n(61329),s=n(33181),o=n(88784),a=n(24314),l=n(50187);class u{static deleteRight(e,t,n,i){let s=[],l=3!==e;for(let e=0,u=i.length;e<u;e++){const u=i[e];let h=u;if(h.isEmpty()){let e=u.getPosition(),i=o.o.right(t,n,e);h=new a.e(i.lineNumber,i.column,e.lineNumber,e.column)}h.isEmpty()?s[e]=null:(h.startLineNumber!==h.endLineNumber&&(l=!0),s[e]=new r.T4(h,""))}return[l,s]}static isAutoClosingPairDelete(e,t,n,i,r,o,a){if("never"===t&&"never"===n)return!1;if("never"===e)return!1;for(let l=0,u=o.length;l<u;l++){const u=o[l],h=u.getPosition();if(!u.isEmpty())return!1;const c=r.getLineContent(h.lineNumber);if(h.column<2||h.column>=c.length+1)return!1;const d=c.charAt(h.column-2),m=i.get(d);if(!m)return!1;if((0,s.LN)(d)){if("never"===n)return!1}else if("never"===t)return!1;const g=c.charAt(h.column-1);let f=!1;for(const e of m)e.open===d&&e.close===g&&(f=!0);if(!f)return!1;if("auto"===e){let e=!1;for(let t=0,n=a.length;t<n;t++){const n=a[t];if(h.lineNumber===n.startLineNumber&&h.column===n.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let e=0,t=n.length;e<t;e++){const t=n[e].getPosition(),s=new a.e(t.lineNumber,t.column-1,t.lineNumber,t.column+1);i[e]=new r.T4(s,"")}return[!0,i]}static deleteLeft(e,t,n,i,s){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,s))return this._runAutoClosingPairDelete(t,n,i);const o=[];let a=2!==e;for(let e=0,s=i.length;e<s;e++){let s=u.getDeleteRange(i[e],n,t);s.isEmpty()?o[e]=null:(s.startLineNumber!==s.endLineNumber&&(a=!0),o[e]=new r.T4(s,""))}return[a,o]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;const r=e.getPosition();if(n.useTabStops&&r.column>1){const e=t.getLineContent(r.lineNumber),o=i.LC(e),l=-1===o?e.length+1:o+1;if(r.column<=l){const e=s.io.visibleColumnFromColumn2(n,t,r),i=s.io.prevIndentTabStop(e,n.indentSize),o=s.io.columnFromVisibleColumn2(n,t,r.lineNumber,i);return new a.e(r.lineNumber,o,r.lineNumber,r.column)}}return a.e.fromPositions(u.getPositionAfterDeleteLeft(r,t),r)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const n=i.oH(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}if(e.lineNumber>1){const n=e.lineNumber-1;return new l.L(n,t.getLineMaxColumn(n))}return e}static cut(e,t,n){let i=[],o=null;n.sort((e,t)=>l.L.compare(e.getStartPosition(),t.getEndPosition()));for(let s=0,l=n.length;s<l;s++){const l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let e,n,u,h,c=l.getPosition();c.lineNumber<t.getLineCount()?(e=c.lineNumber,n=1,u=c.lineNumber+1,h=1):c.lineNumber>1&&(null==o?void 0:o.endLineNumber)!==c.lineNumber?(e=c.lineNumber-1,n=t.getLineMaxColumn(c.lineNumber-1),u=c.lineNumber,h=t.getLineMaxColumn(c.lineNumber)):(e=c.lineNumber,n=1,u=c.lineNumber,h=t.getLineMaxColumn(c.lineNumber));let d=new a.e(e,n,u,h);o=d,d.isEmpty()?i[s]=null:i[s]=new r.T4(d,"")}else i[s]=null;else i[s]=new r.T4(l,"")}return new s.Tp(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}},83814:(e,t,n)=>{n.d(t,{N:()=>i,P:()=>h});var i,r=n(98401),s=n(33181),o=n(88784),a=n(5795),l=n(50187),u=n(24314);class h{static addCursorDown(e,t,n){let i=[],r=0;for(let a=0,l=t.length;a<l;a++){const l=t[a];i[r++]=new s.Vi(l.modelState,l.viewState),i[r++]=n?s.Vi.fromModelState(o.o.translateDown(e.cursorConfig,e.model,l.modelState)):s.Vi.fromViewState(o.o.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let a=0,l=t.length;a<l;a++){const l=t[a];i[r++]=new s.Vi(l.modelState,l.viewState),i[r++]=n?s.Vi.fromModelState(o.o.translateUp(e.cursorConfig,e.model,l.modelState)):s.Vi.fromViewState(o.o.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];i[r]=this._moveToLineStart(e,s,n)}return i}static _moveToLineStart(e,t,n){const i=t.viewState.position.column,r=i===t.modelState.position.column,s=t.viewState.position.lineNumber,o=e.getLineFirstNonWhitespaceColumn(s);return r||i===o?this._moveToLineStartByModel(e,t,n):this._moveToLineStartByView(e,t,n)}static _moveToLineStartByView(e,t,n){return s.Vi.fromViewState(o.o.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return s.Vi.fromModelState(o.o.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,o=t.length;s<o;s++){const o=t[s];r[s]=this._moveToLineEnd(e,o,n,i)}return r}static _moveToLineEnd(e,t,n,i){const r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),o=r.column===s,a=t.modelState.position,l=e.model.getLineMaxColumn(a.lineNumber),u=s-r.column==l-a.column;return o||u?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return s.Vi.fromViewState(o.o.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return s.Vi.fromModelState(o.o.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i],o=r.modelState.selection.startLineNumber,a=e.model.getLineCount();let h,c=r.modelState.selection.endLineNumber;c===a?h=e.model.getLineMaxColumn(a):(c++,h=1),n[i]=s.Vi.fromModelState(new s.rS(new u.e(o,1,o,1),0,new l.L(c,h),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,a=t.length;r<a;r++){const a=t[r];i[r]=s.Vi.fromModelState(o.o.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,a=t.length;r<a;r++){const a=t[r];i[r]=s.Vi.fromModelState(o.o.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){const n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return s.Vi.fromModelState(new s.rS(new u.e(1,1,1,1),0,new l.L(n,i),0))}static line(e,t,n,i,r){const o=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new l.L(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!n||!t.modelState.hasSelection()){const t=e.model.getLineCount();let n=o.lineNumber+1,i=1;return n>t&&(n=t,i=e.model.getLineMaxColumn(n)),s.Vi.fromModelState(new s.rS(new u.e(o.lineNumber,1,n,i),0,new l.L(n,i),0))}const h=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<h)return s.Vi.fromViewState(t.viewState.move(t.modelState.hasSelection(),a.lineNumber,1,0));if(o.lineNumber>h){const n=e.getLineCount();let i=a.lineNumber+1,r=1;return i>n&&(i=n,r=e.getLineMaxColumn(i)),s.Vi.fromViewState(t.viewState.move(t.modelState.hasSelection(),i,r,0))}{const e=t.modelState.selectionStart.getEndPosition();return s.Vi.fromModelState(t.modelState.move(t.modelState.hasSelection(),e.lineNumber,e.column,0))}}static word(e,t,n,i){const r=e.model.validatePosition(i);return s.Vi.fromModelState(a.w.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new s.Vi(t.modelState,t.viewState);const n=t.viewState.position.lineNumber,i=t.viewState.position.column;return s.Vi.fromViewState(new s.rS(new u.e(n,i,n,i),0,new l.L(n,i),0))}static moveTo(e,t,n,i,r){const o=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new l.L(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return s.Vi.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,a){switch(n){case 0:return 4===a?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case 1:return 4===a?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case 2:return 2===a?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case 3:return 2===a?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case 4:return 2===a?t.map(t=>s.Vi.fromViewState(o.o.moveToPrevBlankLine(e.cursorConfig,e,t.viewState,i))):t.map(t=>s.Vi.fromModelState(o.o.moveToPrevBlankLine(e.cursorConfig,e.model,t.modelState,i)));case 5:return 2===a?t.map(t=>s.Vi.fromViewState(o.o.moveToNextBlankLine(e.cursorConfig,e,t.viewState,i))):t.map(t=>s.Vi.fromModelState(o.o.moveToNextBlankLine(e.cursorConfig,e.model,t.modelState,i)));case 6:return this._moveToViewMinColumn(e,t,i);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case 8:return this._moveToViewCenterColumn(e,t,i);case 9:return this._moveToViewMaxColumn(e,t,i);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){const s=e.getCompletelyVisibleViewRange(),o=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case 11:{const n=this._firstLineNumberInRange(e.model,o,r),s=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,s)]}case 13:{const n=this._lastLineNumberInRange(e.model,o,r),s=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,s)]}case 12:{const n=Math.round((o.startLineNumber+o.endLineNumber)/2),r=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,r)]}case 14:{let n=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];n[r]=this.findPositionInViewportIfOutside(e,o,s,i)}return n}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new s.Vi(t.modelState,t.viewState);{let a;a=r>n.endLineNumber-1?n.endLineNumber-1:r<n.startLineNumber?n.startLineNumber:r;const l=o.o.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,a,!1);return s.Vi.fromViewState(t.viewState.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(t=>s.Vi.fromViewState(o.o.moveLeft(e.cursorConfig,e,t.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,a=t.length;r<a;r++){const a=t[r],l=a.viewState.position.lineNumber,u=Math.round(e.getLineContent(l).length/2);i[r]=s.Vi.fromViewState(o.o.moveLeft(e.cursorConfig,e,a.viewState,n,u))}return i}static _moveRight(e,t,n,i){return t.map(t=>s.Vi.fromViewState(o.o.moveRight(e.cursorConfig,e,t.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,a=t.length;r<a;r++){const a=t[r],l=a.viewState.position.lineNumber,u=Math.round(e.getLineContent(l).length/2);i[r]=s.Vi.fromViewState(o.o.moveRight(e.cursorConfig,e,a.viewState,n,u))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];r[a]=s.Vi.fromViewState(o.o.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];r[a]=s.Vi.fromModelState(o.o.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];r[a]=s.Vi.fromViewState(o.o.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let a=0,l=t.length;a<l;a++){const l=t[a];r[a]=s.Vi.fromModelState(o.o.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return s.Vi.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return s.Vi.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.viewState.position.lineNumber,a=e.getLineMinColumn(o);i[r]=this._moveToViewPosition(e,s,n,o,a)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.viewState.position.lineNumber,a=e.getLineFirstNonWhitespaceColumn(o);i[r]=this._moveToViewPosition(e,s,n,o,a)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.viewState.position.lineNumber,a=Math.round((e.getLineMaxColumn(o)+e.getLineMinColumn(o))/2);i[r]=this._moveToViewPosition(e,s,n,o,a)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.viewState.position.lineNumber,a=e.getLineMaxColumn(o);i[r]=this._moveToViewPosition(e,s,n,o,a)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.viewState.position.lineNumber,a=e.getLineLastNonWhitespaceColumn(o);i[r]=this._moveToViewPosition(e,s,n,o,a)}return i}}!function(e){e.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t",constraint:function(e){if(!r.Kn(e))return!1;let t=e;return!!r.HD(t.to)&&(!(!r.o8(t.select)&&!r.jn(t.select))&&(!(!r.o8(t.by)&&!r.HD(t.by))&&!(!r.o8(t.value)&&!r.hj(t.value))))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},e.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},e.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},e.parse=function(t){if(!t.to)return null;let n;switch(t.to){case e.RawDirection.Left:n=0;break;case e.RawDirection.Right:n=1;break;case e.RawDirection.Up:n=2;break;case e.RawDirection.Down:n=3;break;case e.RawDirection.PrevBlankLine:n=4;break;case e.RawDirection.NextBlankLine:n=5;break;case e.RawDirection.WrappedLineStart:n=6;break;case e.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case e.RawDirection.WrappedLineColumnCenter:n=8;break;case e.RawDirection.WrappedLineEnd:n=9;break;case e.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case e.RawDirection.ViewPortTop:n=11;break;case e.RawDirection.ViewPortBottom:n=13;break;case e.RawDirection.ViewPortCenter:n=12;break;case e.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let i=0;switch(t.by){case e.RawUnit.Line:i=1;break;case e.RawUnit.WrappedLine:i=2;break;case e.RawUnit.Character:i=3;break;case e.RawUnit.HalfLine:i=4}return{direction:n,unit:i,select:!!t.select,value:t.value||1}}}(i||(i={}))},88784:(e,t,n)=>{n.d(t,{o:()=>u});var i=n(33181),r=n(50187),s=n(24314),o=n(97295),a=n(3675);class l{constructor(e,t,n){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}}class u{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-o.HO(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const n=t.lineNumber-1;return new r.L(n,e.getLineMaxColumn(n))}return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const i=e.getLineMinColumn(t.lineNumber),s=e.getLineContent(t.lineNumber),o=a.l.atomicPosition(s,t.column-1,n,0);if(-1!==o&&o+1>=i)return new r.L(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,n){const i=e.stickyTabStops?u.leftPositionAtomicSoftTabs(t,n,e.tabSize):u.leftPosition(t,n);return new l(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,o;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,o=n.selection.startColumn;else{const i=n.position.delta(void 0,-(r-1)),a=t.normalizePosition(u.clipPositionColumn(i,t),0),l=u.left(e,t,a);s=l.lineNumber,o=l.column}return n.move(i,s,o,0)}static clipPositionColumn(e,t){return new r.L(e.lineNumber,u.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n+=o.vH(e.getLineContent(t),n-1):t<e.getLineCount()&&(t+=1,n=e.getLineMinColumn(t)),new r.L(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,s){if(n<e.getLineIndentColumn(t)){const s=e.getLineContent(t),o=a.l.atomicPosition(s,n-1,i,1);if(-1!==o)return new r.L(t,o+1)}return this.rightPosition(e,t,n)}static right(e,t,n){const i=e.stickyTabStops?u.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):u.rightPosition(t,n.lineNumber,n.column);return new l(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,o;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,o=n.selection.endColumn;else{const i=n.position.delta(void 0,r-1),a=t.normalizePosition(u.clipPositionColumn(i,t),1),l=u.right(e,t,a);s=l.lineNumber,o=l.column}return n.move(i,s,o,0)}static vertical(e,t,n,r,s,o,a){const u=i.io.visibleColumnFromColumn(t.getLineContent(n),r,e.tabSize)+s,h=t.getLineCount(),c=1===n&&1===r,d=n===h&&r===t.getLineMaxColumn(n),m=o<n?c:d;return(n=o)<1?(n=1,r=a?t.getLineMinColumn(n):Math.min(t.getLineMaxColumn(n),r)):n>h?(n=h,r=a?t.getLineMaxColumn(n):Math.min(t.getLineMaxColumn(n),r)):r=i.io.columnFromVisibleColumn2(e,t,n,u),s=m?0:u-i.io.visibleColumnFromColumn(t.getLineContent(n),r,e.tabSize),new l(n,r,s)}static down(e,t,n,i,r,s,o){return this.vertical(e,t,n,i,r,n+s,o)}static moveDown(e,t,n,i,r){let s,o;n.hasSelection()&&!i?(s=n.selection.endLineNumber,o=n.selection.endColumn):(s=n.position.lineNumber,o=n.position.column);let a=u.down(e,t,s,o,n.leftoverVisibleColumns,r,!0);return n.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateDown(e,t,n){let o=n.selection,a=u.down(e,t,o.selectionStartLineNumber,o.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),l=u.down(e,t,o.positionLineNumber,o.positionColumn,n.leftoverVisibleColumns,1,!1);return new i.rS(new s.e(a.lineNumber,a.column,a.lineNumber,a.column),a.leftoverVisibleColumns,new r.L(l.lineNumber,l.column),l.leftoverVisibleColumns)}static up(e,t,n,i,r,s,o){return this.vertical(e,t,n,i,r,n-s,o)}static moveUp(e,t,n,i,r){let s,o;n.hasSelection()&&!i?(s=n.selection.startLineNumber,o=n.selection.startColumn):(s=n.position.lineNumber,o=n.position.column);let a=u.up(e,t,s,o,n.leftoverVisibleColumns,r,!0);return n.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateUp(e,t,n){let o=n.selection,a=u.up(e,t,o.selectionStartLineNumber,o.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),l=u.up(e,t,o.positionLineNumber,o.positionColumn,n.leftoverVisibleColumns,1,!1);return new i.rS(new s.e(a.lineNumber,a.column,a.lineNumber,a.column),a.leftoverVisibleColumns,new r.L(l.lineNumber,l.column),l.leftoverVisibleColumns)}static _isBlankLine(e,t){return 0===e.getLineFirstNonWhitespaceColumn(t)}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){const r=t.getLineCount();let s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r,s=n.position.lineNumber,o=t.getLineMinColumn(s),a=t.getLineFirstNonWhitespaceColumn(s)||o;return r=n.position.column===a?o:a,n.move(i,s,r,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,o=t.getLineMaxColumn(s);return n.move(i,s,o,r?1073741824-o:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}}},28536:(e,t,n)=>{n.d(t,{g:()=>C,u:()=>p});var i=n(17301),r=n(97295),s=n(61329),o=n(10291),a=n(69317),l=n(33181),u=n(59410),h=n(24314),c=n(3860),d=n(50187),m=n(97354),g=n(83831),f=n(40764);class p{static indent(e,t,n){if(null===t||null===n)return[];let i=[];for(let t=0,r=n.length;t<r;t++)i[t]=new o.U(n[t],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return i}static outdent(e,t,n){let i=[];for(let t=0,r=n.length;t<r;t++)i[t]=new o.U(n[t],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return i}static shiftIndent(e,t,n){return n=n||1,o.U.shiftIndent(t,t.length+n,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,n){return n=n||1,o.U.unshiftIndent(t,t.length+n,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,n,i){let r=[];for(let e=0,t=n.length;e<t;e++)r[e]=new s.T4(n[e],i[e]);return new l.Tp(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let o=[];for(let e=0,t=n.length;e<t;e++){const t=n[e];let a=t.getPosition();if(r&&!t.isEmpty()&&(r=!1),r&&i.indexOf("\n")!==i.length-1&&(r=!1),r){let n=new h.e(a.lineNumber,1,a.lineNumber,1);o[e]=new s.hP(n,i,t,!0)}else o[e]=new s.T4(t,i)}return new l.Tp(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,n,i,s){if(i)return null;if(1===t.length)return null;if(s&&s.length===t.length)return s;if("spread"===e.multiCursorPaste){10===n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1)),13===n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1));let e=r.uq(n);if(e.length===t.length)return e}return null}static paste(e,t,n,i,r,s){const o=this._distributePasteToCursors(e,n,i,r,s);return o?(n=n.sort(h.e.compareRangesUsingStarts),this._distributedPaste(e,t,n,o)):this._simplePaste(e,t,n,i,r)}static _goodIndentForLine(e,t,n){let i=null,s="";const o=g.zu.getInheritIndentForLine(e.autoIndent,t,n,!1);if(o)i=o.action,s=o.indentation;else if(n>1){let i;for(i=n-1;i>=1;i--){const e=t.getLineContent(i);if(r.ow(e)>=0)break}if(i<1)return null;const o=t.getLineMaxColumn(i),a=g.zu.getEnterAction(e.autoIndent,t,new h.e(i,o,i,o));a&&(s=a.indentation+a.appendText)}return i&&(i===m.wU.Indent&&(s=p.shiftIndent(e,s)),i===m.wU.Outdent&&(s=p.unshiftIndent(e,s)),s=e.normalizeIndentation(s)),s||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",o=n.getStartPosition();if(e.insertSpaces){let n=l.io.visibleColumnFromColumn2(e,t,o),i=e.indentSize,s=i-n%i;for(let e=0;e<s;e++)r+=" "}else r="\t";return new s.T4(n,r,i)}static tab(e,t,n){let i=[];for(let r=0,a=n.length;r<a;r++){const a=n[r];if(a.isEmpty()){let n=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(n)&&t.isCheapToTokenize(a.startLineNumber)){let o=this._goodIndentForLine(e,t,a.startLineNumber);o=o||"\t";let l=e.normalizeIndentation(o);if(!n.startsWith(l)){i[r]=new s.T4(new h.e(a.startLineNumber,1,a.startLineNumber,n.length+1),l,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let n=t.getLineMaxColumn(a.startLineNumber);if(1!==a.startColumn||a.endColumn!==n){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new o.U(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent})}}return i}static compositionType(e,t,n,i,r,s,o,a){const u=i.map(e=>this._compositionType(n,e,r,s,o,a));return new l.Tp(4,u,{shouldPushStackElementBefore:L(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-i),u=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new h.e(a.lineNumber,l,a.lineNumber,u);return e.getValueInRange(c)===n&&0===o?null:new s.Uo(c,n,0,o)}static _typeCommand(e,t,n){return n?new s.Sj(e,t,!0):new s.T4(e,t,!0)}static _enter(e,t,n,i){if(0===e.autoIndent)return p._typeCommand(i,"\n",n);if(!t.isCheapToTokenize(i.getStartPosition().lineNumber)||1===e.autoIndent){let s=t.getLineContent(i.startLineNumber),o=r.V8(s).substring(0,i.startColumn-1);return p._typeCommand(i,"\n"+e.normalizeIndentation(o),n)}const o=g.zu.getEnterAction(e.autoIndent,t,i);if(o){if(o.indentAction===m.wU.None)return p._typeCommand(i,"\n"+e.normalizeIndentation(o.indentation+o.appendText),n);if(o.indentAction===m.wU.Indent)return p._typeCommand(i,"\n"+e.normalizeIndentation(o.indentation+o.appendText),n);if(o.indentAction===m.wU.IndentOutdent){const t=e.normalizeIndentation(o.indentation),r=e.normalizeIndentation(o.indentation+o.appendText),a="\n"+r+"\n"+t;return n?new s.Sj(i,a,!0):new s.Uo(i,a,-1,r.length-t.length,!0)}if(o.indentAction===m.wU.Outdent){const t=p.unshiftIndent(e,o.indentation);return p._typeCommand(i,"\n"+e.normalizeIndentation(t+o.appendText),n)}}const a=t.getLineContent(i.startLineNumber),u=r.V8(a).substring(0,i.startColumn-1);if(e.autoIndent>=4){const o=g.zu.getIndentForEnter(e.autoIndent,t,i,{unshiftIndent:t=>p.unshiftIndent(e,t),shiftIndent:t=>p.shiftIndent(e,t),normalizeIndentation:t=>e.normalizeIndentation(t)});if(o){let a=l.io.visibleColumnFromColumn2(e,t,i.getEndPosition());const u=i.endColumn,h=t.getLineContent(i.endLineNumber),c=r.LC(h);if(i=c>=0?i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,c+1)):i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new s.Sj(i,"\n"+e.normalizeIndentation(o.afterEnter),!0);{let t=0;return u<=c+1&&(e.insertSpaces||(a=Math.ceil(a/e.indentSize)),t=Math.min(a+1-e.normalizeIndentation(o.afterEnter).length-1,0)),new s.Uo(i,"\n"+e.normalizeIndentation(o.afterEnter),0,t,!0)}}}return p._typeCommand(i,"\n"+e.normalizeIndentation(u),n)}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let e=0,i=n.length;e<i;e++)if(!t.isCheapToTokenize(n[e].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,n,i){const r=g.zu.getIndentationAtPosition(t,n.startLineNumber,n.startColumn),s=g.zu.getIndentActionForType(e.autoIndent,t,n,i,{shiftIndent:t=>p.shiftIndent(e,t),unshiftIndent:t=>p.unshiftIndent(e,t)});if(null===s)return null;if(s!==e.normalizeIndentation(r)){const r=t.getLineFirstNonWhitespaceColumn(n.startLineNumber);return 0===r?p._typeCommand(new h.e(n.startLineNumber,1,n.endLineNumber,n.endColumn),e.normalizeIndentation(s)+i,!1):p._typeCommand(new h.e(n.startLineNumber,1,n.endLineNumber,n.endColumn),e.normalizeIndentation(s)+t.getLineContent(n.startLineNumber).substring(r-1,n.startColumn-1)+i,!1)}return null}static _isAutoClosingOvertype(e,t,n,i,r){if("never"===e.autoClosingOvertype)return!1;if(!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(r))return!1;for(let s=0,o=n.length;s<o;s++){const o=n[s];if(!o.isEmpty())return!1;const a=o.getPosition(),u=t.getLineContent(a.lineNumber);if(u.charAt(a.column-1)!==r)return!1;const h=(0,l.LN)(r);if(92===(a.column>2?u.charCodeAt(a.column-2):0)&&h)return!1;if("auto"===e.autoClosingOvertype){let e=!1;for(let t=0,n=i.length;t<n;t++){const n=i[t];if(a.lineNumber===n.startLineNumber&&a.column===n.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingOvertype(e,t,n,i,r){let o=[];for(let e=0,t=i.length;e<t;e++){const t=i[e].getPosition(),n=new h.e(t.lineNumber,t.column,t.lineNumber,t.column+1);o[e]=new s.T4(n,r)}return new l.Tp(4,o,{shouldPushStackElementBefore:L(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(e=>t.startsWith(e.open)),o=r.some(e=>t.startsWith(e.close));return!s&&o}static _findAutoClosingPairOpen(e,t,n,i){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(const e of r)if(null===s||e.open.length>s.open.length){let r=!0;for(const s of n){if(t.getValueInRange(new h.e(s.lineNumber,s.column-e.open.length+1,s.lineNumber,s.column))+i!==e.open){r=!1;break}}r&&(s=e)}return s}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[];let r=null;for(const e of i)e.open!==t.open&&t.open.includes(e.open)&&t.close.endsWith(e.close)&&(!r||e.open.length>r.open.length)&&(r=e);return r}static _getAutoClosingPairClose(e,t,n,i,r){const s=(0,l.LN)(i),o=s?e.autoClosingQuotes:e.autoClosingBrackets,a=s?e.shouldAutoCloseBefore.quote:e.shouldAutoCloseBefore.bracket;if("never"===o)return null;for(const e of n)if(!e.isEmpty())return null;const h=n.map(e=>{const t=e.getPosition();return r?{lineNumber:t.lineNumber,beforeColumn:t.column-i.length,afterColumn:t.column}:{lineNumber:t.lineNumber,beforeColumn:t.column,afterColumn:t.column}}),c=this._findAutoClosingPairOpen(e,t,h.map(e=>new d.L(e.lineNumber,e.beforeColumn)),i);if(!c)return null;const m=this._findContainedAutoClosingPair(e,c),g=m?m.close:"";let C=!0;for(const n of h){const{lineNumber:r,beforeColumn:s,afterColumn:l}=n,h=t.getLineContent(r),d=h.substring(0,s-1),m=h.substring(l-1);if(m.startsWith(g)||(C=!1),m.length>0){const t=m.charAt(0);if(!p._isBeforeClosingBrace(e,m)&&!a(t))return null}if(1===c.open.length&&("'"===i||'"'===i)&&"always"!==o){const t=(0,u.u)(e.wordSeparators);if(d.length>0){const e=d.charCodeAt(d.length-1);if(0===t.get(e))return null}}if(!t.isCheapToTokenize(r))return null;t.forceTokenization(r);const b=t.getLineTokens(r),L=(0,f.wH)(b,s-1);if(!c.shouldAutoClose(L,s-L.firstCharOffset))return null;const S=c.findNeutralCharacter();if(S){const e=t.getTokenTypeIfInsertingCharacter(r,s,S);if(!c.isOK(e))return null}}return C?c.close.substring(0,c.close.length-g.length):c.close}static _runAutoClosingOpenCharType(e,t,n,i,r,s,o){let a=[];for(let e=0,t=i.length;e<t;e++){const t=i[e];a[e]=new C(t,r,!s,o)}return new l.Tp(4,a,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return(0,l.LN)(t)?"quotes"===e.autoSurround||"languageDefined"===e.autoSurround:"brackets"===e.autoSurround||"languageDefined"===e.autoSurround}static _isSurroundSelectionType(e,t,n,i){if(!p._shouldSurroundChar(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;const r=(0,l.LN)(i);for(let e=0,i=n.length;e<i;e++){const i=n[e];if(i.isEmpty())return!1;let s=!0;for(let e=i.startLineNumber;e<=i.endLineNumber;e++){const n=t.getLineContent(e),r=e===i.startLineNumber?i.startColumn-1:0,o=e===i.endLineNumber?i.endColumn-1:n.length,a=n.substring(r,o);if(/[^ \t]/.test(a)){s=!1;break}}if(s)return!1;if(r&&i.startLineNumber===i.endLineNumber&&i.startColumn+1===i.endColumn){const e=t.getValueInRange(i);if((0,l.LN)(e))return!1}}return!0}static _runSurroundSelectionType(e,t,n,i,r){let s=[];for(let e=0,n=i.length;e<n;e++){const n=i[e],o=t.surroundingPairs[r];s[e]=new a.F(n,r,o)}return new l.Tp(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,n){return!(1!==n.length||!t.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,o,a){if(!t.electricChars.hasOwnProperty(a)||!o.isEmpty())return null;let u=o.getPosition();n.forceTokenization(u.lineNumber);let c,d=n.getLineTokens(u.lineNumber);try{c=g.zu.onElectricCharacter(a,d,u.column)}catch(e){return(0,i.dL)(e),null}if(!c)return null;if(c.matchOpenBracket){let i=(d.getLineContent()+a).lastIndexOf(c.matchOpenBracket)+1,o=n.bracketPairs.findMatchingBracketUp(c.matchOpenBracket,{lineNumber:u.lineNumber,column:i});if(o){if(o.startLineNumber===u.lineNumber)return null;let i=n.getLineContent(o.startLineNumber),c=r.V8(i),d=t.normalizeIndentation(c),m=n.getLineContent(u.lineNumber),g=n.getLineFirstNonWhitespaceColumn(u.lineNumber)||u.column,f=d+m.substring(g-1,u.column-1)+a,p=new h.e(u.lineNumber,1,u.lineNumber,u.column);const C=new s.T4(p,f);return new l.Tp(b(f,e),[C],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,n,i,r,o){if(!i||c.Y.selectionsArrEqual(i,r))return null;let a=null;for(const e of r){if(!e.isEmpty())return null;const t=e.getPosition(),i=n.getValueInRange(new h.e(t.lineNumber,t.column-1,t.lineNumber,t.column));if(null===a)a=i;else if(a!==i)return null}if(!a)return null;if(this._isAutoClosingOvertype(t,n,r,o,a)){const e=r.map(e=>new s.T4(new h.e(e.positionLineNumber,e.positionColumn,e.positionLineNumber,e.positionColumn+1),"",!1));return new l.Tp(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const u=this._getAutoClosingPairClose(t,n,r,a,!0);return null!==u?this._runAutoClosingOpenCharType(e,t,n,r,a,!0,u):null}static typeWithInterceptors(e,t,n,i,r,o,a){if(!e&&"\n"===a){let e=[];for(let t=0,s=r.length;t<s;t++)e[t]=p._enter(n,i,!1,r[t]);return new l.Tp(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(n,i,r)){let e=[],t=!1;for(let s=0,o=r.length;s<o;s++)if(e[s]=this._runAutoIndentType(n,i,r[s],a),!e[s]){t=!0;break}if(!t)return new l.Tp(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoClosingOvertype(n,i,r,o,a))return this._runAutoClosingOvertype(t,n,i,r,a);if(!e){const e=this._getAutoClosingPairClose(n,i,r,a,!1);if(e)return this._runAutoClosingOpenCharType(t,n,i,r,a,!1,e)}if(this._isSurroundSelectionType(n,i,r,a))return this._runSurroundSelectionType(t,n,i,r,a);if(!e&&this._isTypeInterceptorElectricChar(n,i,r)){const e=this._typeInterceptorElectricChar(t,n,i,r[0],a);if(e)return e}let u=[];for(let e=0,t=r.length;e<t;e++)u[e]=new s.T4(r[e],a);const h=b(a,t);return new l.Tp(h,u,{shouldPushStackElementBefore:L(t,h),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,n,i,r){let o=[];for(let e=0,t=i.length;e<t;e++)o[e]=new s.T4(i[e],r);const a=b(r,e);return new l.Tp(a,o,{shouldPushStackElementBefore:L(e,a),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,n){if(null===t||null===n)return[];let i=[];for(let r=0,o=n.length;r<o;r++){let o=n[r].positionLineNumber;if(1===o)i[r]=new s.Sj(new h.e(1,1,1,1),"\n");else{o--;let n=t.getLineMaxColumn(o);i[r]=this._enter(e,t,!1,new h.e(o,n,o,n))}}return i}static lineInsertAfter(e,t,n){if(null===t||null===n)return[];let i=[];for(let r=0,s=n.length;r<s;r++){const s=n[r].positionLineNumber;let o=t.getLineMaxColumn(s);i[r]=this._enter(e,t,!1,new h.e(s,o,s,o))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}}class C extends s.Uo{constructor(e,t,n,i){super(e,(n?t:"")+i,0,-i.length),this._openCharacter=t,this._closeCharacter=i,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new h.e(n.startLineNumber,n.endColumn-this._closeCharacter.length,n.endLineNumber,n.endColumn),this.enclosingRange=new h.e(n.startLineNumber,n.endColumn-this._openCharacter.length-this._closeCharacter.length,n.endLineNumber,n.endColumn),super.computeCursorState(e,t)}}function b(e,t){return" "===e?5===t||6===t?6:5:4}function L(e,t){return!(!_(e)||_(t))||5!==e&&S(e)!==S(t)}function S(e){return 6===e||5===e?"space":e}function _(e){return 4===e||5===e||6===e}},5795:(e,t,n)=>{n.d(t,{L:()=>h,w:()=>u});var i=n(97295),r=n(33181),s=n(31380),o=n(59410),a=n(50187),l=n(24314);class u{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0;for(let r=n.column-2;r>=0;r--){let n=e.charCodeAt(r),s=t.get(n);if(0===s){if(2===i)return this._createWord(e,i,s,r+1,this._findEndOfWord(e,t,i,r+1));i=1}else if(2===s){if(1===i)return this._createWord(e,i,s,r+1,this._findEndOfWord(e,t,i,r+1));i=2}else if(1===s&&0!==i)return this._createWord(e,i,s,r+1,this._findEndOfWord(e,t,i,r+1))}return 0!==i?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=e.length;for(let s=i;s<r;s++){let i=e.charCodeAt(s),r=t.get(i);if(1===r)return s;if(1===n&&2===r)return s;if(2===n&&0===r)return s}return r}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length;for(let s=n.column-1;s<r;s++){let n=e.charCodeAt(s),r=t.get(n);if(0===r){if(2===i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,s-1),s);i=1}else if(2===r){if(1===i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,s-1),s);i=2}else if(1===r&&0!==i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,s-1),s)}return 0!==i?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){for(let r=i;r>=0;r--){let i=e.charCodeAt(r),s=t.get(i);if(1===s)return r+1;if(1===n&&2===s)return r+1;if(2===n&&0===s)return r+1}return 0}static moveWordLeft(e,t,n,i){let r=n.lineNumber,s=n.column;1===s&&r>1&&(r-=1,s=t.getLineMaxColumn(r));let o=u._findPreviousWordOnLine(e,t,new a.L(r,s));if(0===i)return new a.L(r,o?o.start+1:1);if(1===i)return o&&2===o.wordType&&o.end-o.start==1&&0===o.nextCharClass&&(o=u._findPreviousWordOnLine(e,t,new a.L(r,o.start+1))),new a.L(r,o?o.start+1:1);if(3===i){for(;o&&2===o.wordType;)o=u._findPreviousWordOnLine(e,t,new a.L(r,o.start+1));return new a.L(r,o?o.start+1:1)}return o&&s<=o.end+1&&(o=u._findPreviousWordOnLine(e,t,new a.L(r,o.start+1))),new a.L(r,o?o.end+1:1)}static _moveWordPartLeft(e,t){const n=t.lineNumber,r=e.getLineMaxColumn(n);if(1===t.column)return n>1?new a.L(n-1,e.getLineMaxColumn(n-1)):t;const s=e.getLineContent(n);for(let e=t.column-1;e>1;e--){const t=s.charCodeAt(e-2),o=s.charCodeAt(e-1);if(95===t&&95!==o)return new a.L(n,e);if(i.mK(t)&&i.df(o))return new a.L(n,e);if(i.df(t)&&i.df(o)&&e+1<r){const t=s.charCodeAt(e);if(i.mK(t))return new a.L(n,e)}}return new a.L(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,o=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(o=!0,r+=1,s=1);let l=u._findNextWordOnLine(e,t,new a.L(r,s));if(2===i)l&&2===l.wordType&&l.end-l.start==1&&0===l.nextCharClass&&(l=u._findNextWordOnLine(e,t,new a.L(r,l.end+1))),s=l?l.end+1:t.getLineMaxColumn(r);else if(3===i){for(o&&(s=0);l&&(2===l.wordType||l.start+1<=s);)l=u._findNextWordOnLine(e,t,new a.L(r,l.end+1));s=l?l.start+1:t.getLineMaxColumn(r)}else l&&!o&&s>=l.start+1&&(l=u._findNextWordOnLine(e,t,new a.L(r,l.end+1))),s=l?l.start+1:t.getLineMaxColumn(r);return new a.L(r,s)}static _moveWordPartRight(e,t){const n=t.lineNumber,r=e.getLineMaxColumn(n);if(t.column===r)return n<e.getLineCount()?new a.L(n+1,1):t;const s=e.getLineContent(n);for(let e=t.column+1;e<r;e++){const t=s.charCodeAt(e-2),o=s.charCodeAt(e-1);if(95!==t&&95===o)return new a.L(n,e);if(i.mK(t)&&i.df(o))return new a.L(n,e);if(i.df(t)&&i.df(o)&&e+1<r){const t=s.charCodeAt(e);if(i.mK(t))return new a.L(n,e)}}return new a.L(n,r)}static _deleteWordLeftWhitespace(e,t){const n=e.getLineContent(t.lineNumber),r=t.column-2,s=i.ow(n,r);return s+1<r?new l.e(t.lineNumber,s+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const n=e.wordSeparators,i=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(s.A.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const t=e.selection.getPosition();return new l.e(t.lineNumber,t.column-1,t.lineNumber,t.column+1)}const h=new a.L(r.positionLineNumber,r.positionColumn);let c=h.lineNumber,d=h.column;if(1===c&&1===d)return null;if(o){let e=this._deleteWordLeftWhitespace(i,h);if(e)return e}let m=u._findPreviousWordOnLine(n,i,h);return 0===t?m?d=m.start+1:d>1?d=1:(c--,d=i.getLineMaxColumn(c)):(m&&d<=m.end+1&&(m=u._findPreviousWordOnLine(n,i,new a.L(c,m.start+1))),m?d=m.end+1:d>1?d=1:(c--,d=i.getLineMaxColumn(c))),new l.e(c,d,h.lineNumber,h.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;const i=new a.L(n.positionLineNumber,n.positionColumn);let r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){const n=e.charCodeAt(t);return 32===n||9===n}static _deleteInsideWordWhitespace(e,t){const n=e.getLineContent(t.lineNumber),i=n.length;if(0===i)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new l.e(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){const i=t.getLineContent(n.lineNumber),r=i.length;if(0===r)return n.lineNumber>1?new l.e(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new l.e(n.lineNumber,1,n.lineNumber+1,1):new l.e(n.lineNumber,1,n.lineNumber,1);const s=e=>e.start+1<=n.column&&n.column<=e.end+1,o=(e,t)=>(e=Math.min(e,n.column),t=Math.max(t,n.column),new l.e(n.lineNumber,e,n.lineNumber,t)),a=e=>{let t=e.start+1,n=e.end+1,s=!1;for(;n-1<r&&this._charAtIsWhitespace(i,n-1);)s=!0,n++;if(!s)for(;t>1&&this._charAtIsWhitespace(i,t-2);)t--;return o(t,n)},h=u._findPreviousWordOnLine(e,t,n);if(h&&s(h))return a(h);const c=u._findNextWordOnLine(e,t,n);return c&&s(c)?a(c):h&&c?o(h.end+1,c.start+1):h?o(h.start+1,h.end+1):c?o(c.start+1,c.end+1):o(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const n=t.getPosition(),i=u._moveWordPartLeft(e,n);return new l.e(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let t=e.charAt(i);if(" "!==t&&"\t"!==t)return i}return n}static _deleteWordRightWhitespace(e,t){const n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new l.e(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;const o=new a.L(r.positionLineNumber,r.positionColumn);let h=o.lineNumber,c=o.column;const d=i.getLineCount(),m=i.getLineMaxColumn(h);if(h===d&&c===m)return null;if(s){let e=this._deleteWordRightWhitespace(i,o);if(e)return e}let g=u._findNextWordOnLine(n,i,o);return 2===t?g?c=g.end+1:c<m||h===d?c=m:(h++,g=u._findNextWordOnLine(n,i,new a.L(h,1)),c=g?g.start+1:i.getLineMaxColumn(h)):(g&&c>=g.start+1&&(g=u._findNextWordOnLine(n,i,new a.L(h,g.end+1))),g?c=g.start+1:c<m||h===d?c=m:(h++,g=u._findNextWordOnLine(n,i,new a.L(h,1)),c=g?g.start+1:i.getLineMaxColumn(h))),new l.e(h,c,o.lineNumber,o.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const n=t.getPosition(),i=u._moveWordPartRight(e,n);return new l.e(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){const i=new l.e(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n){const i=(0,o.u)(t),r=u._findPreviousWordOnLine(i,e,n);if(r&&1===r.wordType&&r.start<=n.column-1&&n.column-1<=r.end)return u._createWordAtPosition(e,n.lineNumber,r);const s=u._findNextWordOnLine(i,e,n);return s&&1===s.wordType&&s.start<=n.column-1&&n.column-1<=s.end?u._createWordAtPosition(e,n.lineNumber,s):null}static word(e,t,n,i,s){const h=(0,o.u)(e.wordSeparators);let c,d,m=u._findPreviousWordOnLine(h,t,s),g=u._findNextWordOnLine(h,t,s);if(!i){let e,n;return m&&1===m.wordType&&m.start<=s.column-1&&s.column-1<=m.end?(e=m.start+1,n=m.end+1):g&&1===g.wordType&&g.start<=s.column-1&&s.column-1<=g.end?(e=g.start+1,n=g.end+1):(e=m?m.end+1:1,n=g?g.start+1:t.getLineMaxColumn(s.lineNumber)),new r.rS(new l.e(s.lineNumber,e,s.lineNumber,n),0,new a.L(s.lineNumber,n),0)}m&&1===m.wordType&&m.start<s.column-1&&s.column-1<m.end?(c=m.start+1,d=m.end+1):g&&1===g.wordType&&g.start<s.column-1&&s.column-1<g.end?(c=g.start+1,d=g.end+1):(c=s.column,d=s.column);let f,p=s.lineNumber;if(n.selectionStart.containsPosition(s))f=n.selectionStart.endColumn;else if(s.isBeforeOrEqual(n.selectionStart.getStartPosition())){f=c;let e=new a.L(p,f);n.selectionStart.containsPosition(e)&&(f=n.selectionStart.endColumn)}else{f=d;let e=new a.L(p,f);n.selectionStart.containsPosition(e)&&(f=n.selectionStart.startColumn)}return n.move(!0,p,f,0)}}class h extends u{static deleteWordPartLeft(e){const t=c([u.deleteWordLeft(e,0),u.deleteWordLeft(e,2),u._deleteWordPartLeft(e.model,e.selection)]);return t.sort(l.e.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=c([u.deleteWordRight(e,0),u.deleteWordRight(e,2),u._deleteWordPartRight(e.model,e.selection)]);return t.sort(l.e.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,n){const i=c([u.moveWordLeft(e,t,n,0),u.moveWordLeft(e,t,n,2),u._moveWordPartLeft(t,n)]);return i.sort(a.L.compare),i[2]}static moveWordPartRight(e,t,n){const i=c([u.moveWordRight(e,t,n,0),u.moveWordRight(e,t,n,2),u._moveWordPartRight(t,n)]);return i.sort(a.L.compare),i[0]}}function c(e){return e.filter(e=>Boolean(e))}},59410:(e,t,n)=>{n.d(t,{u:()=>s});var i=n(44906);class r extends i.N{constructor(e){super(0);for(let t=0,n=e.length;t<n;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}const s=function(e){let t={};return n=>(t.hasOwnProperty(n)||(t[n]=e(n)),t[n])}(e=>new r(e))},44906:(e,t,n)=>{n.d(t,{N:()=>r,q:()=>s});var i=n(85427);class r{constructor(e){let t=(0,i.K)(e);this._defaultValue=t,this._asciiMap=r._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);for(let n=0;n<256;n++)t[n]=e;return t}set(e,t){let n=(0,i.K)(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}class s{constructor(){this._actual=new r(0)}add(e){this._actual.set(e,1)}has(e){return 1===this._actual.get(e)}}},69386:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(24314);class r{static insert(e,t){return{range:new i.e(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}},78411:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(44101);class r{constructor(e,t,n){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._languageIdCodec=n}static createEmpty(e,t){const n=r.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new r(i,e,t)}equals(e){return e instanceof r&&this.slicedEquals(e,0,this._tokensCount)}slicedEquals(e,t,n){if(this._text!==e._text)return!1;if(this._tokensCount!==e._tokensCount)return!1;const i=t<<1,r=i+(n<<1);for(let t=i;t<r;t++)if(this._tokens[t]!==e._tokens[t])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[1+(e<<1)]}getLanguageId(e){const t=this._tokens[1+(e<<1)],n=i.NX.getLanguageId(t);return this._languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){const t=this._tokens[1+(e<<1)];return i.NX.getTokenType(t)}getForeground(e){const t=this._tokens[1+(e<<1)];return i.NX.getForeground(t)}getClassName(e){const t=this._tokens[1+(e<<1)];return i.NX.getClassNameFromMetadata(t)}getInlineStyle(e,t){const n=this._tokens[1+(e<<1)];return i.NX.getInlineStyleFromMetadata(n,t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return r.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new s(this,e,t,n)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let t=0;t<n;t++)e[t<<1]=e[t+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){const r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}withInserted(e){if(0===e.length)return this;let t=0,n=0,i="";const s=new Array;let o=0;for(;;){let r=t<this._tokensCount?this._tokens[t<<1]:-1,a=n<e.length?e[n]:null;if(-1!==r&&(null===a||r<=a.offset)){i+=this._text.substring(o,r);const e=this._tokens[1+(t<<1)];s.push(i.length,e),t++,o=r}else{if(!a)break;if(a.offset>o){i+=this._text.substring(o,a.offset);const e=this._tokens[1+(t<<1)];s.push(i.length,e),o=a.offset}i+=a.text,s.push(i.length,a.tokenMetadata),n++}}return new r(new Uint32Array(s),i,this._languageIdCodec)}}r.defaultTokenMetadata=16793600;class s{constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let t=this._firstTokenIndex,i=e.getCount();t<i;t++){if(e.getStartOffset(t)>=n)break;this._tokensCount++}}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof s&&(this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount))}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}},50187:(e,t,n)=>{n.d(t,{L:()=>i});class i{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new i(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return i.equals(this,e)}static equals(e,t){return!e&&!t||!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return i.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<t.column}isBeforeOrEqual(e){return i.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<=t.column}static compare(e,t){let n=0|e.lineNumber,i=0|t.lineNumber;if(n===i){return(0|e.column)-(0|t.column)}return n-i}clone(){return new i(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new i(e.lineNumber,e.column)}static isIPosition(e){return e&&"number"==typeof e.lineNumber&&"number"==typeof e.column}}},24314:(e,t,n)=>{n.d(t,{e:()=>r});var i=n(50187);class r{constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return r.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return r.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>e.endColumn))}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<=e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>=e.endColumn))}containsRange(e){return r.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)))}strictContainsRange(e){return r.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)))}plusRange(e){return r.plusRange(this,e)}static plusRange(e,t){let n,i,s,o;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new r(n,i,s,o)}intersectRanges(e){return r.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,s=e.endLineNumber,o=e.endColumn,a=t.startLineNumber,l=t.startColumn,u=t.endLineNumber,h=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),s>u?(s=u,o=h):s===u&&(o=Math.min(o,h)),n>s||n===s&&i>o?null:new r(n,i,s,o)}equalsRange(e){return r.equalsRange(this,e)}static equalsRange(e,t){return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return r.getEndPosition(this)}static getEndPosition(e){return new i.L(e.endLineNumber,e.endColumn)}getStartPosition(){return r.getStartPosition(this)}static getStartPosition(e){return new i.L(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new r(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new r(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return r.collapseToStart(this)}static collapseToStart(e){return new r(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}static fromPositions(e,t=e){return new r(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new r(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&"number"==typeof e.startLineNumber&&"number"==typeof e.startColumn&&"number"==typeof e.endLineNumber&&"number"==typeof e.endColumn}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const n=0|e.startLineNumber,i=0|t.startLineNumber;if(n===i){const n=0|e.startColumn,i=0|t.startColumn;if(n===i){const n=0|e.endLineNumber,i=0|t.endLineNumber;if(n===i){return(0|e.endColumn)-(0|t.endColumn)}return n-i}return n-i}return n-i}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}}},89636:(e,t,n)=>{n.d(t,{h:()=>i});class i{constructor(e,t,n,r){this._rgba8Brand=void 0,this.r=i._clamp(e),this.g=i._clamp(t),this.b=i._clamp(n),this.a=i._clamp(r)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:0|e}}i.Empty=new i(0,0,0,0)},3860:(e,t,n)=>{n.d(t,{Y:()=>s});var i=n(50187),r=n(24314);class s extends r.e{constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return s.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return 0===this.getDirection()?new s(this.startLineNumber,this.startColumn,e,t):new s(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new i.L(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new i.L(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return 0===this.getDirection()?new s(e,t,this.endLineNumber,this.endColumn):new s(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new s(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return 0===t?new s(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new s(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new s(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&"number"==typeof e.selectionStartLineNumber&&"number"==typeof e.selectionStartColumn&&"number"==typeof e.positionLineNumber&&"number"==typeof e.positionColumn}static createWithDirection(e,t,n,i,r){return 0===r?new s(e,t,n,i):new s(n,i,e,t)}}},50072:(e,t,n)=>{n.d(t,{kH:()=>m,l$:()=>d,lZ:()=>c,oe:()=>h});var i=n(97295),r=n(1432),s=n(53060);let o,a,l;function u(){return o||(o=new TextDecoder("UTF-16LE")),o}function h(){return l||(l=r.r()?u():(a||(a=new TextDecoder("UTF-16BE")),a)),l}const c="undefined"!=typeof TextDecoder;let d,m;function g(e,t,n){let i=[],r=0;for(let o=0;o<n;o++){const n=s.mP(e,t);t+=2,i[r++]=String.fromCharCode(n)}return i.join("")}c?(d=e=>new f(e),m=function(e,t,n){const i=new Uint16Array(e.buffer,t,n);if(n>0&&(65279===i[0]||65534===i[0]))return g(e,t,n);return u().decode(i)}):(d=e=>new p,m=g);class f{constructor(e){this._capacity=0|e,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return null!==this._completedStrings?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(0===this._bufferLength)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return h().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,null===this._completedStrings?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}write1(e){const t=this._capacity-this._bufferLength;t<=1&&(0===t||i.ZG(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCII(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIIString(e){const t=e.length;if(this._bufferLength+t>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=e);for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}}class p{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCII(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCIIString(e){this._pieces[this._piecesLen++]=e}}},85600:(e,t,n)=>{n.d(t,{Hi:()=>s,WU:()=>i,hG:()=>r});class i{constructor(e,t,n){this._tokenBrand=void 0,this.offset=e,this.type=t,this.language=n}toString(){return"("+this.offset+", "+this.type+")"}}class r{constructor(e,t){this._tokenizationResultBrand=void 0,this.tokens=e,this.endState=t}}class s{constructor(e,t){this._tokenizationResult2Brand=void 0,this.tokens=e,this.endState=t}}},86237:(e,t,n)=>{n.d(t,{g:()=>h});var i=n(2484),r=n(97295);function s(e,t,n,r){return new i.Hs(e,t,n).ComputeDiff(r)}class o{constructor(e){const t=[],n=[];for(let i=0,r=e.length;i<r;i++)t[i]=c(e[i],1),n[i]=d(e[i],1);this.lines=e,this._startColumns=t,this._endColumns=n}getElements(){const e=[];for(let t=0,n=this.lines.length;t<n;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,n){const i=[],r=[],s=[];let o=0;for(let a=t;a<=n;a++){const t=this.lines[a],n=e?this._startColumns[a]:1,l=e?this._endColumns[a]:t.length+1;for(let e=n;e<l;e++)i[o]=t.charCodeAt(e-1),r[o]=a+1,s[o]=e,o++}return new a(i,r,s)}}class a{constructor(e,t,n){this._charCodes=e,this._lineNumbers=t,this._columns=n}getElements(){return this._charCodes}getStartLineNumber(e){return this._lineNumbers[e]}getStartColumn(e){return this._columns[e]}getEndLineNumber(e){return this._lineNumbers[e]}getEndColumn(e){return this._columns[e]+1}}class l{constructor(e,t,n,i,r,s,o,a){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=n,this.originalEndColumn=i,this.modifiedStartLineNumber=r,this.modifiedStartColumn=s,this.modifiedEndLineNumber=o,this.modifiedEndColumn=a}static createFromDiffChange(e,t,n){let i,r,s,o,a,u,h,c;return 0===e.originalLength?(i=0,r=0,s=0,o=0):(i=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),s=t.getEndLineNumber(e.originalStart+e.originalLength-1),o=t.getEndColumn(e.originalStart+e.originalLength-1)),0===e.modifiedLength?(a=0,u=0,h=0,c=0):(a=n.getStartLineNumber(e.modifiedStart),u=n.getStartColumn(e.modifiedStart),h=n.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),c=n.getEndColumn(e.modifiedStart+e.modifiedLength-1)),new l(i,r,s,o,a,u,h,c)}}class u{constructor(e,t,n,i,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=n,this.modifiedEndLineNumber=i,this.charChanges=r}static createFromDiffResult(e,t,n,i,r,o,a){let h,c,d,m,g=void 0;if(0===t.originalLength?(h=n.getStartLineNumber(t.originalStart)-1,c=0):(h=n.getStartLineNumber(t.originalStart),c=n.getEndLineNumber(t.originalStart+t.originalLength-1)),0===t.modifiedLength?(d=i.getStartLineNumber(t.modifiedStart)-1,m=0):(d=i.getStartLineNumber(t.modifiedStart),m=i.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const o=n.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),u=i.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);let h=s(o,u,r,!0).changes;a&&(h=function(e){if(e.length<=1)return e;const t=[e[0]];let n=t[0];for(let i=1,r=e.length;i<r;i++){const r=e[i],s=r.originalStart-(n.originalStart+n.originalLength),o=r.modifiedStart-(n.modifiedStart+n.modifiedLength);Math.min(s,o)<3?(n.originalLength=r.originalStart+r.originalLength-n.originalStart,n.modifiedLength=r.modifiedStart+r.modifiedLength-n.modifiedStart):(t.push(r),n=r)}return t}(h)),g=[];for(let e=0,t=h.length;e<t;e++)g.push(l.createFromDiffChange(h[e],o,u))}return new u(h,c,d,m,g)}}class h{constructor(e,t,n){this.shouldComputeCharChanges=n.shouldComputeCharChanges,this.shouldPostProcessCharChanges=n.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=n.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=n.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new o(e),this.modified=new o(t),this.continueLineDiff=m(n.maxComputationTime),this.continueCharDiff=m(0===n.maxComputationTime?0:Math.min(n.maxComputationTime,5e3))}computeDiff(){if(1===this.original.lines.length&&0===this.original.lines[0].length)return 1===this.modified.lines.length&&0===this.modified.lines[0].length?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(1===this.modified.lines.length&&0===this.modified.lines[0].length)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const e=s(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,n=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const e=[];for(let n=0,i=t.length;n<i;n++)e.push(u.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[n],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:n,changes:e}}const i=[];let r=0,o=0;for(let e=-1,n=t.length;e<n;e++){const s=e+1<n?t[e+1]:null,a=s?s.originalStart:this.originalLines.length,l=s?s.modifiedStart:this.modifiedLines.length;for(;r<a&&o<l;){const e=this.originalLines[r],t=this.modifiedLines[o];if(e!==t){{let n=c(e,1),s=c(t,1);for(;n>1&&s>1;){if(e.charCodeAt(n-2)!==t.charCodeAt(s-2))break;n--,s--}(n>1||s>1)&&this._pushTrimWhitespaceCharChange(i,r+1,1,n,o+1,1,s)}{let n=d(e,1),s=d(t,1);const a=e.length+1,l=t.length+1;for(;n<a&&s<l;){if(e.charCodeAt(n-1)!==e.charCodeAt(s-1))break;n++,s++}(n<a||s<l)&&this._pushTrimWhitespaceCharChange(i,r+1,n,a,o+1,s,l)}}r++,o++}s&&(i.push(u.createFromDiffResult(this.shouldIgnoreTrimWhitespace,s,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=s.originalLength,o+=s.modifiedLength)}return{quitEarly:n,changes:i}}_pushTrimWhitespaceCharChange(e,t,n,i,r,s,o){if(this._mergeTrimWhitespaceCharChange(e,t,n,i,r,s,o))return;let a=void 0;this.shouldComputeCharChanges&&(a=[new l(t,n,t,i,r,s,r,o)]),e.push(new u(t,t,r,r,a))}_mergeTrimWhitespaceCharChange(e,t,n,i,r,s,o){const a=e.length;if(0===a)return!1;const u=e[a-1];return 0!==u.originalEndLineNumber&&0!==u.modifiedEndLineNumber&&(u.originalEndLineNumber+1===t&&u.modifiedEndLineNumber+1===r&&(u.originalEndLineNumber=t,u.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&u.charChanges&&u.charChanges.push(new l(t,n,t,i,r,s,r,o)),!0))}}function c(e,t){const n=r.LC(e);return-1===n?t:n+1}function d(e,t){const n=r.ow(e);return-1===n?t:n+2}function m(e){if(0===e)return()=>!0;const t=Date.now();return()=>Date.now()-t<e}},30653:(e,t,n)=>{n.d(t,{p:()=>i});class i{constructor(e,t,n,i,r,s){this.id=e,this.label=t,this.alias=n,this._precondition=i,this._run=r,this._contextKeyService=s}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){return this.isSupported()?this._run():Promise.resolve(void 0)}}},96518:(e,t,n)=>{n.d(t,{g:()=>i});const i={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"}},29102:(e,t,n)=>{n.d(t,{u:()=>i});var i,r=n(63580),s=n(38819);!function(e){e.editorSimpleInput=new s.uy("editorSimpleInput",!1,!0),e.editorTextFocus=new s.uy("editorTextFocus",!1,r.N("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),e.focus=new s.uy("editorFocus",!1,r.N("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),e.textInputFocus=new s.uy("textInputFocus",!1,r.N("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),e.readOnly=new s.uy("editorReadonly",!1,r.N("editorReadonly","Whether the editor is read only")),e.inDiffEditor=new s.uy("inDiffEditor",!1,r.N("inDiffEditor","Whether the context is a diff editor")),e.columnSelection=new s.uy("editorColumnSelection",!1,r.N("editorColumnSelection","Whether `editor.columnSelection` is enabled")),e.writable=e.readOnly.toNegated(),e.hasNonEmptySelection=new s.uy("editorHasSelection",!1,r.N("editorHasSelection","Whether the editor has text selected")),e.hasOnlyEmptySelection=e.hasNonEmptySelection.toNegated(),e.hasMultipleSelections=new s.uy("editorHasMultipleSelections",!1,r.N("editorHasMultipleSelections","Whether the editor has multiple selections")),e.hasSingleSelection=e.hasMultipleSelections.toNegated(),e.tabMovesFocus=new s.uy("editorTabMovesFocus",!1,r.N("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),e.tabDoesNotMoveFocus=e.tabMovesFocus.toNegated(),e.isInWalkThroughSnippet=new s.uy("isInEmbeddedEditor",!1,!0),e.canUndo=new s.uy("canUndo",!1,!0),e.canRedo=new s.uy("canRedo",!1,!0),e.hoverVisible=new s.uy("editorHoverVisible",!1,r.N("editorHoverVisible","Whether the editor hover is visible")),e.inCompositeEditor=new s.uy("inCompositeEditor",void 0,r.N("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),e.notInCompositeEditor=e.inCompositeEditor.toNegated(),e.languageId=new s.uy("editorLangId","",r.N("editorLangId","The language identifier of the editor")),e.hasCompletionItemProvider=new s.uy("editorHasCompletionItemProvider",!1,r.N("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),e.hasCodeActionsProvider=new s.uy("editorHasCodeActionsProvider",!1,r.N("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),e.hasCodeLensProvider=new s.uy("editorHasCodeLensProvider",!1,r.N("editorHasCodeLensProvider","Whether the editor has a code lens provider")),e.hasDefinitionProvider=new s.uy("editorHasDefinitionProvider",!1,r.N("editorHasDefinitionProvider","Whether the editor has a definition provider")),e.hasDeclarationProvider=new s.uy("editorHasDeclarationProvider",!1,r.N("editorHasDeclarationProvider","Whether the editor has a declaration provider")),e.hasImplementationProvider=new s.uy("editorHasImplementationProvider",!1,r.N("editorHasImplementationProvider","Whether the editor has an implementation provider")),e.hasTypeDefinitionProvider=new s.uy("editorHasTypeDefinitionProvider",!1,r.N("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),e.hasHoverProvider=new s.uy("editorHasHoverProvider",!1,r.N("editorHasHoverProvider","Whether the editor has a hover provider")),e.hasDocumentHighlightProvider=new s.uy("editorHasDocumentHighlightProvider",!1,r.N("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),e.hasDocumentSymbolProvider=new s.uy("editorHasDocumentSymbolProvider",!1,r.N("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),e.hasReferenceProvider=new s.uy("editorHasReferenceProvider",!1,r.N("editorHasReferenceProvider","Whether the editor has a reference provider")),e.hasRenameProvider=new s.uy("editorHasRenameProvider",!1,r.N("editorHasRenameProvider","Whether the editor has a rename provider")),e.hasSignatureHelpProvider=new s.uy("editorHasSignatureHelpProvider",!1,r.N("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),e.hasInlayHintsProvider=new s.uy("editorHasInlayHintsProvider",!1,r.N("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),e.hasDocumentFormattingProvider=new s.uy("editorHasDocumentFormattingProvider",!1,r.N("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),e.hasDocumentSelectionFormattingProvider=new s.uy("editorHasDocumentSelectionFormattingProvider",!1,r.N("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),e.hasMultipleDocumentFormattingProvider=new s.uy("editorHasMultipleDocumentFormattingProvider",!1,r.N("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),e.hasMultipleDocumentSelectionFormattingProvider=new s.uy("editorHasMultipleDocumentSelectionFormattingProvider",!1,r.N("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))}(i||(i={}))},84973:(e,t,n)=>{n.d(t,{F5:()=>r,Qi:()=>c,UO:()=>u,dJ:()=>a,je:()=>d,s6:()=>s,sh:()=>i,tk:()=>l,vW:()=>h});var i,r,s,o=n(36248);!function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"}(i||(i={})),function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"}(r||(r={}));class a{constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|e.tabSize),this.indentSize=0|e.tabSize,this.insertSpaces=Boolean(e.insertSpaces),this.defaultEOL=0|e.defaultEOL,this.trimAutoWhitespace=Boolean(e.trimAutoWhitespace),this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&(0,o.fS)(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class l{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}!function(e){e[e.Disabled=0]="Disabled",e[e.EnabledForActive=1]="EnabledForActive",e[e.Enabled=2]="Enabled"}(s||(s={}));class u{constructor(e,t,n){this.visibleColumn=e,this.className=t,this.horizontalLine=n}}class h{constructor(e,t){this.top=e,this.endColumn=t}}class c{constructor(e,t,n,i,r,s){this.identifier=e,this.range=t,this.text=n,this.forceMoveMarkers=i,this.isAutoWhitespaceEdit=r,this._isTracked=s}}class d{constructor(e,t,n){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=n}}},10544:(e,t,n)=>{n.d(t,{w:()=>se});var i=n(4669),r=n(9917),s=n(24314);class o{constructor(e,t,n){this.range=e,this.nestingLevel=t,this.isInvalid=n}}class a extends class{constructor(e,t,n,i){this.range=e,this.openingBracketRange=t,this.closingBracketRange=n,this.nestingLevel=i}}{constructor(e,t,n,i,r){super(e,t,n,i),this.minVisibleColumnIndentation=r}}var l=n(97295);class u{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}const h=Math.pow(2,26);function c(e,t){return e*h+t}function d(e){const t=e,n=Math.floor(t/h);return new u(n,t-n*h)}function m(e,t){return t<h?e+t:e-e%h+t}function g(e,t){return e<t}function f(e,t){return e<=t}function p(e,t){return e>=t}function C(e){return c(e.lineNumber-1,e.column-1)}function b(e,t){const n=e,i=Math.floor(n/h),r=n-i*h,o=t,a=Math.floor(o/h),l=o-a*h;return new s.e(i+1,r+1,a+1,l+1)}class L{constructor(e,t,n){this.startOffset=e,this.endOffset=t,this.newLength=n}}class S{constructor(e,t){this.documentLength=t,this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(e=>_.from(e))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx];return function(e,t){const n=e,i=t;if(i-n<=0)return 0;const r=Math.floor(n/h),s=Math.floor(i/h),o=i-s*h;if(r===s){return c(0,o-(n-r*h))}return c(s-r,o)}(e,t?this.translateOldToCur(t.offsetObj):this.documentLength)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?c(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):c(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=d(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?c(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):c(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(!f(n,e))break;{this.nextEditIdx++;const e=d(n),i=d(this.translateOldToCur(t.endOffsetBeforeObj)),r=e.lineCount-i.lineCount;this.deltaOldToNewLineCount+=r;const s=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,o=e.columnCount-i.columnCount;this.deltaOldToNewColumnCount=s+o,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}}}}class _{constructor(e,t,n){this.endOffsetBeforeObj=d(t),this.endOffsetAfterObj=d(m(e,n)),this.offsetObj=d(e)}static from(e){return new _(e.startOffset,e.endOffset,e.newLength)}}var w=n(47707);const N=new Array;class v{constructor(e,t){this.items=e,this.additionalItems=t}static create(e,t){if(e<=128&&0===t.length){let n=v.cache[e];return n||(n=new v(e,t),v.cache[e]=n),n}return new v(e,t)}static getEmpty(){return this.empty}add(e,t){const n=t.getKey(e);let i=n>>5;if(0===i){const e=1<<n|this.items;return e===this.items?this:v.create(e,this.additionalItems)}i--;const r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(31&n),v.create(this.items,r)}merge(e){const t=this.items|e.items;if(this.additionalItems===N&&e.additionalItems===N)return t===this.items?this:t===e.items?e:v.create(t,N);const n=new Array;for(let t=0;t<Math.max(this.additionalItems.length,e.additionalItems.length);t++){const i=this.additionalItems[t]||0,r=e.additionalItems[t]||0;n.push(i|r)}return v.create(t,n)}intersects(e){if(0!=(this.items&e.items))return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(0!=(this.additionalItems[t]&e.additionalItems[t]))return!0;return!1}}v.cache=new Array(129),v.empty=v.create(0,N);const k={getKey:e=>e};class x{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return void 0===t&&(t=this.items.size,this.items.set(e,t)),t}}class I{constructor(e){this._length=e}get length(){return this._length}}class T extends I{constructor(e,t,n,i,r){super(e),this.openingBracket=t,this.child=n,this.closingBracket=i,this.missingOpeningBracketIds=r}static create(e,t,n){let i=e.length;return t&&(i=m(i,t.length)),n&&(i=m(i,n.length)),new T(i,e,t,n,t?t.missingOpeningBracketIds:v.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=new Array;return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}canBeReused(e){return null!==this.closingBracket&&!e.intersects(this.missingOpeningBracketIds)}deepClone(){return new T(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(m(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class E extends I{constructor(e,t,n){super(e),this.listHeight=t,this._missingOpeningBracketIds=n,this.cachedMinIndentation=-1}static create23(e,t,n,i=!1){let r=e.length,s=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(r=m(r,t.length),s=s.merge(t.missingOpeningBracketIds),n){if(e.listHeight!==n.listHeight)throw new Error("Invalid list heights");r=m(r,n.length),s=s.merge(n.missingOpeningBracketIds)}return i?new y(r,e.listHeight+1,e,t,n,s):new P(r,e.listHeight+1,e,t,n,s)}static getEmpty(){return new M(0,0,[],v.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(0===e)return;const t=this.getChild(e-1),n=4===t.kind?t.toMutable():t;return t!==n&&this.setChild(e-1,n),n}makeFirstElementMutable(){this.throwIfImmutable();if(0===this.childrenLength)return;const e=this.getChild(0),t=4===e.kind?e.toMutable():e;return e!==t&&this.setChild(0,t),t}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds))return!1;let t,n=this;for(;4===n.kind&&(t=n.childrenLength)>0;)n=n.getChild(t-1);return n.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,n=this.getChild(0).missingOpeningBracketIds;for(let i=1;i<e;i++){const e=this.getChild(i);t=m(t,e.length),n=n.merge(e.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=n,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(-1!==this.cachedMinIndentation)return this.cachedMinIndentation;let n=Number.MAX_SAFE_INTEGER,i=e;for(let e=0;e<this.childrenLength;e++){const r=this.getChild(e);r&&(n=Math.min(n,r.computeMinIndentation(i,t)),i=m(i,r.length))}return this.cachedMinIndentation=n,n}}class P extends E{constructor(e,t,n,i,r,s){super(e,t,s),this._item1=n,this._item2=i,this._item3=r}get childrenLength(){return null!==this._item3?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:return void(this._item1=t);case 1:return void(this._item2=t);case 2:return void(this._item3=t)}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new P(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class y extends P{toMutable(){return new P(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class O extends E{constructor(e,t,n,i){super(e,t,i),this._children=n}get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new O(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class M extends O{toMutable(){return new O(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const B=[];class A extends I{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return B}deepClone(){return this}}class R extends A{get kind(){return 0}get missingOpeningBracketIds(){return v.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const n=d(e),i=(0===n.columnCount?n.lineCount:n.lineCount+1)+1,r=(s=m(e,this.length),Math.floor(s/h)+1);var s;let o=Number.MAX_SAFE_INTEGER;for(let e=i;e<=r;e++){const n=t.getLineFirstNonWhitespaceColumn(e),i=t.getLineContent(e);if(0===n)continue;const r=w.i.visibleColumnFromColumn(i,n,t.getOptions().tabSize);o=Math.min(o,r)}return o}}class V extends A{constructor(e){super(e)}static create(e){const t=e,n=V.cacheByLength.get(t);if(n)return n;const i=new V(e);return V.cacheByLength.set(t,i),i}get kind(){return 1}get missingOpeningBracketIds(){return v.getEmpty()}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}V.cacheByLength=new Map;class W extends A{constructor(e,t){super(t),this.missingOpeningBracketIds=e}get kind(){return 3}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}var D=n(17301),z=n(44101);class F{constructor(e,t,n,i,r){this.length=e,this.kind=t,this.bracketId=n,this.bracketIds=i,this.astNode=r}}class H{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new U(this.textModel,this.bracketTokens),this._offset=0,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return c(this.textBufferLineCount,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=m(this._offset,e);const t=d(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=m(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class U{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset)):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const e=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=e.length,e}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;null===this.line&&(this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let n=0;for(;;){const i=this.lineTokens,r=i.getCount();let s=null;if(this.lineTokenOffset<r){const o=i.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<r&&o===i.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const a=0===z.NX.getTokenType(o),l=i.getEndOffset(this.lineTokenOffset);if(a&&l!==this.lineCharOffset){const e=i.getLanguageId(this.lineTokenOffset),t=this.line.substring(this.lineCharOffset,l),n=this.bracketTokens.getSingleLanguageBracketTokens(e),r=n.regExpGlobal;if(r){r.lastIndex=0;const e=r.exec(t);e&&(s=n.getToken(e[0]),s&&(this.lineCharOffset+=e.index))}}if(n+=l-this.lineCharOffset,s){if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=s;break}return this.lineCharOffset+=s.length,s}this.lineTokenOffset++,this.lineCharOffset=l}else{if(this.lineIdx===this.textBufferLineCount-1)break;if(this.lineIdx++,this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3)break}if(n>1500)break}const i=(r=e,s=t,o=this.lineIdx,a=this.lineCharOffset,r!==o?c(o-r,a):c(0,a-s));var r,s,o,a;return new F(i,0,-1,v.getEmpty(),new R(i))}}class q{constructor(e,t){this.text=e,this._offset=0,this.idx=0;const n=t.getRegExpStr()?new RegExp(t.getRegExpStr()+"|\n","g"):null,i=[];let r,s=0,o=0,a=0,l=0;const u=new Array;for(let e=0;e<60;e++)u.push(new F(c(0,e),0,-1,v.getEmpty(),new R(c(0,e))));const h=new Array;for(let e=0;e<60;e++)h.push(new F(c(1,e),0,-1,v.getEmpty(),new R(c(1,e))));if(n)for(n.lastIndex=0;null!==(r=n.exec(e));){const e=r.index,n=r[0];if("\n"===n)s++,o=e+1;else{if(a!==e){let t;if(l===s){const n=e-a;if(n<u.length)t=u[n];else{const e=c(0,n);t=new F(e,0,-1,v.getEmpty(),new R(e))}}else{const n=s-l,i=e-o;if(1===n&&i<h.length)t=h[i];else{const e=c(n,i);t=new F(e,0,-1,v.getEmpty(),new R(e))}}i.push(t)}i.push(t.getToken(n)),a=e+n.length,l=s}}const d=e.length;if(a!==d){const e=l===s?c(0,d-a):c(s-l,d-o);i.push(new F(e,0,-1,v.getEmpty(),new R(e)))}this.length=c(s,d-o),this.tokens=i}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new D.B8}}class j{constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}static createFromLanguage(e,t){function n(e,n){return t.getKey(`${e}:::${n}`)}const i=e.characterPair.getColorizedBrackets(),r=new Map,s=new Set;for(const[t,o]of i){s.add(t);let i=r.get(o);const a=n(e.languageId,t);i||(i={openingBrackets:v.getEmpty(),first:a},r.set(o,i)),i.openingBrackets=i.openingBrackets.add(a,k)}const o=new Map;for(const[e,t]of r){const n=c(0,e.length);o.set(e,new F(n,2,t.first,t.openingBrackets,V.create(n)))}for(const t of s){const i=c(0,t.length),r=n(e.languageId,t);o.set(t,new F(i,1,r,v.getEmpty().add(r,k),V.create(i)))}return new j(o)}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(e=>function(e){const t=(0,l.ec)(e);return/^[\w ]+$/.test(e)?`\\b${t}\\b`:t}(e)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e)}get isEmpty(){return 0===this.map.size}}class K{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){const t=this.languageIdToBracketTokens.get(e);if(!t)return!1;const n=j.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider).getRegExpStr();return t.getRegExpStr()!==n}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=j.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function $(e,t=!1){if(0===e.length)return null;if(1===e.length)return e[0];let n=e.length;for(;n>3;){const i=n>>1;for(let r=0;r<i;r++){const i=r<<1;e[r]=E.create23(e[i],e[i+1],i+3===n?e[i+2]:null,t)}n=i}return E.create23(e[0],e[1],n>=3?e[2]:null,t)}function X(e,t){return Math.abs(e.listHeight-t.listHeight)}function G(e,t){return e.listHeight===t.listHeight?E.create23(e,t,null,!1):e.listHeight>t.listHeight?function(e,t){let n=e=e.toMutable();const i=new Array;let r;for(;;){if(t.listHeight===n.listHeight){r=t;break}if(4!==n.kind)throw new Error("unexpected");i.push(n),n=n.makeLastElementMutable()}for(let e=i.length-1;e>=0;e--){const t=i[e];r?t.childrenLength>=3?r=E.create23(t.unappendChild(),r,null,!1):(t.appendChildOfSameHeight(r),r=void 0):t.handleChildrenChanged()}return r?E.create23(e,r,null,!1):e}(e,t):function(e,t){let n=e=e.toMutable();const i=new Array;for(;t.listHeight!==n.listHeight;){if(4!==n.kind)throw new Error("unexpected");i.push(n),n=n.makeFirstElementMutable()}let r=t;for(let e=i.length-1;e>=0;e--){const t=i[e];r?t.childrenLength>=3?r=E.create23(r,t.unprependChild(),null,!1):(t.prependChildOfSameHeight(r),r=void 0):t.handleChildrenChanged()}return r?E.create23(r,e,null,!1):e}(t,e)}class Y{constructor(e){this.lastOffset=0,this.nextNodes=[e],this.offsets=[0],this.idxs=[]}readLongestNodeAt(e,t){if(g(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const n=J(this.nextNodes);if(!n)return;const i=J(this.offsets);if(g(e,i))return;if(g(i,e))if(m(i,n.length)<=e)this.nextNodeAfterCurrent();else{const e=Q(n);-1!==e?(this.nextNodes.push(n.getChild(e)),this.offsets.push(i),this.idxs.push(e)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{const e=Q(n);if(-1===e)return void this.nextNodeAfterCurrent();this.nextNodes.push(n.getChild(e)),this.offsets.push(i),this.idxs.push(e)}}}}nextNodeAfterCurrent(){for(;;){const e=J(this.offsets),t=J(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),0===this.idxs.length)break;const n=J(this.nextNodes),i=Q(n,this.idxs[this.idxs.length-1]);if(-1!==i){this.nextNodes.push(n.getChild(i)),this.offsets.push(m(e,t.length)),this.idxs[this.idxs.length-1]=i;break}this.idxs.pop()}}}function Q(e,t=-1){for(;;){if(++t>=e.childrenLength)return-1;if(e.getChild(t))return t}}function J(e){return e.length>0?e[e.length-1]:void 0}function Z(e,t,n,i){return new ee(e,t,n,i).parseDocument()}class ee{constructor(e,t,n,i){if(this.tokenizer=e,this.createImmutableLists=i,this._itemsConstructed=0,this._itemsFromCache=0,n&&i)throw new Error("Not supported");this.oldNodeReader=n?new Y(n):void 0,this.positionMapper=new S(t,e.length)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(v.getEmpty());return e||(e=E.getEmpty()),e}parseList(e){const t=new Array;for(;;){const n=this.tokenizer.peek();if(!n||2===n.kind&&n.bracketIds.intersects(e))break;const i=this.parseChild(e);4===i.kind&&0===i.childrenLength||t.push(i)}return this.oldNodeReader?function(e){if(0===e.length)return null;if(1===e.length)return e[0];let t=0;function n(){if(t>=e.length)return null;const n=t,i=e[n].listHeight;for(t++;t<e.length&&e[t].listHeight===i;)t++;return t-n>=2?$(0===n&&t===e.length?e:e.slice(n,t),!1):e[n]}let i=n(),r=n();if(!r)return i;for(let e=n();e;e=n())X(i,r)<=X(r,e)?(i=G(i,r),r=e):r=G(r,e);return G(i,r)}(t):$(t,this.createImmutableLists)}parseChild(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(0!==t){const n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>{if(!g(n.length,t))return!1;return n.canBeReused(e)});if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}this._itemsConstructed++;const t=this.tokenizer.read();switch(t.kind){case 2:return new W(t.bracketIds,t.length);case 0:return t.astNode;case 1:const n=e.merge(t.bracketIds),i=this.parseList(n),r=this.tokenizer.peek();return r&&2===r.kind&&(r.bracketId===t.bracketId||r.bracketIds.intersects(t.bracketIds))?(this.tokenizer.read(),T.create(t.astNode,i,r.astNode)):T.create(t.astNode,i,null);default:throw new Error("unexpected")}}}class te extends r.JT{constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new i.Q5,this.denseKeyProvider=new x,this.brackets=new K(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this._register(e.onBackgroundTokenizationStateChanged(()=>{if(2===e.backgroundTokenizationState){const e=void 0===this.initialAstWithoutTokens;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}})),this._register(e.onDidChangeTokens(({ranges:e})=>{const t=e.map(e=>new L(c(e.fromLineNumber-1,0),c(e.toLineNumber,0),c(e.toLineNumber-e.fromLineNumber+1,0)));this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens,!1),this.initialAstWithoutTokens||this.didChangeEmitter.fire()})),0===e.backgroundTokenizationState){const e=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),t=new q(this.textModel.getValue(),e);this.initialAstWithoutTokens=Z(t,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}else 2===e.backgroundTokenizationState?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):1===e.backgroundTokenizationState&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens)}didLanguageChange(e){return this.brackets.didLanguageChange(e)}handleContentChanged(e){const t=e.changes.map(e=>{const t=s.e.lift(e.range);return new L(C(t.getStartPosition()),C(t.getEndPosition()),function(e){const t=(0,l.uq)(e);return c(t.length-1,t[t.length-1].length)}(e.text))}).reverse();this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens,!1),this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(t,this.initialAstWithoutTokens,!1))}parseDocumentFromTextBuffer(e,t,n){const i=t;return Z(new H(this.textModel,this.brackets),e,i,n)}getBracketsInRange(e){const t=c(e.startLineNumber-1,e.startColumn-1),n=c(e.endLineNumber-1,e.endColumn-1),i=new Array,r=this.initialAstWithoutTokens||this.astWithTokens;return function e(t,n,i,r,s,a,l=0){if(1===t.kind){const e=b(n,i);a.push(new o(e,l-1,!1))}else if(3===t.kind){const e=b(n,i);a.push(new o(e,l-1,!0))}else if(4===t.kind)for(const o of t.children)i=m(n,o.length),f(n,s)&&p(i,r)&&e(o,n,i,r,s,a,l),n=i;else if(2===t.kind){l++;{const o=t.openingBracket;i=m(n,o.length),f(n,s)&&p(i,r)&&e(o,n,i,r,s,a,l),n=i}if(t.child){const o=t.child;i=m(n,o.length),f(n,s)&&p(i,r)&&e(o,n,i,r,s,a,l),n=i}if(t.closingBracket){const o=t.closingBracket;i=m(n,o.length),f(n,s)&&p(i,r)&&e(o,n,i,r,s,a,l),n=i}}}(r,0,r.length,t,n,i),i}getBracketPairsInRange(e,t){const n=new Array,i=C(e.getStartPosition()),r=C(e.getEndPosition()),s=this.initialAstWithoutTokens||this.astWithTokens,o=new ne(n,t,this.textModel);return function e(t,n,i,r,s,o,l=0){var u;if(2===t.kind){const e=m(n,t.openingBracket.length);let r=-1;o.includeMinIndentation&&(r=t.computeMinIndentation(n,o.textModel)),o.result.push(new a(b(n,i),b(n,e),t.closingBracket?b(m(e,(null===(u=t.child)||void 0===u?void 0:u.length)||0),i):void 0,l,r)),l++}let h=n;for(const n of t.children){const t=h;h=m(h,n.length),f(t,s)&&f(r,h)&&e(n,t,h,r,s,o,l)}}(s,0,s.length,i,r,o),n}}class ne{constructor(e,t,n){this.result=e,this.includeMinIndentation=t,this.textModel=n}}var ie=n(40764),re=n(34227);class se extends r.JT{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new r.XK),this.onDidChangeEmitter=new i.Q5,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(e.onDidChangeOptions(e=>{this.bracketPairsTree.clear(),this.updateBracketPairsTree()})),this._register(e.onDidChangeLanguage(e=>{this.bracketPairsTree.clear(),this.updateBracketPairsTree()})),this._register(this.languageConfigurationService.onDidChange(e=>{var t;e.languageId&&!(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.didLanguageChange(e.languageId))||(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}))}get isDocumentSupported(){return this.textModel.getValueLength()<=5e6}updateBracketPairsTree(){if(this.bracketsRequested&&this.isDocumentSupported){if(!this.bracketPairsTree.value){const n=new r.SL;this.bracketPairsTree.value=(e=n.add(new te(this.textModel,e=>this.languageConfigurationService.getLanguageConfiguration(e))),t=n,{object:e,dispose:()=>null==t?void 0:t.dispose()}),n.add(this.bracketPairsTree.value.object.onDidChange(e=>this.onDidChangeEmitter.fire(e))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire());var e,t}handleContentChanged(e){var t;null===(t=this.bracketPairsTree.value)||void 0===t||t.object.handleContentChanged(e)}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketPairsInRange(e,!1))||[]}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketPairsInRange(e,!0))||[]}getBracketsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketsInRange(e))||[]}findMatchingBracketUp(e,t){let n=e.toLowerCase(),i=this.textModel.validatePosition(t);const r=this.textModel.getLanguageIdAtPosition(i.lineNumber,i.column);let s=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!s)return null;let o=s.textIsBracket[n];return o?ae(this._findMatchingBracketUp(o,i,null)):null}matchBracket(e){return this._matchBracket(this.textModel.validatePosition(e))}_establishBracketSearchOffsets(e,t,n,i){const r=t.getCount(),s=t.getLanguageId(i);let o=Math.max(0,e.column-1-n.maxBracketLength);for(let e=i-1;e>=0;e--){const n=t.getEndOffset(e);if(n<=o)break;if((0,ie.Bu)(t.getStandardTokenType(e))||t.getLanguageId(e)!==s){o=n;break}}let a=Math.min(t.getLineContent().length,e.column-1+n.maxBracketLength);for(let e=i+1;e<r;e++){const n=t.getStartOffset(e);if(n>=a)break;if((0,ie.Bu)(t.getStandardTokenType(e))||t.getLanguageId(e)!==s){a=n;break}}return{searchStartOffset:o,searchEndOffset:a}}_matchBracket(e){const t=e.lineNumber,n=this.textModel.getLineTokens(t),i=this.textModel.getLineContent(t),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const s=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(r)).brackets;if(s&&!(0,ie.Bu)(n.getStandardTokenType(r))){let{searchStartOffset:o,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,s,r),l=null;for(;;){const n=re.Vr.findNextBracketInRange(s.forwardRegex,t,i,o,a);if(!n)break;if(n.startColumn<=e.column&&e.column<=n.endColumn){const e=i.substring(n.startColumn-1,n.endColumn-1).toLowerCase(),t=this._matchFoundBracket(n,s.textIsBracket[e],s.textIsOpenBracket[e],null);if(t){if(t instanceof oe)return null;l=t}}o=n.endColumn-1}if(l)return l}if(r>0&&n.getStartOffset(r)===e.column-1){const s=r-1,o=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(s)).brackets;if(o&&!(0,ie.Bu)(n.getStandardTokenType(s))){let{searchStartOffset:r,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,o,s);const l=re.Vr.findPrevBracketInRange(o.reversedRegex,t,i,r,a);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn){const e=i.substring(l.startColumn-1,l.endColumn-1).toLowerCase(),t=this._matchFoundBracket(l,o.textIsBracket[e],o.textIsOpenBracket[e],null);if(t)return t instanceof oe?null:t}}}return null}_matchFoundBracket(e,t,n,i){if(!t)return null;const r=n?this._findMatchingBracketDown(t,e.getEndPosition(),i):this._findMatchingBracketUp(t,e.getStartPosition(),i);return r?r instanceof oe?r:[e,r]:null}_findMatchingBracketUp(e,t,n){const i=e.languageId,r=e.reversedRegex;let s=-1,o=0;const a=(t,i,a,l)=>{for(;;){if(n&&++o%100==0&&!n())return oe.INSTANCE;const u=re.Vr.findPrevBracketInRange(r,t,i,a,l);if(!u)break;const h=i.substring(u.startColumn-1,u.endColumn-1).toLowerCase();if(e.isOpen(h)?s++:e.isClose(h)&&s--,0===s)return u;l=u.startColumn-1}return null};for(let e=t.lineNumber;e>=1;e--){const n=this.textModel.getLineTokens(e),r=n.getCount(),s=this.textModel.getLineContent(e);let o=r-1,l=s.length,u=s.length;e===t.lineNumber&&(o=n.findTokenIndexAtOffset(t.column-1),l=t.column-1,u=t.column-1);let h=!0;for(;o>=0;o--){const t=n.getLanguageId(o)===i&&!(0,ie.Bu)(n.getStandardTokenType(o));if(t)h?l=n.getStartOffset(o):(l=n.getStartOffset(o),u=n.getEndOffset(o));else if(h&&l!==u){const t=a(e,s,l,u);if(t)return t}h=t}if(h&&l!==u){const t=a(e,s,l,u);if(t)return t}}return null}_findMatchingBracketDown(e,t,n){const i=e.languageId,r=e.forwardRegex;let s=1,o=0;const a=(t,i,a,l)=>{for(;;){if(n&&++o%100==0&&!n())return oe.INSTANCE;const u=re.Vr.findNextBracketInRange(r,t,i,a,l);if(!u)break;const h=i.substring(u.startColumn-1,u.endColumn-1).toLowerCase();if(e.isOpen(h)?s++:e.isClose(h)&&s--,0===s)return u;a=u.endColumn-1}return null},l=this.textModel.getLineCount();for(let e=t.lineNumber;e<=l;e++){const n=this.textModel.getLineTokens(e),r=n.getCount(),s=this.textModel.getLineContent(e);let o=0,l=0,u=0;e===t.lineNumber&&(o=n.findTokenIndexAtOffset(t.column-1),l=t.column-1,u=t.column-1);let h=!0;for(;o<r;o++){const t=n.getLanguageId(o)===i&&!(0,ie.Bu)(n.getStandardTokenType(o));if(t)h||(l=n.getStartOffset(o)),u=n.getEndOffset(o);else if(h&&l!==u){const t=a(e,s,l,u);if(t)return t}h=t}if(h&&l!==u){const t=a(e,s,l,u);if(t)return t}}return null}findPrevBracket(e){const t=this.textModel.validatePosition(e);let n=null,i=null;for(let e=t.lineNumber;e>=1;e--){const r=this.textModel.getLineTokens(e),s=r.getCount(),o=this.textModel.getLineContent(e);let a=s-1,l=o.length,u=o.length;if(e===t.lineNumber){a=r.findTokenIndexAtOffset(t.column-1),l=t.column-1,u=t.column-1;const e=r.getLanguageId(a);n!==e&&(n=e,i=this.languageConfigurationService.getLanguageConfiguration(n).brackets)}let h=!0;for(;a>=0;a--){const t=r.getLanguageId(a);if(n!==t){if(i&&h&&l!==u){const t=re.Vr.findPrevBracketInRange(i.reversedRegex,e,o,l,u);if(t)return this._toFoundBracket(i,t);h=!1}n=t,i=this.languageConfigurationService.getLanguageConfiguration(n).brackets}const s=!!i&&!(0,ie.Bu)(r.getStandardTokenType(a));if(s)h?l=r.getStartOffset(a):(l=r.getStartOffset(a),u=r.getEndOffset(a));else if(i&&h&&l!==u){const t=re.Vr.findPrevBracketInRange(i.reversedRegex,e,o,l,u);if(t)return this._toFoundBracket(i,t)}h=s}if(i&&h&&l!==u){const t=re.Vr.findPrevBracketInRange(i.reversedRegex,e,o,l,u);if(t)return this._toFoundBracket(i,t)}}return null}findNextBracket(e){const t=this.textModel.validatePosition(e),n=this.textModel.getLineCount();let i=null,r=null;for(let e=t.lineNumber;e<=n;e++){const n=this.textModel.getLineTokens(e),s=n.getCount(),o=this.textModel.getLineContent(e);let a=0,l=0,u=0;if(e===t.lineNumber){a=n.findTokenIndexAtOffset(t.column-1),l=t.column-1,u=t.column-1;const e=n.getLanguageId(a);i!==e&&(i=e,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets)}let h=!0;for(;a<s;a++){const t=n.getLanguageId(a);if(i!==t){if(r&&h&&l!==u){const t=re.Vr.findNextBracketInRange(r.forwardRegex,e,o,l,u);if(t)return this._toFoundBracket(r,t);h=!1}i=t,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets}const s=!!r&&!(0,ie.Bu)(n.getStandardTokenType(a));if(s)h||(l=n.getStartOffset(a)),u=n.getEndOffset(a);else if(r&&h&&l!==u){const t=re.Vr.findNextBracketInRange(r.forwardRegex,e,o,l,u);if(t)return this._toFoundBracket(r,t)}h=s}if(r&&h&&l!==u){const t=re.Vr.findNextBracketInRange(r.forwardRegex,e,o,l,u);if(t)return this._toFoundBracket(r,t)}}return null}findEnclosingBrackets(e,t){let n;if(void 0===t)n=null;else{const e=Date.now();n=()=>Date.now()-e<=t}const i=this.textModel.validatePosition(e),r=this.textModel.getLineCount(),s=new Map;let o=[];const a=(e,t)=>{if(!s.has(e)){let n=[];for(let e=0,i=t?t.brackets.length:0;e<i;e++)n[e]=0;s.set(e,n)}o=s.get(e)};let l=0;const u=(e,t,i,r,s)=>{for(;;){if(n&&++l%100==0&&!n())return oe.INSTANCE;const a=re.Vr.findNextBracketInRange(e.forwardRegex,t,i,r,s);if(!a)break;const u=i.substring(a.startColumn-1,a.endColumn-1).toLowerCase(),h=e.textIsBracket[u];if(h&&(h.isOpen(u)?o[h.index]++:h.isClose(u)&&o[h.index]--,-1===o[h.index]))return this._matchFoundBracket(a,h,!1,n);r=a.endColumn-1}return null};let h=null,c=null;for(let e=i.lineNumber;e<=r;e++){const t=this.textModel.getLineTokens(e),n=t.getCount(),r=this.textModel.getLineContent(e);let s=0,o=0,l=0;if(e===i.lineNumber){s=t.findTokenIndexAtOffset(i.column-1),o=i.column-1,l=i.column-1;const e=t.getLanguageId(s);h!==e&&(h=e,c=this.languageConfigurationService.getLanguageConfiguration(h).brackets,a(h,c))}let d=!0;for(;s<n;s++){const n=t.getLanguageId(s);if(h!==n){if(c&&d&&o!==l){const t=u(c,e,r,o,l);if(t)return ae(t);d=!1}h=n,c=this.languageConfigurationService.getLanguageConfiguration(h).brackets,a(h,c)}const i=!!c&&!(0,ie.Bu)(t.getStandardTokenType(s));if(i)d||(o=t.getStartOffset(s)),l=t.getEndOffset(s);else if(c&&d&&o!==l){const t=u(c,e,r,o,l);if(t)return ae(t)}d=i}if(c&&d&&o!==l){const t=u(c,e,r,o,l);if(t)return ae(t)}}return null}_toFoundBracket(e,t){if(!t)return null;let n=this.textModel.getValueInRange(t);n=n.toLowerCase();let i=e.textIsBracket[n];return i?{range:t,open:i.open,close:i.close,isOpen:e.textIsOpenBracket[n]}:null}}class oe{constructor(){this._searchCanceledBrand=void 0}}function ae(e){return e instanceof oe?null:e}oe.INSTANCE=new oe},62490:(e,t,n)=>{n.d(t,{z:()=>l});var i=n(4669),r=n(9917),s=n(24314),o=n(27869),a=n(97781);class l extends r.JT{constructor(e){super(),this.textModel=e,this.colorProvider=new u,this.onDidChangeEmitter=new i.Q5,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.onDidChangeOptions(t=>{this.colorizationOptions=e.getOptions().bracketPairColorizationOptions})),this._register(e.bracketPairs.onDidChange(e=>{this.onDidChangeEmitter.fire()}))}getDecorationsInRange(e,t,n){if(void 0===t)return[];if(!this.colorizationOptions.enabled)return[];const i=new Array,r=this.textModel.bracketPairs.getBracketsInRange(e);for(const e of r)i.push({id:`bracket${e.range.toString()}-${e.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(e)},ownerId:0,range:e.range});return i}getAllDecorations(e,t){return void 0===e?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new s.e(1,1,this.textModel.getLineCount(),1),e,t):[]}}class u{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e.nestingLevel)}getInlineClassNameOfLevel(e){return"bracket-highlighting-"+e%30}}(0,a.Ic)((e,t)=>{const n=[o.zJ,o.Vs,o.CE,o.UP,o.r0,o.m1],i=new u;t.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${e.getColor(o.ts)}; }`);let r=n.map(t=>e.getColor(t)).filter(e=>!!e).filter(e=>!e.isTransparent());for(let e=0;e<30;e++){const n=r[e%r.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(e)} { color: ${n}; }`)}})},95215:(e,t,n)=>{n.d(t,{NL:()=>f,e9:()=>g});var i=n(63580),r=n(17301),s=n(3860),o=n(70666),a=n(60962),l=n(53060),u=n(95935);function h(e){return e.toString()}class c{constructor(e,t,n,i,r,s,o){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=n,this.afterEOL=i,this.beforeCursorState=r,this.afterCursorState=s,this.changes=o}static create(e,t){const n=e.getAlternativeVersionId(),i=m(e);return new c(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=(0,a.b)(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,n){if(l.T4(e,t?t.length:0,n),n+=4,t)for(const i of t)l.T4(e,i.selectionStartLineNumber,n),n+=4,l.T4(e,i.selectionStartColumn,n),n+=4,l.T4(e,i.positionLineNumber,n),n+=4,l.T4(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){const i=l.Ag(e,t);t+=4;for(let r=0;r<i;r++){const i=l.Ag(e,t);t+=4;const r=l.Ag(e,t);t+=4;const o=l.Ag(e,t);t+=4;const a=l.Ag(e,t);t+=4,n.push(new s.Y(i,r,o,a))}return t}serialize(){let e=10+c._writeSelectionsSize(this.beforeCursorState)+c._writeSelectionsSize(this.afterCursorState)+4;for(const t of this.changes)e+=t.writeSize();const t=new Uint8Array(e);let n=0;l.T4(t,this.beforeVersionId,n),n+=4,l.T4(t,this.afterVersionId,n),n+=4,l.Cg(t,this.beforeEOL,n),n+=1,l.Cg(t,this.afterEOL,n),n+=1,n=c._writeSelections(t,this.beforeCursorState,n),n=c._writeSelections(t,this.afterCursorState,n),l.T4(t,this.changes.length,n),n+=4;for(const e of this.changes)n=e.write(t,n);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let n=0;const i=l.Ag(t,n);n+=4;const r=l.Ag(t,n);n+=4;const s=l.Q$(t,n);n+=1;const o=l.Q$(t,n);n+=1;const u=[];n=c._readSelections(t,n,u);const h=[];n=c._readSelections(t,n,h);const d=l.Ag(t,n);n+=4;const m=[];for(let e=0;e<d;e++)n=a.q.read(t,n,m);return new c(i,r,s,o,u,h,m)}}class d{constructor(e,t){this.model=e,this._data=c.create(e,t)}get type(){return 0}get resource(){return o.o.isUri(this.model)?this.model:this.model.uri}get label(){return i.N("edit","Typing")}toString(){return(this._data instanceof c?this._data:c.deserialize(this._data)).changes.map(e=>e.toString()).join(", ")}matchesResource(e){return(o.o.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof c}append(e,t,n,i,r){this._data instanceof c&&this._data.append(e,t,n,i,r)}close(){this._data instanceof c&&(this._data=this._data.serialize())}open(){this._data instanceof c||(this._data=c.deserialize(this._data))}undo(){if(o.o.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof c&&(this._data=this._data.serialize());const e=c.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(o.o.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof c&&(this._data=this._data.serialize());const e=c.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof c&&(this._data=this._data.serialize()),this._data.byteLength+168}}function m(e){return"\n"===e.getEOL()?0:1}function g(e){return!!e&&(e instanceof d||e instanceof class{constructor(e,t){this.type=1,this.label=e,this._isOpen=!0,this._editStackElementsArr=t.slice(0),this._editStackElementsMap=new Map;for(const e of this._editStackElementsArr){const t=h(e.resource);this._editStackElementsMap.set(t,e)}this._delegate=null}get resources(){return this._editStackElementsArr.map(e=>e.resource)}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=h(e);return this._editStackElementsMap.has(t)}setModel(e){const t=h(o.o.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=h(e.uri);if(this._editStackElementsMap.has(t)){return this._editStackElementsMap.get(t).canAppend(e)}return!1}append(e,t,n,i,r){const s=h(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=h(e);if(this._editStackElementsMap.has(t)){return this._editStackElementsMap.get(t).heapSize()}return 0}split(){return this._editStackElementsArr}toString(){let e=[];for(const t of this._editStackElementsArr)e.push(`${(0,u.EZ)(t.resource)}: ${t}`);return`{${e.join(", ")}}`}})}class f{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);g(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);g(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e){const t=this._undoRedoService.getLastElement(this._model.uri);if(g(t)&&t.canAppend(this._model))return t;const n=new d(this._model,e);return this._undoRedoService.pushElement(n),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null);this._model.setEOL(e),t.append(this._model,[],m(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n){const i=this._getOrCreateEditStackElement(e),r=this._model.applyEdits(t,!0),s=f._computeCursorState(n,r),o=r.map((e,t)=>({index:t,textChange:e.textChange}));return o.sort((e,t)=>e.textChange.oldPosition===t.textChange.oldPosition?e.index-t.index:e.textChange.oldPosition-t.textChange.oldPosition),i.append(this._model,o.map(e=>e.textChange),m(this._model),this._model.getAlternativeVersionId(),s),s}static _computeCursorState(e,t){try{return e?e(t):null}catch(e){return(0,r.dL)(e),null}}}},13434:(e,t,n)=>{n.d(t,{L:()=>s});class i{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function r(e,t,n,i,r){let s;for(r.spacesDiff=0,r.looksLikeAlignment=!1,s=0;s<t&&s<i;s++){if(e.charCodeAt(s)!==n.charCodeAt(s))break}let o=0,a=0;for(let n=s;n<t;n++){32===e.charCodeAt(n)?o++:a++}let l=0,u=0;for(let e=s;e<i;e++){32===n.charCodeAt(e)?l++:u++}if(o>0&&a>0)return;if(l>0&&u>0)return;let h=Math.abs(a-u),c=Math.abs(o-l);if(0===h)return r.spacesDiff=c,void(c>0&&0<=l-1&&l-1<e.length&&l<n.length&&32!==n.charCodeAt(l)&&32===e.charCodeAt(l-1)&&44===e.charCodeAt(e.length-1)&&(r.looksLikeAlignment=!0));c%h!=0||(r.spacesDiff=c/h)}function s(e,t,n){const s=Math.min(e.getLineCount(),1e4);let o=0,a=0,l="",u=0;const h=[2,4,6,8,3,5,7];let c=[0,0,0,0,0,0,0,0,0],d=new i;for(let i=1;i<=s;i++){let s=e.getLineLength(i),h=e.getLineContent(i);const m=s<=65536;let g=!1,f=0,p=0,C=0;for(let t=0,n=s;t<n;t++){let n=m?h.charCodeAt(t):e.getLineCharCode(i,t);if(9===n)C++;else{if(32!==n){g=!0,f=t;break}p++}}if(!g)continue;if(C>0?o++:p>1&&a++,r(l,u,h,f,d),d.looksLikeAlignment&&(!n||t!==d.spacesDiff))continue;let b=d.spacesDiff;b<=8&&c[b]++,l=h,u=f}let m=n;o!==a&&(m=o<a);let g=t;if(m){let e=m?0:.1*s;h.forEach(t=>{let n=c[t];n>e&&(e=n,g=t)}),4===g&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(g=2)}return{insertSpaces:m,tabSize:g}}},43465:(e,t,n)=>{function i(e){return(1&e.metadata)>>>0}function r(e,t){e.metadata=254&e.metadata|t<<0}function s(e){return(2&e.metadata)>>>1==1}function o(e,t){e.metadata=253&e.metadata|(t?1:0)<<1}function a(e){return(4&e.metadata)>>>2==1}function l(e,t){e.metadata=251&e.metadata|(t?1:0)<<2}function u(e,t){e.metadata=231&e.metadata|t<<3}function h(e,t){e.metadata=223&e.metadata|(t?1:0)<<5}n.d(t,{IF:()=>m,fL:()=>c,sR:()=>w});class c{constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,r(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,l(this,!1),u(this,1),h(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,o(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;l(this,"squiggly-error"===t||"squiggly-warning"===t||"squiggly-info"===t),u(this,this.options.stickiness),h(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const d=new c(null,0,0);d.parent=d,d.left=d,d.right=d,r(d,0);class m{constructor(){this.root=d,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r){return this.root===d?[]:function(e,t,n,i,r,l){let u=e.root,h=0,c=0,m=0,g=0,f=[],p=0;for(;u!==d;)if(s(u))o(u.left,!1),o(u.right,!1),u===u.parent.right&&(h-=u.parent.delta),u=u.parent;else{if(!s(u.left)){if(c=h+u.maxEnd,c<t){o(u,!0);continue}if(u.left!==d){u=u.left;continue}}if(m=h+u.start,m>n)o(u,!0);else{if(g=h+u.end,g>=t){u.setCachedOffsets(m,g,l);let e=!0;i&&u.ownerId&&u.ownerId!==i&&(e=!1),r&&a(u)&&(e=!1),e&&(f[p++]=u)}o(u,!0),u.right===d||s(u.right)||(h+=u.delta,u=u.right)}}return o(e.root,!1),f}(this,e,t,n,i,r)}search(e,t,n){return this.root===d?[]:function(e,t,n,i){let r=e.root,l=0,u=0,h=0,c=[],m=0;for(;r!==d;){if(s(r)){o(r.left,!1),o(r.right,!1),r===r.parent.right&&(l-=r.parent.delta),r=r.parent;continue}if(r.left!==d&&!s(r.left)){r=r.left;continue}u=l+r.start,h=l+r.end,r.setCachedOffsets(u,h,i);let e=!0;t&&r.ownerId&&r.ownerId!==t&&(e=!1),n&&a(r)&&(e=!1),e&&(c[m++]=r),o(r,!0),r.right===d||s(r.right)||(l+=r.delta,r=r.right)}return o(e.root,!1),c}(this,e,t,n)}collectNodesFromOwner(e){return function(e,t){let n=e.root,i=[],r=0;for(;n!==d;)s(n)?(o(n.left,!1),o(n.right,!1),n=n.parent):n.left===d||s(n.left)?(n.ownerId===t&&(i[r++]=n),o(n,!0),n.right===d||s(n.right)||(n=n.right)):n=n.left;return o(e.root,!1),i}(this,e)}collectNodesPostOrder(){return function(e){let t=e.root,n=[],i=0;for(;t!==d;)s(t)?(o(t.left,!1),o(t.right,!1),t=t.parent):t.left===d||s(t.left)?t.right===d||s(t.right)?(n[i++]=t,o(t,!0)):t=t.right:t=t.left;return o(e.root,!1),n}(this)}insert(e){p(this,e),this._normalizeDeltaIfNecessary()}delete(e){C(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const n=e;let i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;const r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){const r=function(e,t,n){let i=e.root,r=0,a=0,l=0,u=0,h=[],c=0;for(;i!==d;)if(s(i))o(i.left,!1),o(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),i=i.parent;else{if(!s(i.left)){if(a=r+i.maxEnd,a<t){o(i,!0);continue}if(i.left!==d){i=i.left;continue}}l=r+i.start,l>n?o(i,!0):(u=r+i.end,u>=t&&(i.setCachedOffsets(l,u,0),h[c++]=i),o(i,!0),i.right===d||s(i.right)||(r+=i.delta,i=i.right))}return o(e.root,!1),h}(this,e,e+t);for(let e=0,t=r.length;e<t;e++){C(this,r[e])}this._normalizeDeltaIfNecessary(),function(e,t,n,i){let r=e.root,a=0,l=0,u=0;const h=i-(n-t);for(;r!==d;)if(s(r))o(r.left,!1),o(r.right,!1),r===r.parent.right&&(a-=r.parent.delta),w(r),r=r.parent;else{if(!s(r.left)){if(l=a+r.maxEnd,l<t){o(r,!0);continue}if(r.left!==d){r=r.left;continue}}u=a+r.start,u>n?(r.start+=h,r.end+=h,r.delta+=h,(r.delta<-1073741824||r.delta>1073741824)&&(e.requestNormalizeDelta=!0),o(r,!0)):(o(r,!0),r.right===d||s(r.right)||(a+=r.delta,r=r.right))}o(e.root,!1)}(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,o=r.length;s<o;s++){const o=r[s];o.start=o.cachedAbsoluteStart,o.end=o.cachedAbsoluteEnd,f(o,e,e+t,n,i),o.maxEnd=o.end,p(this,o)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,function(e){let t=e.root,n=0;for(;t!==d;)t.left===d||s(t.left)?t.right===d||s(t.right)?(t.start=n+t.start,t.end=n+t.end,t.delta=0,w(t),o(t,!0),o(t.left,!1),o(t.right,!1),t===t.parent.right&&(n-=t.parent.delta),t=t.parent):(n+=t.delta,t=t.right):t=t.left;o(e.root,!1)}(this))}}function g(e,t,n,i){return e<n||!(e>n)&&(1!==i&&(2===i||t))}function f(e,t,n,i,r){const s=function(e){return(24&e.metadata)>>>3}(e),o=0===s||2===s,a=1===s||2===s,l=n-t,u=i,h=Math.min(l,u),c=e.start;let d=!1;const m=e.end;let f=!1;t<=c&&m<=n&&function(e){return(32&e.metadata)>>>5==1}(e)&&(e.start=t,d=!0,e.end=t,f=!0);{const e=r?1:l>0?2:0;!d&&g(c,o,t,e)&&(d=!0),!f&&g(m,a,t,e)&&(f=!0)}if(h>0&&!r){const e=l>u?2:0;!d&&g(c,o,t+h,e)&&(d=!0),!f&&g(m,a,t+h,e)&&(f=!0)}{const i=r?1:0;!d&&g(c,o,n,i)&&(e.start=t+u,d=!0),!f&&g(m,a,n,i)&&(e.end=t+u,f=!0)}const p=u-l;d||(e.start=Math.max(0,c+p)),f||(e.end=Math.max(0,m+p)),e.start>e.end&&(e.end=e.start)}function p(e,t){if(e.root===d)return t.parent=d,t.left=d,t.right=d,r(t,0),e.root=t,e.root;!function(e,t){let n=0,i=e.root;const s=t.start,o=t.end;for(;;){if(v(s,o,i.start+n,i.end+n)<0){if(i.left===d){t.start-=n,t.end-=n,t.maxEnd-=n,i.left=t;break}i=i.left}else{if(i.right===d){t.start-=n+i.delta,t.end-=n+i.delta,t.maxEnd-=n+i.delta,i.right=t;break}n+=i.delta,i=i.right}}t.parent=i,t.left=d,t.right=d,r(t,1)}(e,t),N(t.parent);let n=t;for(;n!==e.root&&1===i(n.parent);)if(n.parent===n.parent.parent.left){const t=n.parent.parent.right;1===i(t)?(r(n.parent,0),r(t,0),r(n.parent.parent,1),n=n.parent.parent):(n===n.parent.right&&(n=n.parent,L(e,n)),r(n.parent,0),r(n.parent.parent,1),S(e,n.parent.parent))}else{const t=n.parent.parent.left;1===i(t)?(r(n.parent,0),r(t,0),r(n.parent.parent,1),n=n.parent.parent):(n===n.parent.left&&(n=n.parent,S(e,n)),r(n.parent,0),r(n.parent.parent,1),L(e,n.parent.parent))}return r(e.root,0),t}function C(e,t){let n,s;if(t.left===d?(n=t.right,s=t,n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta):t.right===d?(n=t.left,s=t):(s=function(e){for(;e.left!==d;)e=e.left;return e}(t.right),n=s.right,n.start+=s.delta,n.end+=s.delta,n.delta+=s.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),s.start+=t.delta,s.end+=t.delta,s.delta=t.delta,(s.delta<-1073741824||s.delta>1073741824)&&(e.requestNormalizeDelta=!0)),s===e.root)return e.root=n,r(n,0),t.detach(),b(),w(n),void(e.root.parent=d);let o,a=1===i(s);if(s===s.parent.left?s.parent.left=n:s.parent.right=n,s===t?n.parent=s.parent:(s.parent===t?n.parent=s:n.parent=s.parent,s.left=t.left,s.right=t.right,s.parent=t.parent,r(s,i(t)),t===e.root?e.root=s:t===t.parent.left?t.parent.left=s:t.parent.right=s,s.left!==d&&(s.left.parent=s),s.right!==d&&(s.right.parent=s)),t.detach(),a)return N(n.parent),s!==t&&(N(s),N(s.parent)),void b();for(N(n),N(n.parent),s!==t&&(N(s),N(s.parent));n!==e.root&&0===i(n);)n===n.parent.left?(o=n.parent.right,1===i(o)&&(r(o,0),r(n.parent,1),L(e,n.parent),o=n.parent.right),0===i(o.left)&&0===i(o.right)?(r(o,1),n=n.parent):(0===i(o.right)&&(r(o.left,0),r(o,1),S(e,o),o=n.parent.right),r(o,i(n.parent)),r(n.parent,0),r(o.right,0),L(e,n.parent),n=e.root)):(o=n.parent.left,1===i(o)&&(r(o,0),r(n.parent,1),S(e,n.parent),o=n.parent.left),0===i(o.left)&&0===i(o.right)?(r(o,1),n=n.parent):(0===i(o.left)&&(r(o.right,0),r(o,1),L(e,o),o=n.parent.left),r(o,i(n.parent)),r(n.parent,0),r(o.left,0),S(e,n.parent),n=e.root));r(n,0),b()}function b(){d.parent=d,d.delta=0,d.start=0,d.end=0}function L(e,t){const n=t.right;n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta,t.right=n.left,n.left!==d&&(n.left.parent=t),n.parent=t.parent,t.parent===d?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n,w(t),w(n)}function S(e,t){const n=t.left;t.delta-=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(e.requestNormalizeDelta=!0),t.start-=n.delta,t.end-=n.delta,t.left=n.right,n.right!==d&&(n.right.parent=t),n.parent=t.parent,t.parent===d?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n,w(t),w(n)}function _(e){let t=e.end;if(e.left!==d){const n=e.left.maxEnd;n>t&&(t=n)}if(e.right!==d){const n=e.right.maxEnd+e.delta;n>t&&(t=n)}return t}function w(e){e.maxEnd=_(e)}function N(e){for(;e!==d;){const t=_(e);if(e.maxEnd===t)return;e.maxEnd=t,e=e.parent}}function v(e,t,n,i){return e===n?t-i:e-n}}}]);