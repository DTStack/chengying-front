"use strict";(self.webpackChunkdt_em_front=self.webpackChunkdt_em_front||[]).push([[2348],{4482:(e,t,n)=>{n.r(t),n.d(t,{addIpToConfig:()=>_,cancelDeploy:()=>P,forceStop:()=>b,forceUninstall:()=>L,getCurrentUnDepolyList:()=>D,getDeployList:()=>C,getIsFirstSmooth:()=>u,getServiceIpList:()=>v,getUnDeployLog:()=>U,getUnDepolyList:()=>T,getUndeploy:()=>x,getUpgradeType:()=>c,handleSetServiceIp:()=>g,modifyConfigConfig:()=>f,modifyInstanceConfig:()=>p,modifyIpConfig:()=>y,modifyServiceConfig:()=>m,modifyServiceInput:()=>d,resetDeployStatus:()=>Z,resetServiceConfig:()=>h,returnToStepOne:()=>I,saveForcedUpgrade:()=>s,startProductDeploy:()=>S,startUnDeployService:()=>k,switchUseCloudByProduct:()=>N,updateIpsByService:()=>E,updateProductConfig:()=>i});var a=n(45360),r=n(56466),o=n(19528),l=n(64143),i=function(e){return function(t){o.aJ.getProductConfig({productName:e.product_name,productVersion:e.product_version}).then((function(e){0===(e=e.data).code?t({type:r.Eo.UPDATE_PRD_CONFIG,payload:e.data.list[0]}):a.Z.error(e.msg)}))}},s=function(e){return{type:r.Eo.SAVE_FORCED_UPGRADE,payload:e}},c=function(e){return{type:r.Eo.UPGRADE_TYPE,payload:e}},u=function(e){return{type:r.Eo.GET_FIRST_SMOOTH,payload:e}},d=function(e){return 0===e.type?{type:r.Eo.MODIFY_INSTANCE_CONFIG,payload:e}:{type:r.Eo.MODIFY_CONFIG_CONFIG,payload:e}},p=function(e){return{type:r.Eo.MODIFY_INSTANCE_CONFIG,payload:e}},f=function(e){return{type:r.Eo.MODIFY_CONFIG_CONFIG,payload:e}},m=function(e){return function(t){o.aJ.motifyServiceConfig({productName:e.product_name,serviceName:e.service_name},{field_path:e.field_path,field:e.field}).then((function(n){0===(n=n.data).code?(n.data&&a.Z.warning(n.data),t(i(e))):a.Z.error(n.msg)}))}},h=function(e){var t=e.service_name;return function(n){o.aJ.resetSchemaField({productName:e.product_name,serviceName:e.service_name},{field_path:e.field_path,product_version:e.product_version}).then((function(l){0===(l=l.data).code?o.aJ.getProductConfig({productName:e.product_name,productVersion:e.product_version}).then((function(l){0===(l=l.data).code?(n({type:r.Eo.UPDATE_PRD_CONFIG,payload:l.data.list[0]}),o.aJ.getIp({productName:e.product_name,serviceName:e.service_name}).then((function(e){0===(e=e.data).code?n({type:r.Eo.GET_SERVICE_IPS,payload:{service_name:t,ips:e.data.ip}}):a.Z.error(e.msg)}))):a.Z.error(l.msg)})):a.Z.error(l.msg)}))}},v=function(e){var t=e.service_name;return function(n){o.aJ.getIp({productName:e.product_name,serviceName:e.service_name}).then((function(e){0===(e=e.data).code?n({type:r.Eo.GET_SERVICE_IPS,payload:{service_name:t,ips:e.data.ip||[]}}):a.Z.error(e.msg)}))}},y=function(e,t,n){return{type:r.Eo.UPDATE_IP_CONFIG,payload:{pindex:e,index:t,ip:n}}},g=function(e){return function(t){o.aJ.setIp({serviceName:e.service_name,productName:e.product_name},{ip:e.ip}).then((function(n){0===(n=n.data).code?(t({type:r.Eo.GET_SERVICE_IPS,payload:{service_name:e.service_name,ips:e.ip?e.ip.split(","):[]}}),t(i(e))):a.Z.error(n.msg)}))}},_=function(e){return{type:r.Eo.ADD_IP_TO_CONFIG,payload:{pindex:e}}},E=function(e,t){return{type:r.Eo.UPDATE_IP_BY_SERVICE,payload:{service:e,ips:t}}},S=function(e,t){return function(n){o.aJ.deploy({productName:e.product_name,productVersion:e.product_version}).then((function(e){0===(e=e.data).code?(n({type:r.Eo.START_PRD_DEPLOY,payload:{deploy_uuid:e.data.deploy_uuid,deploy_status:!0}}),t()):a.Z.error(e.msg)}))}},I=function(){return{type:r.Eo.RETURN_TO_CONFIG}},C=function(e,t){return function(n){o.aJ.getProductConfig({productName:e.product_name,productVersion:e.product_version}).then((function(l){0===(l=l.data).code?(n({type:r.Eo.UPDATE_DEPLOY_STATUS,payload:l.data.list[0].status}),o.aJ.getDeployList({deployUuid:e.deploy_uuid}).then((function(e){if(0===e.code)return n({type:r.Eo.UPDATE_DEPLOY_LIST,payload:{list:e.data.list,complete:e.data.complete}});a.Z.error(e.msg)})),"deploying"!==l.data.list[0].status&&t(l)):a.Z.error(l.msg)}))}},Z=function(){return{type:r.Eo.RESET_DEPLOY_STATUS}},N=function(e){return{type:r.Eo.SWITH_USE_CLOUD,payload:e}},P=function(e){return function(t){o.aJ.cancelDeploy({productName:e.product_name,productVersion:e.product_version}).then((function(e){0===(e=e.data).code?a.Z.success("已停止部署！"):a.Z.error(e.msg)}))}},k=function(e){return function(t){o.aJ.unDeployService({productName:e.product_name,productVersion:e.product_version},{clusterId:e.clusterId,namespace:e.namespace}).then((function(e){var n=e.data;0===n.code?t({type:r.l2.START_UNDEPLOY,payload:{deploy_uuid:n.data.deploy_uuid,autoRefresh:!0}}):a.Z.error(n.msg)}))}},x=function(e){var t=e.deploy_uuid,n=e.autoRefresh,a=e.complete;return{type:r.l2.START_UNDEPLOY,payload:{deploy_uuid:t,autoRefresh:n,complete:a}}},T=function(e){return function(t){o.aJ.getUnDeployList({deployUuid:e.deployUuid,start:e.start,status:e.status,limit:e.limit}).then((function(e){if(0===e.data.code){var n=e.data.data.count-e.data.data.list&&e.data.data.list.length;t({type:r.l2.UPDATE_UNDEPLOY_LIST,payload:{unDeployList:e.data.data.list||[],complete:e.data.data.complete,start:n,count:e.data.data.count}})}else a.Z.error(e.data.msg)}))}},D=function(e){return function(t){o.aJ.getUnDeployList({deployUuid:e.deployUuid,start:e.start,status:e.status,limit:e.limit}).then((function(e){0===e.data.code?t({type:r.l2.UPDATE_CURRENT_UNDEPLOY_LIST,payload:{unDeployList:e.data.data.list||[],complete:e.data.data.complete,count:e.data.data.count}}):a.Z.error(e.data.msg)}))}},b=function(e,t){return function(n){o.aJ.forceStop(e).then((function(e){l.Z.serviceCallback(e,"强制卸载成功！",t)}))}},L=function(e,t){return function(n){o.aJ.forceUninstall(e).then((function(e){l.Z.serviceCallback(e,"强制卸载成功！",t)}))}},U=function(e){return function(t){o.aJ.getUnDeployLog(e).then((function(e){0===e.code?t({type:r.l2.GET_UNDEPLOY_LOG,payload:{unDeployLog:e.data||""}}):a.Z.error(e.msg)}))}}},12903:(e,t,n)=>{n.r(t),n.d(t,{getClusterList:()=>K,getClusterProductList:()=>w,getInstanceList:()=>F,getParentProductList:()=>R,getProductList:()=>O,getServiceGroupList:()=>M,setCurrentParentCluster:()=>G,setCurrentParentProduct:()=>B,setCurrentProduct:()=>A});var a=n(94198),r=n.n(a),o=n(78914),l=n.n(o),i=n(86902),s=n.n(i),c=n(94473),u=n.n(c),d=n(33032),p=n.n(d),f=n(51942),m=n.n(f),h=n(3649),v=n.n(h),y=n(66419),g=n.n(y),_=n(65420),E=n.n(_),S=n(19996),I=n.n(S),C=n(41511),Z=n.n(C),N=n(45360),P=n(19528),k=n(56466),x=n(78241),T=n(36808),D=n(18274),b=n(64143);function L(e,t){var n=void 0!==E()&&I()(e)||e["@@iterator"];if(!n){if(Z()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return U(e,t);var a=v()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return g()(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var R=function(e){return function(t){P.t6.getParentProductList({limit:0}).then((function(n){if(0===(n=n.data).code){var a={name:n.data[0],list:n.dsta},o=-1;if(e){for(var l in n.data)n.data[l]===e&&(o=r()(l,10));a.name=o>-1?n.data[o]:n.data[0]}T.set("em_current_parent_product",a.name),t({type:k.kP.GET_PARENT_PROD_LIST,payload:a})}}))}},w=function(){return function(e){P.t6.getClusterProductList({limit:0}).then((function(t){if(0===(t=t.data).code){var n,a,r,o,i,c,d,f=T.get("em_current_parent_product")||"DTinsight",h=T.get("em_current_cluster_id"),v={};if(h){var y,g,_=u()(y=t.data).call(y,(function(e){return+e.clusterId==+h}));if(v=_||t.data[0],!_&&"kubernetes"===(null===(g=v)||void 0===g?void 0:g.clusterType)){var E=N.Z.loading("正在跳转默认集群...",0);p()(E,2500),b.Z.setNaviKey("menu_ops_center","sub_menu_service"),window.location.href="/opscenter/service"}}else v=t.data[0];var S,I,C,Z=function(e,t,n){if(0===n)return T.set(D.E9.NAMESPACE,""),e||t[0];var a,r=!1;if(l()(a=s()(t)).call(a,(function(n){var a;l()(a=t[n]||[]).call(a,(function(t){r||t!==e||T.get(D.E9.NAMESPACE)||(r=!0,T.set(D.E9.NAMESPACE,n))}))})),r||T.get(D.E9.NAMESPACE))return e;var o=s()(t)[0];return T.set(D.E9.NAMESPACE,o),t[s()(t)[0]][0]}(f,(null===(n=v)||void 0===n?void 0:n.subdomain)||{},null===(a=v)||void 0===a?void 0:a.mode);if(null!==(r=v)&&void 0!==r&&r.clusterId)if(T.set("em_current_cluster_id",(null===(S=v)||void 0===S?void 0:S.clusterId)||-1),T.set("em_current_cluster_type",null===(I=v)||void 0===I?void 0:I.clusterType),T.set("em_current_parent_product",Z),"kubernetes"===(null===(C=v)||void 0===C?void 0:C.clusterType)){var P,x=s()(null===(P=v)||void 0===P?void 0:P.subdomain);T.set("em_current_k8s_namespace",x[0])}e({type:k.kP.GET_PARENT_PROD_LIST,payload:m()({},{name:Z||"选择产品",list:t.data,cluster:{id:(null===(o=v)||void 0===o?void 0:o.clusterId)||-1,name:(null===(i=v)||void 0===i?void 0:i.clusterName)||"选择集群",type:(null===(c=v)||void 0===c?void 0:c.clusterType)||"hosts",mode:(null===(d=v)||void 0===d?void 0:d.mode)||0}})})}}))}},O=function(){return function(e){x.get("/api/v2/product",{limit:0}).then((function(t){var n=[];if(0===(t=t.data).code){var a,r=L(t.data.list);try{for(r.s();!(a=r.n()).done;){var o=a.value;1===o.is_current_version&&n.push(o)}}catch(e){r.e(e)}finally{r.f()}e({type:k.kP.SET_PRODUCT_LIST,payload:n})}else N.Z.error(t.msg)}))}},A=function(e){return{type:k.kP.SET_CUR_PRODUCT,payload:e}},B=function(e){return{type:k.kP.SET_CUR_PARENT_PROD,payload:e}},M=function(){return function(e){x.get("/api/container/getCluster",{}).then((function(t){for(var n=(t=t.data).result.data||[],a=0,r=n.length;a<r;a++){for(var o=n[a].services,l=[],i=0,s=o.length;i<s;i++){var c=o[i],u=c.name.toLowerCase();"rabbitmq"!==u&&"mysql"!==u&&l.push(c)}n[a].services=l}e({type:k.kP.GET_S_G_LIST,payload:n})}))}},F=function(){return function(e){x.get("/api/container/queryContainer",{pageSize:200}).then((function(t){t=t.data,e({type:k.kP.GET_INSTANCE_LIST,payload:t.result.data})}))}},K=function(e){return function(e){P.t6.getClusterList({type:void 0,"sort-by":"id","sort-dir":"desc",limit:0,start:0}).then((function(t){if(0===(t=t.data).code){var n;e({type:k.kP.GET_PARENT_CLUSTER_LIST,payload:t.data.clusters});var a=t.data.clusters[0],r=T.get("em_current_cluster_id"),o=r&&u()(n=t.data.clusters).call(n,(function(e){return e.id===+r}))||a;e({type:k.kP.SET_CUR_PARENT_CLUSTER,payload:o}),T.set("em_current_cluster_id",o.id),T.set("em_current_cluster_type",o.type)}else N.Z.error(t.msg)}))}},G=function(e){return{type:k.kP.SET_CUR_PARENT_CLUSTER,payload:e}}},65778:(e,t,n)=>{n.d(t,{Z:()=>U});var a=n(1068),r=n.n(a),o=n(68420),l=n(27344),i=n(5281),s=n(84441),c=n(3020),u=n(3362),d=n(44845),p=n(81643),f=n.n(p),m=n(94198),h=n.n(m),v=n(78914),y=n.n(v),g=n(3649),_=n.n(g),E=n(2991),S=n.n(E),I=n(25843),C=n.n(I),Z=n(67294),N=n(34041),P=n(45360),k=n(31097),x=n(4107),T=n(67908),D=n(78241);function b(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=r()(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var L=N.Z.Option,U=function(e){(0,s.Z)(n,e);var t=b(n);function n(e){var a;return(0,o.Z)(this,n),a=t.call(this,e),(0,d.Z)((0,i.Z)(a),"state",{first_logfile:"",second_logfile:"",show_second_select:!1,second_logs:[],log_message:"",lineNum:"200",searchText:"",sourceText:""}),(0,d.Z)((0,i.Z)(a),"handleMenu1Click",(function(e){var t=(0,i.Z)(a),n=a.props.serviceid;f()(e).call(e,"*")>-1?D.get("/api/v2/instance/".concat(n,"/log"),{logfile:e.replace(/\s+/g,""),is_match:!1}).then((function(n){var a,r,o;0===(n=n.data).code?t.setState({first_logfile:e,second_logs:null===(a=n)||void 0===a||null===(r=a.data)||void 0===r||null===(o=r.result)||void 0===o?void 0:o.replace(/\s+/g,"").split(","),show_second_select:!0}):P.Z.error(n.msg)})):D.get("/api/v2/instance/".concat(n,"/log"),{logfile:e,is_match:!0}).then((function(n){0===(n=n.data).code?(t.setState({first_logfile:e,show_second_select:!1,sourceText:n.data.result}),a.setLogMessage(n.data.result,!0)):P.Z.error(n.msg)}))})),(0,d.Z)((0,i.Z)(a),"handleMenu2Click",(function(e){var t=(0,i.Z)(a),n=a.props.serviceid;D.get("/api/v2/instance/".concat(n,"/log"),{logfile:e,is_match:!0,tail_num:a.state.lineNum}).then((function(n){0===(n=n.data).code?(t.setState({second_logfile:e,show_second_select:!0,sourceText:n.data.result}),a.setLogMessage(n.data.result)):P.Z.error(n.msg)}))})),(0,d.Z)((0,i.Z)(a),"handleRefreshLogs",(function(){var e=a.props.serviceid,t=a.state.first_logfile;(h()(a.state.lineNum)>1e3||h()(a.state.lineNum)<0)&&P.Z.error("行数只能位于0-1000之间"),a.state.second_logfile&&(t=a.state.second_logfile),D.get("/api/v2/instance/".concat(e,"/log"),{logfile:t,is_match:!0,tail_num:a.state.lineNum}).then((function(e){0===(e=e.data).code?(a.setState({sourceText:e.data.result}),a.setLogMessage(e.data.result,!0)):P.Z.error(e.msg)}))})),(0,d.Z)((0,i.Z)(a),"handleLineNumChange",(function(e){a.setState({lineNum:e.target.value})})),(0,d.Z)((0,i.Z)(a),"handleSearchChange",(function(e){var t=e.toLowerCase();if(a.setState({searchText:e}),""!==e){var n=a.state.sourceText.toLocaleLowerCase().split(t),r=[];y()(n).call(n,(function(e){r.push(e.length)}));var o=[],l=0;y()(r).call(r,(function(t){o.push(l+t),l+=t+e.length}));for(var i="",s="",c=a.state.sourceText,u=0,d=0;d<o.length;d++)s=_()(c).call(c,o[d],o[d]+e.length),s='<span style="color: red">'.concat(s,"</span>"),i+=_()(c).call(c,u,o[d])+s,u=o[d]+e.length;a.setLogMessage(i)}else a.setLogMessage(a.state.sourceText)})),(0,d.Z)((0,i.Z)(a),"setLogMessage",(function(e,t){document.getElementById("textPre").innerHTML=e,t&&document.getElementsByClassName("log-message-box").length>0&&document.getElementsByClassName("log-message-box")[0].scrollTo(0,document.getElementById("textPre").offsetHeight),a.setState({log_message:e})})),a}return(0,l.Z)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){}},{key:"render",value:function(){var e=this.props.logs,t=this.state,n=t.first_logfile,a=t.second_logfile,r=t.second_logs,o=void 0===r?[]:r;return Z.createElement("div",{className:"logtail-box"},Z.createElement("div",{className:"option-bar",style:{display:"flex"}},Z.createElement(N.Z,{style:{height:26,minWidth:150,marginBottom:10},value:n,onChange:this.handleMenu1Click},S()(e).call(e,(function(e,t){return Z.createElement(L,{key:t+"",value:e},Z.createElement(k.Z,{key:t+"",title:e},e))}))),Z.createElement("div",{style:this.state.show_second_select?{display:"inline-block",marginLeft:8}:{display:"none"}},Z.createElement(N.Z,{style:{height:26,minWidth:150,maxWidth:300,marginBottom:10},value:a,onChange:this.handleMenu2Click},S()(o).call(o,(function(e,t){return Z.createElement(L,{key:t+"",value:e},Z.createElement(k.Z,{key:t+"",title:C()(e).call(e)},C()(e).call(e)))})))),Z.createElement(x.Z,{placeholder:"输入日志行数，“0-1000”之间",onPressEnter:this.handleRefreshLogs,style:{height:26,width:230,marginLeft:8,marginBottom:10},onChange:this.handleLineNumChange,addonAfter:Z.createElement(T.Z,{style:{cursor:"pointer"},onClick:this.handleRefreshLogs,type:"reload"})}),Z.createElement(x.Z.Search,{placeholder:"输入关键词",style:{height:26,width:179,marginLeft:10,marginBottom:10},onSearch:this.handleSearchChange})),Z.createElement("div",{className:"log-message-box",style:{height:"400px",paddingTop:"10px",overflowY:"auto",backgroundColor:"#F5F5F5",border:"1px dashed #DDDDDD"}},Z.createElement("span",null,Z.createElement("pre",{id:"textPre",style:{paddingLeft:10}}))))}}]),n}(Z.Component)},18274:(e,t,n)=>{n.d(t,{E9:()=>i,MD:()=>a,OY:()=>o,RI:()=>l,XN:()=>r});var a=[{text:"部署成功",value:"deployed"},{text:"部署失败",value:"deploy fail"},{text:"部署中",value:"deploying"},{text:"卸载失败",value:"undeploy fail"},{text:"卸载中",value:"undeploying"}],r=[{text:"更新成功",value:"success"},{text:"更新失败",value:"fail"},{text:"更新中",value:"update"}],o={hosts:["主机集群"],kubernetes:["Kubernetes集群（自建集群）","Kubernetes集群（导入已有集群）"]},l={hosts:{title:"主机安装会经过2个状态：管控安装-主机初始化，若某一步安装失败，请查看具体日志。",filters:[{text:"管控安装成功",value:"管控安装成功"},{text:"管控安装失败",value:"管控安装失败"},{text:"script安装成功",value:"script安装成功"},{text:"script安装失败",value:"script安装失败"},{text:"主机初始化成功",value:"主机初始化成功"},{text:"主机初始化失败",value:"主机初始化失败"}],finalStatus:3},kubernetes:{title:"Kubernetes集群主机安装会经过5个状态：管控安装-主机初始化-K8S Docker初始化-K8S Node初始化-K8S Node部署成功，若某一步安装失败，请查看具体日志",filters:[{text:"管控安装失败",value:"管控安装失败",status:-1},{text:"管控安装成功",value:"管控安装成功",status:1},{text:"主机初始化失败",value:"主机初始化失败",status:-3},{text:"主机初始化成功",value:"主机初始化成功",status:3},{text:"K8S DOCKER初始化失败",value:"K8S DOCKER初始化失败",status:-5},{text:"K8S DOCKER初始化成功",value:"K8S DOCKER初始化成功",status:5},{text:"K8S NODE初始化失败",value:"K8S NODE初始化失败",status:-6},{text:"K8S NODE初始化成功",value:"K8S NODE初始化成功",status:6},{text:"K8S NODE部署失败",value:"K8S NODE部署失败",status:-7},{text:"K8S NODE部署成功",value:"K8S NODE部署成功",status:7}],finalStatus:7}},i={NAMESPACE:"em_current_k8s_namespace"}},72348:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ye});var a=n(1068),r=n.n(a),o=n(68420),l=n(27344),i=n(5281),s=n(84441),c=n(3020),u=n(3362),d=n(44845),p=n(51942),f=n.n(p),m=n(31581),h=n.n(m),v=n(54103),y=n.n(v),g=n(2991),_=n.n(g),E=n(67294),S=n(27220),I=n(24105),C=n(45334),Z=n(31097),N=n(59314),P=n(77268),k=n(8263),x=n(37870),T=n(30258),D=n(29027),b=n(15857),L=n(4482),U=n(12903),R=n(65778),w=n(19623),O=n(86902),A=n.n(O),B=n(59340),M=n.n(B),F=n(4107),K=n(67908);function G(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=r()(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var J=new RegExp("^[0-9]*$"),Y=function(e){(0,s.Z)(n,e);var t=G(n);function n(e){var a;return(0,o.Z)(this,n),(a=t.call(this,e)).state={default_input_value:"",has_config_value:!1},a}return(0,l.Z)(n,[{key:"buildInstanceEditByNode",value:function(e,t,n){var a,r=this,o=t+1,l=null;return l=1===t?"node-item top-floor":"node-item",_()(a=A()(e)).call(a,(function(t,a){var i,s,c,u,d=n?n+"."+t:t,p=J.test(t);return"object"===(0,w.Z)(e[t])?E.createElement("li",{key:d,className:l},E.createElement("span",{className:"node-item-title"},t,": "),E.createElement("ul",{style:{display:"inline-block",verticalAlign:"top"}},r.buildInstanceEditByNode(e[t],o,d))):"MaxReplica"===t||"StartAfterInstall"===t?E.createElement("li",{key:d,className:l},E.createElement("span",{className:"node-item-title"},t,": "),E.createElement("span",null,e[t])):"UseCloud"!==t?E.createElement("li",{key:d,className:l},E.createElement("span",{className:"node-item-title",style:p?{display:"none"}:{display:"inline-block"}},t,":"," "),E.createElement(F.Z,{defaultValue:e[t],value:e[t],addonAfter:E.createElement(K.Z,{type:"reload",style:{fontSize:14},onClick:y()(i=r.handleReloadConfig).call(i,r,d)}),onChange:y()(s=r.handleInputChange).call(s,r,d,0),onFocus:y()(c=r.handleInputFocus).call(c,r,d),onBlur:y()(u=r.handleInputBlur).call(u,r,d)})):""}))}},{key:"buildConfigEditByNode",value:function(e,t){var n,a=this,r=!1,o=_()(n=A()(e)).call(n,(function(n,o){var l,i=t?t+"."+n:n;return _()(l=A()(e[n])).call(l,(function(t,o){var l,s,c,u,d=i+"."+t;return"Value"===t&&"string"==typeof e[n][t]?(r=!0,E.createElement("li",{key:d,className:"node-item top-floor"},E.createElement("span",{className:"node-item-title"},i,": "),E.createElement(F.Z,{defaultValue:e[n][t],value:e[n][t],addonAfter:E.createElement(K.Z,{type:"reload",style:{fontSize:14},onClick:y()(l=a.handleReloadConfig).call(l,a,d)}),onChange:y()(s=a.handleInputChange).call(s,a,d,1),onFocus:y()(c=a.handleInputFocus).call(c,a,d),onBlur:y()(u=a.handleInputBlur).call(u,a,d)}))):""}))}));return r?o:E.createElement("span",{style:{margin:"1px 1%"}},"无")}},{key:"handleInputChange",value:function(e,t,n){this.props.modifyServiceConfig({pname:this.props.pindex,type:t,path:e,value:n.target.value})}},{key:"handleInputFocus",value:function(e,t){this.setState({default_input_value:t.target.value})}},{key:"handleInputBlur",value:function(e,t){this.state.default_input_value!==t.target.value&&this.props.onBlur({pindex:this.props.pindex,path:this.props.type+"."+e,value:t.target.value})}},{key:"handleReloadConfig",value:function(e,t){this.props.resetServiceConfig({pindex:this.props.pindex,field_path:this.props.type+"."+e})}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.type,a=e.dpd;return"Instance"===n?t?E.createElement("div",{className:"edit-panel config-box",style:t.UseCloud?{display:"none"}:{display:"block"}},E.createElement("div",{className:"mod-title"},"实例配置:"),"{}"!==M()(t)?E.createElement("ul",{className:"config-tree"},this.buildInstanceEditByNode(t,1)):E.createElement("p",{style:{lineHeight:"20px"}},"无")):E.createElement("div",{className:"edit-panel config-box",style:{display:"none"}},E.createElement("div",{className:"mod-title"},"实例配置:"),E.createElement("p",{style:{lineHeight:"20px"}},"无")):t?E.createElement("div",{className:"edit-panel config-box"},E.createElement("div",{className:"mod-title"},"Config配置:"),E.createElement("ul",{className:"config-tree"},this.buildConfigEditByNode(t)),E.createElement("div",{className:"mod-title"},"依赖服务:"),E.createElement("p",{style:{lineHeight:"20px"}},a.toString()||"无")):E.createElement("div",{className:"edit-panel config-box"},E.createElement("div",{className:"mod-title"},"Config配置:"),E.createElement("p",{style:{lineHeight:"20px"}},"无"))}}]),n}(E.Component),j=n(3649),H=n.n(j),V=n(66419),W=n.n(V),$=n(65420),z=n.n($),q=n(19996),Q=n.n(q),X=n(41511),ee=n.n(X),te=n(77766),ne=n.n(te),ae=n(94198),re=n.n(ae),oe=n(45360),le=n(20666),ie=n(19528);function se(e,t){var n=void 0!==z()&&Q()(e)||e["@@iterator"];if(!n){if(ee()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return ce(e,t);var a=H()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return W()(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ue(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=r()(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var de,pe=function(e){(0,s.Z)(n,e);var t=ue(n);function n(e){var a;(0,o.Z)(this,n),a=t.call(this,e),(0,d.Z)((0,i.Z)(a),"handleSetIps",(function(){var e=a.state,t=e.targetKeys,n=e.max;t.length>n?oe.Z.error("IP数量限制"+n+"，目前超出限制！"):(a.props.setip(a.props.pindex,t.join(",")),a.setState({showModal:!1}))})),(0,d.Z)((0,i.Z)(a),"handleShowEditModal",(function(){var e,t=[],n=se(a.state.originIps);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.key)}}catch(e){n.e(e)}finally{n.f()}a.setState({showModal:!0,targetKeys:t})})),(0,d.Z)((0,i.Z)(a),"handleHideEditModal",(function(){var e,t=a.state.originIps,n=[],r=se(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;n.push(o.key)}}catch(e){r.e(e)}finally{r.f()}a.setState({showModal:!1,existIPs:t,targetKeys:n})})),(0,d.Z)((0,i.Z)(a),"handleTransferIpChange",(function(e,t,n){var r,o=[],l=se(e);try{for(l.s();!(r=l.n()).done;){var i=r.value;o.push({key:i,title:i,description:i,disable:!1})}}catch(e){l.e(e)}finally{l.f()}a.setState({targetKeys:e,existIPs:o})})),(0,d.Z)((0,i.Z)(a),"handleTransferSelectChange",(function(e,t){var n=a.state,r=n.targetKeys,o=n.max;ne()(r).call(r,e).length>o&&oe.Z.error("IP数量限制"+o+"，目前超出限制！")}));var r=1;r=a.props.instance&&""!==a.props.instance.MaxReplica?a.props.instance.MaxReplica:9999;var l,s=[],c=a.props.data.IP&&a.props.data.IP.length?a.props.data.IP:[],u=se(c);try{for(u.s();!(l=u.n()).done;){var p=l.value;s.push({key:p,title:p,description:p,disable:!1})}}catch(e){u.e(e)}finally{u.f()}return a.state={originIps:s,existIPs:s,leftIPs:[],sourceIps:[],targetKeys:c||[],selectedKeys:[],ipStr:"",max:r,showModal:!1},a}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.getLeftIps()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.instance,n=e.data,a=1;a=t&&""!==t.MaxReplica?re()(t.MaxReplica):9999;var r,o=[],l=this.props.data.IP&&this.props.data.IP.length?this.props.data.IP:[],i=se(l);try{for(i.s();!(r=i.n()).done;){var s=r.value;o.push({key:s,title:s,description:s,disable:!1})}}catch(e){i.e(e)}finally{i.f()}this.setState({originIps:o,existIPs:o,targetKeys:l,ipStr:n,max:a})}},{key:"getLeftIps",value:function(){var e=this,t=e.props.pname,n=e.props.sname;ie.aJ.getLeftIp({productName:t,serviceName:n}).then((function(t){var n=[];if(0===(t=t.data).code){if(t.data.hosts){var a,r,o=se(t.data.hosts);try{for(o.s();!(r=o.n()).done;){var l,i=r.value,s=!1,c=se(e.state.existIPs);try{for(c.s();!(l=c.n()).done;){l.value===i.ip&&(s=!0)}}catch(e){c.e(e)}finally{c.f()}s||n.push({key:i.ip,title:i.ip,description:i.ip,disable:!1})}}catch(e){o.e(e)}finally{o.f()}e.setState({sourceIps:ne()(a=e.state.existIPs).call(a,n),leftIPs:n})}}else oe.Z.error(t.msg)}))}},{key:"handleIpInputChange",value:function(e){(0,this.props.updateip)(this.props.pindex,e.target.value)}},{key:"updateIpInputChange",value:function(e){this.props.setip(this.props.pindex,e.target.value)}},{key:"render",value:function(){var e,t,n,a,r=this.props,o=r.instance,l=r.data;return o?E.createElement("div",{className:"edit-panel",style:{borderBottom:0}},E.createElement("div",{className:"mod-title",style:o.UseCloud?{display:"none"}:{display:"block"}},E.createElement("a",{onClick:this.handleShowEditModal},"编辑ip地址"),"：",E.createElement("span",{style:{padding:10,lineHeight:"20px"}},l.IP?l.IP.join(","):"")),E.createElement("div",{className:"mod-title",style:o.UseCloud?{display:"block"}:{display:"none"}},E.createElement("span",{style:{width:"8%",display:"inline-block"}},"编辑ip地址:",l.IP," "),E.createElement(F.Z,{style:{width:"90%"},placeholder:"多个ip用逗号分开",value:l.IP?l.IP.join(","):"",onChange:y()(e=this.handleIpInputChange).call(e,this),onBlur:y()(t=this.updateIpInputChange).call(t,this)})),E.createElement(T.Z,{visible:this.state.showModal,width:476,onOk:this.handleSetIps,onCancel:this.handleHideEditModal,className:"ip-transfer-modal"},E.createElement(le.Z,{titles:["未选","已选"],dataSource:this.state.sourceIps,showSearch:!0,targetKeys:this.state.targetKeys,onChange:this.handleTransferIpChange,onSelectChange:this.handleTransferSelectChange,render:function(e){return e.title}}))):E.createElement("div",{className:"edit-panel",style:{borderBottom:0}},E.createElement("div",{className:"mod-title"},E.createElement("span",{style:{width:"8%",display:"inline-block"}},"编辑ip地址:"," "),E.createElement(F.Z,{style:{width:"90%"},placeholder:"多个ip用逗号分开",value:l.IP?l.IP.join(","):"",onChange:y()(n=this.handleIpInputChange).call(n,this),onBlur:y()(a=this.updateIpInputChange).call(a,this)})))}}]),n}(E.Component),fe=n(64143);function me(e){var t=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=r()(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var he=S.Z.Step,ve=I.Z.Panel;const ye=(0,D.$j)((function(e){return{deploy:e.DeployStore,topnav:e.HeaderStore}}),(function(e){return{actions:(0,b.DE)(f()({},L),e),headerAction:(0,b.DE)(f()({},U),e)}}))(de=function(e){(0,s.Z)(n,e);var t=me(n);function n(e){var a;return(0,o.Z)(this,n),a=t.call(this,e),(0,d.Z)((0,i.Z)(a),"deployListInterval",null),(0,d.Z)((0,i.Z)(a),"handleCollapseChange",(function(e){if(void 0!==e){var t=a.props.deploy,n=[];for(var r in t.product.Service)n.push({name:r,data:t.product.Service[r]})}})),(0,d.Z)((0,i.Z)(a),"handleCancelDeploy",(function(){a.props.actions.cancelDeploy({product_name:a.state.product_name,product_version:a.state.product_version})})),a.state={step:0,showCancel:!0,product_name:fe.Z.getParamsFromUrl(window.location.href).product_name||"dtlog",product_version:fe.Z.getParamsFromUrl(window.location.href).product_version||"",log_modal_visible:!1,logpaths:[],log_service_id:-1},a.deployListInterval=null,a}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.updateProductConfig({product_name:this.state.product_name,product_version:this.state.product_version})}},{key:"updateProductConfig",value:function(e){this.props.actions.updateProductConfig(e)}},{key:"handleServiceSchemaUpdate",value:function(e){this.props.actions.modifyServiceConfig({product_name:this.state.product_name,service_name:e.pindex,product_version:this.state.product_version,field_path:e.path,field:e.value})}},{key:"handleServiceConfigReset",value:function(e){this.props.actions.resetServiceConfig({product_name:this.state.product_name,service_name:e.pindex,product_version:this.state.product_version,field_path:e.field_path})}},{key:"addIpToConfig",value:function(e){this.props.actions.addIpToConfig(e)}},{key:"handleSetServiceIp",value:function(e,t){this.props.actions.handleSetServiceIp({product_name:this.state.product_name,service_name:e,product_version:this.state.product_version,ip:t})}},{key:"handleDoDeploy",value:function(){var e=this,t=this.props.headerAction;this.props.actions.startProductDeploy({product_name:this.state.product_name,product_version:this.props.deploy.product_version},(function(){t.getProductList(),e.setState({step:1}),e.props.actions.getDeployList({product_name:e.state.product_name,product_version:e.state.product_version,deploy_uuid:e.props.deploy.deploy.deploy_uuid},(function(){clearInterval(e.deployListInterval)})),e.deployListInterval=h()((function(){e.props.actions.getDeployList({product_name:e.state.product_name,product_version:e.state.product_version,deploy_uuid:e.props.deploy.deploy.deploy_uuid},(function(){clearInterval(e.deployListInterval)}))}),3e3)}))}},{key:"handleReturnToStepOne",value:function(){this.props.actions.returnToStepOne(),clearInterval(this.deployListInterval)}},{key:"handleShowDeployLog",value:function(e){var t=JSON.parse(e.schema);this.setState({log_modal_visible:!0,logpaths:t.Instance.Logs,log_service_id:e.instance_id})}},{key:"handleLogModalCancel",value:function(){this.setState({log_modal_visible:!1})}},{key:"handleGotoProducts",value:function(){window.location.href="/products"}},{key:"componentWillUnmount",value:function(){clearInterval(this.deployListInterval),this.props.actions.resetDeployStatus()}},{key:"handleSwitchUseCloud",value:function(e){var t=this.props,n=t.deploy,a=t.actions,r=f()({},n.product.Service);for(var o in r)o===e.name&&(r[o].Instance.UseCloud=!r[o].Instance.UseCloud,r[o].Instance.Ips="");a.handleSetServiceIp({product_name:this.state.product_name,service_name:e.name,product_version:this.state.product_version,ip:""}),a.switchUseCloudByProduct(r)}},{key:"handleUpdateIpByInput",value:function(e,t){this.props.actions.updateIpsByService(e,t)}},{key:"render",value:function(){var e,t,n,a,r=this,o=this.props,l=o.deploy,i=o.actions,s=[];for(var c in l.product.Service)s.push({name:c,data:l.product.Service[c]});var u=[{title:"执行时间",dataIndex:"update_time",key:"update_time"},{title:"组件",dataIndex:"service_name",key:"service_name"},{title:"IP",dataIndex:"ip",key:"ip"},{title:"产品版本",dataIndex:"product_version",key:"product_version"},{title:"启动及初始化",dataIndex:"progress",key:"progress",render:function(e,t){var n="active";switch(t.status){case"install fail":case"run fail":case"health-check fail":case"health-check cancelled":n="exception"}return E.createElement("div",{style:{width:"170px"}},E.createElement(C.Z,{percent:t.progress,size:"small",status:n}))}},{title:"启动状态",dataIndex:"status",key:"status",render:function(e,t){var n={};switch(t.status){case"install fail":case"run fail":case"health-check fail":case"health-check cancelled":n={color:"#FF5F5C"};break;case"installed":case"health-checked":n={color:"#12BC6A"}}return E.createElement(Z.Z,{title:t.status_message},E.createElement("span",{style:n},e))}},{title:"查看详情",key:"detail",render:function(e,t){var n,a=JSON.parse(t.schema);return a&&a.Instance&&a.Instance.Logs?E.createElement("span",null,E.createElement("a",{style:a.Instance.Logs.length?{display:"inline"}:{display:"none"},onClick:y()(n=r.handleShowDeployLog).call(n,r,t)},"部署详情")):E.createElement("span",null)}}],d={margin:"10px 0",display:"none"},p={margin:"10px 0",display:"none"};switch(l.complete){case"deploy fail":d.display="none",p.display="block";break;case"deployed":d.display="block",p.display="none"}return E.createElement("div",{className:"deploy-page"},E.createElement("div",{className:"config-list-wrapper"},E.createElement(S.Z,{current:this.state.step,style:{marginBottom:"40px"}},E.createElement(he,{title:"组件编排",description:""}),E.createElement(he,{title:"执行部署",description:""})),E.createElement("div",{style:l.deploy.deploy_status?{display:"none"}:{display:"block"}},E.createElement(I.Z,{accordion:!0,onChange:this.handleCollapseChange},_()(s).call(s,(function(e,t){var n,a,o,l,s,c,u=e.name+"   版本:"+e.data.Version;e.data.BaseParsed&&(u=e.name+"   版本:"+e.data.Version+"   继承组件:"+e.data.BaseProduct);var d,p=Object;e.data.Instance&&(p=E.createElement("div",{className:"edit-panel"},E.createElement("span",{style:{fontSize:"14px",color:"#333",fontWeight:500,width:"8%",display:"inline-block"}},"使用云主机："),E.createElement(N.Z,{size:"small",checked:e.data.Instance.UseCloud,onChange:y()(d=r.handleSwitchUseCloud).call(d,r,e)})));return E.createElement(ve,{header:u,key:(t+1).toString()},p,E.createElement(pe,{data:e.data.ServiceAddr||{},pindex:e.name,pname:r.state.product_name,sname:e.name,instance:e.data.Instance,updateip:y()(n=r.handleUpdateIpByInput).call(n,r),setip:y()(a=r.handleSetServiceIp).call(a,r)}),E.createElement(Y,{data:e.data.Instance,type:"Instance",pindex:e.name,modifyServiceConfig:i.modifyServiceInput,resetServiceConfig:y()(o=r.handleServiceConfigReset).call(o,r),onBlur:y()(l=r.handleServiceSchemaUpdate).call(l,r)}),E.createElement(Y,{data:e.data.Config,dpd:e.data.DependsOn||[],type:"Config",pindex:e.name,modifyServiceConfig:i.modifyServiceInput,resetServiceConfig:y()(s=r.handleServiceConfigReset).call(s,r),onBlur:y()(c=r.handleServiceSchemaUpdate).call(c,r)}))}))),E.createElement("div",{className:"deploy-btn-box"},E.createElement(P.Z,{type:"primary",style:"deploying"===l.status?{display:"none"}:{display:"inline-block"},onClick:y()(e=this.handleDoDeploy).call(e,this)},"开始部署"),E.createElement(P.Z,{disabled:!0,style:"deploying"===l.status?{display:"inline-block"}:{display:"none"}},"正在部署"))),E.createElement("div",{style:l.deploy.deploy_status?{display:"block"}:{display:"none"}},E.createElement(k.Z,{columns:u,dataSource:l.deploy_list,pagination:!1}),E.createElement(x.Z,{style:d,message:"部署完成",type:"success"}),E.createElement(x.Z,{style:p,message:"部署失败",type:"error"}),E.createElement("div",{className:"option-bar"},E.createElement(P.Z,{onClick:this.handleCancelDeploy},"取消部署"),E.createElement(P.Z,{onClick:y()(t=this.handleReturnToStepOne).call(t,this),style:"installing"===l.status?{display:"none",margin:"0 10px"}:{display:"inline-block",margin:"0 10px"}},"上一步"),E.createElement(P.Z,{onClick:y()(n=this.handleGotoProducts).call(n,this)},"返回版本管理")),E.createElement(T.Z,{title:"执行日志",footer:null,width:900,visible:this.state.log_modal_visible,onCancel:y()(a=this.handleLogModalCancel).call(a,this)},E.createElement(R.Z,{logs:this.state.logpaths,serviceid:this.state.log_service_id,isreset:!this.state.log_modal_visible})))))}}]),n}(E.Component))||de},64143:(e,t,n)=>{n.d(t,{Z:()=>g});var a=n(77766),r=n.n(a),o=n(78914),l=n.n(o),i=n(81643),s=n.n(i),c=n(2991),u=n.n(c),d=n(86902),p=n.n(d),f=n(31238),m=n.n(f),h=n(45360),v=n(36808),y=n(18274);const g={pageWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},pageHeight:function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},getBase64:function(e,t){var n=new FileReader;n.addEventListener("load",(function(){return t(n.result)})),n.readAsDataURL(e)},percent:function(e,t){return e&&e!==1/0?(e>1&&(e=1),t=t||2,t=Math.pow(10,t),Math.round(e*t*100)/t+"%"):"0%"},getCssText:function(e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t},formateDateTime:function(e){var t,n,a,o,l;if(!e)return"";var i=new Date(e),s=i.getFullYear(),c=i.getMonth()+1+"",u=i.getDate()+"",d=i.getHours()+"",p=i.getMinutes()+"",f=i.getSeconds()+"";return 1===c.toString().length&&(c="0".concat(c)),1===u.toString().length&&(u="0".concat(u)),1===d.toString().length&&(d="0".concat(d)),1===p.toString().length&&(p="0".concat(p)),1===f.toString().length&&(f="0".concat(f)),r()(t=r()(n=r()(a=r()(o=r()(l="".concat(s,"-")).call(l,c,"-")).call(o,u," ")).call(a,d,":")).call(n,p,":")).call(t,f)},formateDate:function(e){var t,n;if(!e)return"";var a=new Date(e),o=a.getFullYear(),l=a.getMonth()+1+"",i=a.getDate()+"";return 1===l.toString().length&&(l="0".concat(l)),1===i.toString().length&&(i="0".concat(i)),r()(t=r()(n="".concat(o,"-")).call(n,l,"-")).call(t,i)},trim:function(e){return"string"==typeof e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},messageFilter:function(e,t,n,a){1001===e.status.code&&(a||h.Z.success("成功"),t&&t())},getTableParam:function(e){var t={};return l()(e).call(e,(function(e,n){var a=e.split("-");t[a[1]]=a[2]})),t},setAlertControl:function(e){var t={},n=e.alert_control;return"1"===n?t.close=1:(t.close=0,e["alert_num_"+n]&&(t.times_after_close=e["alert_num_"+n]),e["recover_num_"+n]&&(t.close_after_long_time_reset_amount=e["recover_num_"+n],t.close_after_long_time_reset_unit=e["recover_unit_"+n])),t},getAlertControl:function(e){var t={alert_control:""};return 0===e.close&&(0!==e.times_after_close?(t.alert_control="2",t["alert_num_"+t.alert_control]=e.times_after_close):t.alert_control="3",""!==e.close_after_long_time_reset_amount&&("2"===t.alert_control&&(t.alert_control="4"),t["alert_num_"+t.alert_control]=e.times_after_close,t["recover_num_"+t.alert_control]=e.close_after_long_time_reset_amount,t["recover_unit_"+t.alert_control]=e.close_after_long_time_reset_unit)),t},filterOption:function(e,t){var n;return-1!==s()(n=t.props.children).call(n,e)},getParamsFromUrl:function(e){var t={},n=[],a="",r="",o=e.substring(s()(e).call(e,"?")+1,e.length).split("&");for(var l in o)a=(n=o[l].split("="))[0],r=n[1],t[a]=r;return t},jsonToQuery:function(e){var t;return e?function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}(u()(t=p()(e)).call(t,(function(t){return void 0===e[t]?"":encodeURIComponent(t)+"="+encodeURIComponent(e[t])}))).join("&"):""},checkNullObj:function(e){return 0===p()(e).length},serviceCallback:function(e,t,n){0===e.data.code?(h.Z.success(t),n&&n()):h.Z.error(e.data.msg)},noAuthorityToDO:function(e,t){return!e[t]&&(h.Z.error("权限不足，请联系管理员!"),!0)},get k8sNamespace(){return v.get(y.E9.NAMESPACE)},setNaviKey:function(e,t){sessionStorage.setItem("firstLevelNav",e),sessionStorage.setItem("siderLevelNav",t)},formatGBUnit:function(e){return s()(e).call(e,"MB")>-1?m()(e.replace("MB",""))/1024:s()(e).call(e,"KB")>-1?m()(e.replace("KB",""))/1024/1024:s()(e).call(e,"GB")>-1?m()(e.replace("GB","")):s()(e).call(e,"TB")>-1?1024*m()(e.replace("TB","")):0}}}}]);